·ã§·ãß·ã•html
<!DOCTYPE html>
<html lang="am">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>·çã·à≤·àç ·ãå·â• ·ä†·çï - Fasil Web App (Firebase Online)</title>
    
    <!-- PWA Manifest Link -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#007bff">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Libraries for PPT, PDF, OCR -->
    <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>

    <style>
        /* --- General CSS --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            text-align: center; padding: 0; margin: 0;
            background-color: #f0f4f8; color: #333;
            padding-bottom: 90px;
        }
        .container { max-width: 700px; margin: 0 auto; padding: 5px; }
        
        /* Header */
        .top-header {
            display: flex; justify-content: space-between; align-items: center;
            background: #fff; padding: 5px 10px; border-bottom: 3px solid #007bff;
        }
        .marquee-container-top { flex: 1; overflow: hidden; white-space: nowrap; margin: 0 10px; }
        .marquee-text-top { display: inline-block; padding-left: 100%; animation: marquee 15s linear infinite; color: #007bff; font-weight: bold; font-size: 16px; }
        
        /* Footer */
        .footer-wrapper { position: fixed; bottom: 0; left: 0; width: 100%; z-index: 1000; background: white; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); }
        .bottom-nav { display: flex; height: 55px; width: 100%; }
        .nav-btn { flex: 1; border: none; font-weight: bold; font-size: 14px; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white; }
        .nav-home { background-color: #28a745; } .nav-live { background-color: #ffc107; color: black; } .nav-profile { background-color: #dc3545; }
        .bottom-marquee { background: #f0f0f0; color: #28a745; font-weight: bold; overflow: hidden; white-space: nowrap; height: 25px; line-height: 25px; font-size: 12px; }
        .bottom-marquee span { display: inline-block; padding-left: 100%; animation: marquee 12s linear infinite; }
        @keyframes marquee { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }

        /* Sections */
        .section { display: none; background: white; padding: 15px; border-radius: 8px; margin-top: 10px; min-height: 400px; }
        .show { display: block; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity:0; } to { opacity:1; } }

        /* Welcome Split - Compacted */
        .split-container { display: flex; justify-content: space-between; gap: 5px; text-align: left; margin-bottom: 5px; }
        .split-left { width: 48%; color: #007bff; font-size: 10px; line-height: 1.2; padding: 2px; }
        .split-right { width: 48%; color: #d35400; font-size: 10px; font-weight: bold; line-height: 1.2; border-left: 1px solid #ccc; padding-left: 5px; padding: 2px; }
        .blue-spacer { height: 10px; background-color: #007bff; margin: 5px 0; border-radius: 5px; }
        #t-in, #t-po { font-size: 9px; }

        /* --- LOGO CSS --- */
        .brand-area { display: flex; align-items: center; justify-content: center; margin-top: 10px; margin-bottom: 20px; position: relative; transform: scale(1.0); }
        .side-logo-container { width: 60px; height: 60px; border-radius: 50%; border: 2px solid #007bff; background: white; z-index: 5; display: flex; align-items: center; justify-content: center; box-shadow: 0 0 10px rgba(0, 123, 255, 0.6); }
        .side-logo-img { width: 100%; height: 100%; object-fit: cover; border-radius: 50%; }
        .left-logo { margin-right: -20px; } .right-logo { margin-left: -20px; }
        
        .complex-logo { position: relative; width: 130px; height: 130px; z-index: 10; margin-top: 20px; } 
        .ring { position: absolute; border-radius: 50%; display: flex; align-items: center; justify-content: center; top: 50%; left: 50%; transform: translate(-50%, -50%); animation: glowing 1.5s infinite alternate ease-in-out; }
        @keyframes glowing { 0% { box-shadow: 0 0 5px currentColor; filter: brightness(100%); } 100% { box-shadow: 0 0 20px currentColor; filter: brightness(150%); } }
        .ring-blue { width: 130px; height: 130px; border: 4px solid #00008b; color: #00008b; z-index: 1; }
        .ring-red { width: 110px; height: 110px; border: 3px solid red; color: red; z-index: 2; }
        .ring-yellow { width: 90px; height: 90px; border: 3px solid yellow; color: yellow; z-index: 3; }
        .ring-green { width: 70px; height: 70px; background: transparent; border: 2px solid green; border-radius: 50%; z-index: 4; }
        
        /* Updated Center Logo logic */
        .center-lion { position: absolute; width: 70px; height: 70px; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 100; object-fit: cover; border-radius: 50%; border: 2px solid white; background-color: #007bff; }
        
        .pos-item { position: absolute; width: 16px; height: 16px; object-fit: cover; border-radius: 50%; border: 1px solid white; }
        .p-n { top: -8px; left: 50%; transform: translateX(-50%); } .p-s { bottom: -8px; left: 50%; transform: translateX(-50%); } 
        .p-e { right: -8px; top: 50%; transform: translateY(-50%); } .p-w { left: -8px; top: 50%; transform: translateY(-50%); }

        /* FWA Animated Brand Text */
        .fwa-brand {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 15px;
            gap: 10px;
        }
        .fwa-letter {
            font-size: 48px;
            font-weight: bold;
            font-family: Arial, sans-serif;
            animation: colorPulse 2s infinite alternate;
            display: inline-block;
        }
        .letter-f { color: #28a745; animation-delay: 0s; } /* Green */
        .letter-w { color: #ffc107; animation-delay: 0.4s; } /* Yellow */
        .letter-a { color: #dc3545; animation-delay: 0.8s; } /* Red */
        @keyframes colorPulse {
            0% { filter: brightness(100%); transform: scale(1); }
            100% { filter: brightness(150%); transform: scale(1.1); }
        }

        /* SPLASH SCREEN */
        #splash-screen { 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background-color: #007bff; 
            z-index: 9999; 
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center; 
        }
        #splash-msg { 
            margin-top: 30px; 
            color: white; 
            font-size: 22px; 
            font-weight: bold; 
            text-align: center; 
            padding: 20px; 
            animation: slideTxt 5s linear infinite; 
            display: none; 
        }
        @keyframes slideTxt { 
            0% {transform: translateX(100%);} 
            100% {transform: translateX(-100%);} 
        }

        /* Loading Spinner Overlay */
        #loading-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.95); z-index: 5000;
            display: none; justify-content: center; align-items: center; flex-direction: column;
        }
        .loader {
            border: 8px solid #f3f3f3; border-top: 8px solid #007bff;
            border-radius: 50%; width: 60px; height: 60px;
            animation: spin 0.8s linear infinite; margin-bottom: 15px;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Progress Bar for Posting */
        .progress-container { width: 80%; background-color: #ddd; border-radius: 13px; padding: 3px; margin-top: 10px; }
        .progress-bar { width: 0%; height: 20px; background-color: #28a745; border-radius: 10px; transition: width 0.1s; text-align: center; color: white; line-height: 20px; font-size: 12px; }

        /* Dashboard Split */
        .dash-layout { display: flex; gap: 10px; align-items: flex-start; }
        .dash-left { width: 60%; text-align: left; } .dash-right { width: 40%; }
        
        /* UI Elements */
        input, select, textarea { width: 100%; padding: 10px; margin: 5px 0; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
        button { width: 100%; padding: 12px; margin: 5px 0; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; color: white; }
        .btn-green { background: #28a745; } .btn-red { background: #dc3545; } .btn-blue { background: #007bff; } .btn-yellow { background: #ffc107; color: black; }
        .btn-black { background: black; color: white; } /* New Black Button */
        .btn-small { padding: 8px; font-size: 12px; margin: 2px 0; }
        .btn-tiny { padding: 5px; font-size: 10px; margin: 1px; }
        .btn-admin { background: #333; color: white; display: none; }
        .lang-btn { background: #6c757d; color: white; padding: 4px 8px; font-size: 10px; border-radius: 4px; border:none; cursor: pointer; margin-top: 2px;}
        
        /* Modified Buttons */
        .btn-compact { padding: 8px; margin: 2px 0; font-size: 14px; margin-top: 15px; }

        /* Modals */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); display: none; justify-content: center; align-items: center; z-index: 2000; }
        .modal-box { background: white; padding: 20px; width: 85%; border-radius: 10px; text-align: center; max-height: 80vh; overflow-y: auto; }

        /* Post Card */
        .post-card { border: 1px solid #eee; background: #fff; border-radius: 8px; padding: 15px; margin-bottom: 15px; text-align: left; }
        .post-header { display: flex; align-items: center; margin-bottom: 10px; border-bottom: 1px solid #f0f0f0; padding-bottom: 5px; }
        .post-header img { width: 35px; height: 35px; border-radius: 50%; margin-right: 10px; object-fit: cover; }
        .post-actions { display: flex; justify-content: space-between; margin-top: 10px; padding-top: 10px; border-top: 1px solid #eee; flex-wrap: wrap; }
        .action-icon { background: none; border: none; color: #007bff; font-size: 12px; cursor: pointer; padding: 5px; margin: 0; width: auto; display: inline-flex; align-items: center; gap: 3px; }
        
        .user-item { display: flex; align-items: center; padding: 10px; border-bottom: 1px solid #eee; }
        .user-item img { width: 40px; height: 40px; border-radius: 50%; margin-right: 10px; object-fit: cover; }
        .user-item.bright-blue { background-color: #007bff; color: white; border-radius: 5px; }
        .user-item.has-msg { background-color: #d4edda; border-left: 5px solid #28a745; }
        
        #live-video-element { width: 100%; height: 350px; background: #000; border-radius: 8px; object-fit: cover; }
        .hidden-input { display: none; }
        .hidden { display: none; }
        
        /* Admin Indicators */
        .banned-text { color: black !important; font-weight: bold; }
        .open-text { color: #007bff !important; font-weight: bold; }
        .banned-indicator { border: 2px solid black; background: #eee; }
        
        /* Firebase Status - PERMANENT */
        .firebase-status {
            position: fixed;
            top: 60px;
            right: 10px;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 10px;
            z-index: 1000;
            display: block !important;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .firebase-online { 
            background: #28a745; 
            border: 1px solid #1e7e34;
        }
        .firebase-offline { 
            background: #dc3545; 
            border: 1px solid #bd2130;
        }
        
        /* Password Show/Hide Toggle */
        .password-wrapper {
            position: relative;
            width: 100%;
        }
        .password-wrapper input {
            padding-right: 40px;
        }
        .toggle-password {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #007bff;
            cursor: pointer;
            font-size: 14px;
            width: auto;
            padding: 0;
            margin: 0;
        }
        
        /* FWA Notes Modal */
        .fwa-notes-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 15px 0;
            transition: all 0.3s ease;
        }
        .fwa-notes-grid.hidden {
            display: none;
        }
        .fwa-note-btn {
            background: linear-gradient(45deg, #9c27b0, #673ab7);
            color: white;
            border: 2px solid #5e35b1;
            font-weight: bold;
            padding: 12px 5px;
            transition: all 0.3s ease;
        }
        .fwa-note-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .fwa-note-image {
            max-width: 100%;
            height: auto;
            border: 2px solid #9c27b0;
            border-radius: 8px;
            margin: 10px 0;
            animation: fadeIn 0.5s;
        }
        .fwa-image-container {
            text-align: center;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 8px;
            margin: 10px 0;
            animation: fadeIn 0.5s;
        }
        .fwa-back-btn {
            margin-top: 15px;
            background: #6c757d;
        }
        
        /* Business Section Updates */
        .business-balance-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin: 10px 0;
            text-align: center;
        }
        .balance-item {
            background: #f8f9fa;
            padding: 8px;
            border-radius: 5px;
            border: 1px solid #dee2e6;
        }
        .balance-label {
            font-size: 12px;
            color: #666;
        }
        .balance-value {
            font-size: 16px;
            font-weight: bold;
        }
        .usd-bal { color: #28a745; }
        .gbp-bal { color: #dc3545; }
        .eur-bal { color: #007bff; }
        .etb-bal { color: #ffc107; }
        .fwa-bal { color: #9c27b0; }
        
        /* MODERN REALISTIC LIVE STREAM */
        .live-stream-container {
            position: relative;
            width: 100%;
            height: 450px;
            background: black;
            border-radius: 10px;
            overflow: hidden;
            margin: 15px 0;
        }
        .live-overlay-top {
            position: absolute; top: 10px; left: 10px; right: 10px;
            display: flex; justify-content: space-between; z-index: 10;
        }
        .live-badge {
            background: #dc3545; color: white; padding: 3px 8px;
            border-radius: 4px; font-weight: bold; font-size: 12px;
            animation: pulse 1.5s infinite;
        }
        .live-viewers-badge {
            background: rgba(0,0,0,0.5); color: white; padding: 3px 8px;
            border-radius: 15px; font-size: 12px;
        }
        .live-overlay-bottom {
            position: absolute; bottom: 10px; left: 10px; right: 10px;
            z-index: 10;
        }
        .floating-hearts {
            position: absolute; bottom: 60px; right: 10px; width: 50px; height: 200px;
            pointer-events: none; overflow: hidden;
        }
        .heart-icon {
            position: absolute; bottom: 0; color: #ff0055; font-size: 24px;
            animation: floatUp 3s linear forwards; opacity: 0;
        }
        @keyframes floatUp {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(-200px) scale(1.5); opacity: 0; }
        }
        @keyframes pulse {
            0% { transform: scale(0.95); opacity: 0.9; }
            50% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0.95); opacity: 0.9; }
        }
        .live-online {
            background-color: #28a745 !important;
            animation: pulse-green 1.5s infinite;
        }
        @keyframes pulse-green {
            0% { box-shadow: 0 0 0 0 rgba(40, 167, 69, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(40, 167, 69, 0); }
            100% { box-shadow: 0 0 0 0 rgba(40, 167, 69, 0); }
        }
        .live-indicator {
            display: inline-block; width: 10px; height: 10px;
            background-color: #dc3545; border-radius: 50%;
            margin-right: 5px;
        }
        .live-count-indicator {
            background-color: red; 
            color: white;
            border-radius: 50%;
            padding: 2px 6px;
            font-size: 10px;
            font-weight: bold;
            position: absolute;
            top: 5px; right: 5px;
            animation: pulse 1s infinite;
        }

        /* CHATBOT POSITION OVERRIDE */
        #chatbase-bubble-button {
            top: 10px !important; left: 10px !important;
            bottom: auto !important; right: auto !important;
            z-index: 9999 !important;
        }

        /* ADMIN LIVE INDICATOR */
        .admin-live-active {
            position: absolute; top: -5px; right: -5px; width: 15px; height: 15px;
            background-color: #ffc107; /* Yellow blinking */
            border: 2px solid white; border-radius: 50%;
            animation: blink 1s infinite;
        }
        .admin-live-inactive {
             position: absolute; top: -5px; right: -5px; width: 15px; height: 15px;
             background-color: black; /* Black */
             border: 2px solid white; border-radius: 50%;
        }
        @keyframes blink { 0% {opacity:1;} 50% {opacity:0.3;} 100% {opacity:1;} }

        /* Notification Styling */
        .dashboard-notif {
            color: red; font-weight: bold; margin: 5px 0; font-size: 14px; text-align: center;
        }
        .business-notif {
            color: #ffc107; font-weight: bold; margin: 5px 0; font-size: 14px; text-align: center; background: #333; padding: 5px;
        }
        .rewards-notif {
            color: #007bff; font-weight: bold; margin: 5px 0; font-size: 14px; text-align: center;
        }
        
        /* Horizontal Payment Buttons */
        .payment-options-row {
            display: flex;
            flex-direction: row;
            gap: 5px;
            justify-content: space-between;
            margin-bottom: 10px;
            overflow-x: auto;
        }
        .payment-options-row button {
            flex: 1;
            padding: 8px 5px;
            font-size: 12px;
            white-space: nowrap;
        }
        
        /* Grid Layout */
        .grid-3-col {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 5px;
            margin-bottom: 10px;
        }
        .flex-row {
            display: flex;
            gap: 5px;
            overflow-x: auto;
            margin-bottom: 10px;
        }
        
        /* Reward Modal Flex Headers */
        .reward-header-grid {
             display: grid;
             grid-template-columns: repeat(4, 1fr);
             gap: 5px;
             margin-bottom: 10px;
        }
        .reward-header-grid button {
            padding: 5px;
            font-size: 10px;
            white-space: normal;
        }
        
        /* Task 9: Control Box Style */
        #prem-control-box {
            border: 2px solid #333;
            background: #fff3cd;
            color: #856404;
            padding: 10px;
            margin: 10px 0;
            display: none; /* Controlled by admin */
            font-weight: bold;
            border-radius: 5px;
        }
        
        /* Task 12: Dashboard Like/Follow */
        .dash-actions-row {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 10px;
            background: white;
            padding: 10px;
            border-radius: 10px;
        }
        .dash-action-btn {
            background: none;
            border: 1px solid #ccc;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 5px;
            color: #28a745; /* Green as requested */
        }
        .dash-action-btn.active {
            color: #007bff;
            border-color: #007bff;
        }
        
        /* Task 2: VPN Button on Dashboard Header (Small Square) */
        .vpn-header-btn {
            width: 30px; 
            height: 30px; 
            float: right; 
            margin-right: 5px; 
            border-radius: 5px; 
            padding: 0; 
            border: 1px solid #ccc;
            background: white;
            cursor: pointer;
            margin-top: 10px;
        }
        .vpn-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 5px;
        }
        
        /* Task 2: Fix High Quality Button Layout */
        .hq-btn-layout {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 100%;
            width: 100%;
        }
        .hq-logo-right {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 1px solid #333;
        }
        
        /* Policy Button Small */
        .policy-btn-small {
            padding: 3px 8px;
            font-size: 10px;
            width: auto;
        }
        
        /* FWA ID in Header */
        #header-fwa-id {
            font-size: 10px;
            color: #007bff;
            font-weight: bold;
            display: block;
        }
    </style>
</head>
<body>

    <!-- Loading Overlay for Fast Post with Progress Bar -->
    <div id="loading-overlay">
        <div class="loader"></div>
        <h3 id="loading-text" data-lang-key="txt-processing">Processing...</h3>
        <div class="progress-container">
            <div class="progress-bar" id="upload-progress-bar">0%</div>
        </div>
    </div>

    <!-- SPLASH SCREEN (Logo visible for 3 seconds) -->
    <div id="splash-screen">
        <div class="brand-area" style="transform: scale(1.5);">
            <div class="side-logo-container left-logo"><img src="eagle_image.jpg" class="side-logo-img"></div>
            <div class="complex-logo">
                <div class="ring ring-blue"><div class="ring ring-red"><div class="ring ring-yellow"><div class="ring ring-green"></div></div></div></div>
                <img src="lion_image.jpg" class="center-lion">
            </div>
            <div class="side-logo-container right-logo"><img src="dove_image.jpg" class="side-logo-img"></div>
        </div>
        <!-- FWA Brand Text -->
        <div class="fwa-brand">
            <span class="fwa-letter letter-f">F</span>
            <span class="fwa-letter letter-w">W</span>
            <span class="fwa-letter letter-a">A</span>
        </div>
        <div id="splash-msg" data-lang-key="splash-msg">·ä•·äï·ä≥·äï ·ã∞·àµ ·ä†·àà·ãé·âµ ·â†·â∞·à≥·ä´ ·àÅ·äî·â≥ ·â∞·àò·ãù·åç·â†·ãã·àç ·ä•·äì·àò·à∞·åç·äì·àà·äï</div>
    </div>

    <!-- Firebase Status Indicator - PERMANENT -->
    <div id="firebase-status" class="firebase-status">üî• Online</div>

    <!-- Header - Task 10 Updates -->
    <div class="top-header">
        <!-- LEFT HEADER LOGO (FULL LOGO) - Replaced with image_fwa_arma.jpg -->
        <div style="width: 60px; height: 60px; margin-right: 10px;">
             <img src="image_fwa_arma.jpg" style="width:100%; height:100%; object-fit:cover; border-radius:50%; border: 2px solid #007bff;">
        </div>
        
        <div style="display:flex; flex-direction:column; flex:1; overflow:hidden;">
             <span id="header-fwa-id"></span>
             <div class="marquee-container-top"><span class="marquee-text-top" id="head-txt" data-lang-key="head-txt">·ä•·äï·ä≥·äï ·ãà·ã∞ ·çã·à≤·àç ·ãå·â• ·ä†·çï ·ã®·ä†·åà·àç·åç·àé·âµ ·àõ·ãï·ä®·àç ·â†·ã∞·àÖ·äì ·àò·å°!</span></div>
        </div>
        
        <!-- RIGHT HEADER LOGO (FULL LOGO) - Replaced with image_flag_1.jpg -->
        <div style="text-align: right; display: flex; flex-direction: column; align-items: center;">
             <div style="width: 60px; height: 60px;">
                 <img src="image_flag_1.jpg" style="width:100%; height:100%; object-fit:cover; border-radius:50%; border: 2px solid #007bff;">
             </div>
            <button class="lang-btn" onclick="openLangModal()" id="lang-btn-txt" data-lang-key="lang-btn">Language</button>
        </div>
    </div>

    <div class="container">
        
        <!-- VPN Button in Header Area (Task 3) -->
        <button class="vpn-header-btn" onclick="setupVPN()">
            <img src="image_vpn_1.jpg" class="vpn-img" alt="VPN">
        </button>

        <!-- Modals -->
        <div class="modal-overlay" id="custom-modal"><div class="modal-box"><h3 id="modal-title"></h3><p id="modal-msg"></p><button class="btn-blue" onclick="closeModal()">OK</button></div></div>
        
        <div class="modal-overlay" id="pass-modal"><div class="modal-box"><h3 id="pass-title" data-lang-key="pass-req">Password Required</h3><input type="password" id="pass-input" placeholder="Password" style="text-align:center;"><button class="btn-green" onclick="verifyPass()">Confirm</button><button class="btn-red" onclick="document.getElementById('pass-modal').style.display='none'">Cancel</button></div></div>

        <!-- View Info Disclaimer Modal (Task 1) -->
        <div class="modal-overlay" id="view-info-disclaimer"><div class="modal-box">
            <h3 style="color:#dc3545;" data-lang-key="disclaimer-title">·àõ·àµ·å†·äï·âÄ·âÇ·ã´ (Disclaimer)</h3>
            <p id="txt-disclaimer-msg" data-lang-key="txt-disclaimer-msg">·â†·ãö·àÖ ·åà·çÖ ·àã·ã≠ ·ã®·àö·àò·àà·ä®·â±·âµ ·àò·à®·åÉ ·àõ·äï·äõ·ãç·àù ·â∞·å†·âÉ·àö ·â†·äê·çÉ·äê·âµ ·ã®·àö·àà·å•·çè·â∏·ãç ·àç·å•·çé·âΩ ·äê·ãç·ç¢ ·ä•·ãç·äê·â∞·äõ ·ã≠·àÅ·äë ·ä†·ã≠·àÅ·äë ·ã®·àö·â≥·ãà·âÖ ·äê·åà·à≠ ·ã®·àà·àù·ç¢ ·ã≠·àÖ ·ã®·â∞·å†·âÉ·àö·ãé·âΩ ·ã®·äê·çÉ·äê·âµ ·àò·â•·âµ ·äê·ãç·ç¢</p>
            <button class="btn-green" onclick="confirmViewInfo()" id="btn-view-confirm" data-lang-key="btn-view-confirm">·àà·àò·àò·àç·ä®·âµ (View)</button>
            <button class="btn-red" onclick="document.getElementById('view-info-disclaimer').style.display='none'" id="btn-view-cancel" data-lang-key="btn-view-cancel">·ã≠·âÖ·à≠·â•·äù (Cancel)</button>
        </div></div>

        <!-- Admin Action Password Modal -->
        <div class="modal-overlay" id="admin-action-modal"><div class="modal-box"><h3>Admin Verification</h3><input type="password" id="admin-act-pass" placeholder="Admin Code"><button class="btn-green" onclick="runAdminAction()">Verify</button><button class="btn-red" onclick="document.getElementById('admin-action-modal').style.display='none'">Cancel</button></div></div>

        <!-- Report Reason Modal -->
        <div class="modal-overlay" id="report-modal"><div class="modal-box"><h3>Report Post</h3>
            <p>Please enter the reason for reporting:</p>
            <textarea id="report-reason" placeholder="·àù·ä≠·äï·ã´·âµ ·ä†·àµ·åà·â£ (Reason)..."></textarea>
            <button class="btn-green" onclick="submitReport()">OK (Report)</button>
            <button class="btn-red" onclick="document.getElementById('report-modal').style.display='none'">Cancel</button>
        </div></div>

        <!-- Admin Change Pass Modal -->
        <div class="modal-overlay" id="admin-chg-modal"><div class="modal-box"><h3>Change Admin Password</h3>
            <input type="password" id="old-adm" placeholder="Old Admin Code">
            <input type="password" id="new-adm" placeholder="New (abc123456xyz)">
            <input type="password" id="conf-adm" placeholder="Confirm New">
            <button class="btn-green" onclick="saveNewAdminPass()">Change</button>
            <button class="btn-red" onclick="document.getElementById('admin-chg-modal').style.display='none'">Cancel</button>
        </div></div>

        <!-- Admin Premium Pay Modal -->
        <div class="modal-overlay" id="adm-prem-modal"><div class="modal-box"><h3>Premium Payment Receiver</h3>
            <div style="display:flex; gap:10px;">
                <button class="btn-blue" onclick="adminViewPayments('International')">International (PayPal/USDT)</button>
                <button class="btn-green" onclick="adminViewPayments('Local')">Local (Bank/Telebirr)</button>
            </div>
            <div id="admin-payment-list" style="margin-top:10px; text-align:left; max-height:300px; overflow-y:auto;">
                <!-- Dynamic Content -->
            </div>
            <button class="btn-red" onclick="document.getElementById('adm-prem-modal').style.display='none'">Close</button>
        </div></div>
        
        <!-- Admin Withdraw Control Modal -->
        <div class="modal-overlay" id="adm-withdraw-ctrl-modal"><div class="modal-box"><h3>Control Withdraw</h3>
             <div id="admin-withdraw-list" style="text-align:left; max-height:300px; overflow-y:auto;"></div>
             <button class="btn-red" onclick="document.getElementById('adm-withdraw-ctrl-modal').style.display='none'">Close</button>
        </div></div>
        
        <!-- Admin Business Control Modal - Updated Task 5 -->
        <div class="modal-overlay" id="adm-biz-ctrl-modal"><div class="modal-box"><h3>Control Business</h3>
            <button class="btn-green" onclick="setBusinessStatus('open')">Open (·ä≠·çà·âµ)</button>
            <button class="btn-red" onclick="setBusinessStatus('closed')">Close (·ãù·åã)</button>
            <!-- Show/Hide Button -->
            <div style="display:flex; gap:5px;">
                <button class="btn-blue" onclick="toggleBizVisibility('show')">·ä†·à≥·ã≠ (Show Button)</button>
                <button class="btn-red" onclick="toggleBizVisibility('hide')">·ã∞·â•·âÖ (Hide Button)</button>
            </div>
            <button class="btn-yellow" onclick="document.getElementById('adm-rate-chg-modal').style.display='flex'">Change Rates (·â∏·äï·åÖ)</button>
            <hr>
            <button class="btn-blue" onclick="openAdminBizNotif()">·àõ·à≥·ãà·âÖ·ã´ ·àã·ä≠</button>
            <button class="btn-blue" onclick="document.getElementById('adm-biz-ctrl-modal').style.display='none'">Exit</button>
        </div></div>

        <!-- Admin Business Notif Modal -->
        <div class="modal-overlay" id="adm-biz-notif-modal"><div class="modal-box"><h3>Business Notification</h3>
            <textarea id="biz-notif-text" placeholder="Notification Text..."></textarea>
            <button class="btn-green" onclick="sendBizNotif()">·àã·ä≠ (Send)</button>
            <button class="btn-red" onclick="clearBizNotif()">·ä†·å•·çã (Delete)</button>
            <button class="btn-blue" onclick="document.getElementById('adm-biz-notif-modal').style.display='none'">Cancel</button>
        </div></div>

        <!-- Admin Post Control Modal (Task 2.6) -->
        <div class="modal-overlay" id="admin-post-modal"><div class="modal-box"><h3>Admin Post Center</h3>
            <p>Select Content Type for Perfect Info:</p>
            <button class="btn-blue" onclick="setupAdminPost('text')">Text Post</button>
            <button class="btn-blue" onclick="setupAdminPost('image')">Image Post</button>
            <button class="btn-blue" onclick="setupAdminPost('video')">Video Post</button>
            <button class="btn-blue" onclick="setupAdminPost('audio')">Audio Post</button>
            <button class="btn-red" onclick="setupAdminPost('live')">Start Admin Live</button>
            <button class="btn-red" onclick="setupAdminPost('stop-live')">Stop Admin Live</button>
            <button class="btn-red" onclick="document.getElementById('admin-post-modal').style.display='none'">Close</button>
        </div></div>

        <!-- Admin Post Form -->
        <div class="modal-overlay" id="admin-post-form"><div class="modal-box"><h3>Create Admin Post</h3>
            <input type="text" id="adm-p-title" placeholder="Title">
            <textarea id="adm-p-content" placeholder="Content (For text)"></textarea>
            <input type="file" id="adm-p-file" class="hidden-input">
            <button class="btn-blue" onclick="document.getElementById('adm-p-file').click()" id="adm-up-btn">Upload File</button>
            <!-- Task 5: Select Free or Paid -->
            <div style="margin: 10px 0;">
                <label><input type="radio" name="adm-post-target" value="free" checked> ·â†·äê·çÉ (Free - Perfect Info)</label>
                <label><input type="radio" name="adm-post-target" value="paid"> ·â†·ä≠·çç·ã´ (Paid - Premium)</label>
            </div>
            <button class="btn-green" onclick="submitAdminPost()">Post</button>
            <button class="btn-red" onclick="document.getElementById('admin-post-form').style.display='none'">Cancel</button>
        </div></div>
        
        <!-- Admin PremiPost Modal (Task 3) -->
        <div class="modal-overlay" id="adm-premi-post-modal"><div class="modal-box"><h3>Premium Post</h3>
            <p>Select Premium Category:</p>
            <button class="btn-blue" onclick="setupPremiPost('video')">High Quality Video</button>
            <button class="btn-blue" onclick="setupPremiPost('news')">News High Quality</button>
            <button class="btn-blue" onclick="setupPremiPost('image')">Image High Quality</button>
            <button class="btn-red" onclick="document.getElementById('adm-premi-post-modal').style.display='none'">Close</button>
        </div></div>

        <!-- Chat Send Type Modal (Task 4/2) -->
        <div class="modal-overlay" id="chat-send-type-modal"><div class="modal-box"><h3>Select Type to Send</h3>
            <button class="btn-blue" onclick="startChatSend('text')">Text</button>
            <button class="btn-blue" onclick="startChatSend('image')">Image</button>
            <button class="btn-blue" onclick="startChatSend('video')">Video</button>
            <button class="btn-blue" onclick="startChatSend('audio')">Voice</button>
            <button class="btn-red" onclick="document.getElementById('chat-send-type-modal').style.display='none'">Cancel</button>
        </div></div>

        <!-- New "Compose" Modal for Direct Send (Task 2) -->
        <div class="modal-overlay" id="chat-compose-modal"><div class="modal-box"><h3>Send to <span id="compose-target-name"></span></h3>
             <div id="compose-area-text" style="display:none;">
                 <textarea id="compose-msg" placeholder="Type message..."></textarea>
             </div>
             <div id="compose-area-media" style="display:none;">
                 <p>Media Selected: <b id="compose-media-type"></b></p>
                 <button class="btn-blue" onclick="document.getElementById('compose-file').click()">Select File</button>
                 <input type="file" id="compose-file" class="hidden-input">
             </div>
             <button class="btn-green" onclick="finalizeSendMsg()">OK (Send)</button>
             <button class="btn-red" onclick="document.getElementById('chat-compose-modal').style.display='none'">Cancel</button>
        </div></div>

        <!-- Admin Rate Change Modal -->
        <div class="modal-overlay" id="adm-rate-chg-modal"><div class="modal-box"><h3>Change Rates (per 1 USD)</h3>
            <button class="btn-blue" onclick="promptRate('FWA')">FWA</button>
            <button class="btn-blue" onclick="promptRate('ETB')">ETB</button>
            <button class="btn-blue" onclick="promptRate('GBP')">GBP</button>
            <button class="btn-blue" onclick="promptRate('EUR')">EUR</button>
            <button class="btn-red" onclick="document.getElementById('adm-rate-chg-modal').style.display='none'">Close</button>
        </div></div>
        
        <!-- Admin Points Control Modal (Task 14) -->
        <div class="modal-overlay" id="adm-point-ctrl-modal"><div class="modal-box"><h3>Control Points (FWA)</h3>
            <button class="btn-blue" onclick="promptPointRate('share')">Share (Per N People)</button>
            <button class="btn-blue" onclick="promptPointRate('video')">Video (Per N Min)</button>
            <button class="btn-blue" onclick="promptPointRate('audio')">Audio (Per N Min)</button>
            <button class="btn-blue" onclick="promptPointRate('text')">Text (Per N Min)</button>
            <button class="btn-red" onclick="document.getElementById('adm-point-ctrl-modal').style.display='none'">Close</button>
        </div></div>
        
        <!-- Admin Premium Rates Control Modal (Task 8/16) -->
        <div class="modal-overlay" id="adm-prem-rate-ctrl-modal"><div class="modal-box"><h3>Control Premium Rates</h3>
            <p>Select Service to Update:</p>
            <button class="btn-blue" onclick="promptPremRate('ppt')">PowerPoint</button>
            <button class="btn-blue" onclick="promptPremRate('pdf')">PDF</button>
            <button class="btn-blue" onclick="promptPremRate('xfwa')">·çê·à≠·çå·ä≠·âµ ·àò·à®·åÉ ·â†·ä≠·çç·ã´</button>
            <button class="btn-blue" onclick="promptPremRate('video')">High Quality Video</button>
            <button class="btn-blue" onclick="promptPremRate('news')">News High Quality</button>
            <button class="btn-blue" onclick="promptPremRate('image')">Image High Quality</button>
            <button class="btn-red" onclick="document.getElementById('adm-prem-rate-ctrl-modal').style.display='none'">Close</button>
        </div></div>
        
        <!-- Admin Control Size Modal (Task 10/11) -->
        <div class="modal-overlay" id="adm-ctrl-size-modal"><div class="modal-box"><h3>Control Size (Limit)</h3>
            <p>Select Service:</p>
            <select id="ctrl-size-service">
                <option value="ppt">PowerPoint</option>
                <option value="pdf">PDF</option>
            </select>
            <p>Select Duration:</p>
            <select id="ctrl-size-duration">
                <option value="daily">Daily</option>
                <option value="weekly">Weekly</option>
                <option value="monthly">Monthly</option>
                <option value="yearly">Yearly</option>
            </select>
            <input type="number" id="ctrl-size-limit" placeholder="Limit (e.g. 3000 chars)">
            <button class="btn-green" onclick="saveSizeLimit()">Save Limit</button>
            <button class="btn-red" onclick="document.getElementById('adm-ctrl-size-modal').style.display='none'">Close</button>
        </div></div>
        
        <!-- Admin Control Box Modal (Task 9) -->
        <div class="modal-overlay" id="adm-ctrl-box-modal"><div class="modal-box"><h3>Control Box</h3>
            <textarea id="ctrl-box-text" placeholder="Notification Text..."></textarea>
            <button class="btn-green" onclick="updateControlBox('send')">·àã·ä≠ (Send)</button>
            <button class="btn-red" onclick="updateControlBox('delete')">·ä†·å•·çã (Delete)</button>
            <button class="btn-blue" onclick="updateControlBox('hide')">·ã∞·â•·âÖ (Hide)</button>
            <button class="btn-blue" onclick="updateControlBox('show')">·ä†·à≥·ã≠ (Show)</button>
            <button class="btn-red" onclick="document.getElementById('adm-ctrl-box-modal').style.display='none'">Close</button>
        </div></div>

        <!-- Exchange Modal -->
        <div class="modal-overlay" id="exchange-modal"><div class="modal-box"><h3>Exchange Center</h3>
            <button class="btn-blue" onclick="showRates()">View Exchange (·àà·àõ·ã®·âµ)</button>
            <button class="btn-green" onclick="showConvert()">Convert (·àà·àò·âÄ·ã®·à≠)</button>
            <div id="rate-view-area" style="display:none; text-align:left; margin-top:10px; border:1px solid #ccc; padding:10px;"></div>
            <div id="convert-area" style="display:none; margin-top:10px;">
                <p>Convert TO USD From:</p>
                <select id="conv-source">
                    <option value="ETB">ETB</option>
                    <option value="FWA">FWA</option>
                    <option value="GBP">GBP</option>
                    <option value="EUR">EUR</option>
                </select>
                <input type="number" id="conv-amount" placeholder="Amount">
                <button class="btn-green" onclick="doConvert()">OK (Change)</button>
            </div>
            <button class="btn-red" onclick="document.getElementById('exchange-modal').style.display='none'">Close</button>
        </div></div>

        <!-- Admin PDF Control Modal - Updated Task 2 & 3 -->
        <div class="modal-overlay" id="adm-pdf-ctrl-modal"><div class="modal-box"><h3>Control PDF Service</h3>
            <button class="btn-green" onclick="setPdfStatus('open')">Open (·ä≠·çà·âµ)</button>
            <button class="btn-red" onclick="setPdfStatus('closed')">Close (·ãù·åã)</button>
            
            <div style="display:flex; gap:5px; margin-top:5px; flex-wrap:wrap;">
                <button class="btn-blue" onclick="toggleVPNVisibility('show')">·ä†·à≥·ã≠ (VPN Show)</button>
                <button class="btn-red" onclick="toggleVPNVisibility('hide')">·ã∞·â•·âÖ (VPN Hide)</button>
                <!-- Task 2: Payment Like/Follow -->
                <button class="btn-yellow" onclick="adminRewardSettings()">Payment Like & Follow</button>
                <!-- Task 3: Exchange Point -->
                <button class="btn-green" onclick="adminExchangeSettings()">Exchange Point</button>
                <!-- Task 5: Premium Release -->
                <button class="btn-blue" style="background:#6610f2;" onclick="adminPremiumRelease()">Premium Release (·àç·âÄ·âÖ)</button>
                <!-- Task 10: Control Size -->
                <button class="btn-blue" onclick="document.getElementById('adm-ctrl-size-modal').style.display='flex'">Control Size</button>
            </div>
            <hr>
            <button class="btn-blue" onclick="openAdminDashNotif()">·àõ·à≥·ãà·âÖ·ã´ ·àã·ä≠</button>
            <button class="btn-red" onclick="setGlobalLock('lock')">·âÜ·àç·çç (Lock All)</button>
            <button class="btn-green" onclick="setGlobalLock('unlock')">·ä≠·çà·âµ (Unlock All)</button>
            <hr>
            <!-- NEW ADMIN PAY BUTTON -->
            <button class="btn-yellow" onclick="openAdminPay()">·àà·â∞·å†·âÉ·àö·ãà·âΩ ·ä≠·çà·àç</button>
            <!-- Task 12/14 Control Points Button -->
            <button class="btn-blue" onclick="document.getElementById('adm-point-ctrl-modal').style.display='flex'">Control Points</button>
            <button class="btn-blue" onclick="document.getElementById('adm-prem-rate-ctrl-modal').style.display='flex'">Control Prem Rates</button>
            <button class="btn-blue" onclick="document.getElementById('adm-ctrl-box-modal').style.display='flex'">Control Box</button>
            <!-- Task 13: Automatic Control -->
            <button class="btn-blue" style="background-color:purple;" onclick="toggleAutomaticControl()">Control Automatic (<span id="auto-status-text">Open</span>)</button>
            <hr>
            <button class="btn-blue" onclick="document.getElementById('adm-pdf-ctrl-modal').style.display='none'">Exit</button>
        </div></div>

        <!-- Admin Pay Users Modal -->
        <div class="modal-overlay" id="adm-pay-user-modal"><div class="modal-box"><h3>·ä≠·çç·ã´ ·ä•·äì ·àõ·à≥·ãà·âÖ·ã´</h3>
            <button class="btn-green" onclick="adminGivePay('pay')">·ä≠·çç·ã´ ·àµ·å•</button>
            <button class="btn-blue" onclick="adminRewardNotif('send')">·àõ·à≥·ãà·âÖ·ã´ ·àã·ä≠</button>
            <button class="btn-red" onclick="adminRewardNotif('delete')">·àõ·à≥·ãà·âÖ·ã´ ·ä†·å•·çã</button>
            <hr>
            <button class="btn-red" onclick="document.getElementById('adm-pay-user-modal').style.display='none'">Close</button>
        </div></div>

        <!-- Admin Dash Notif Modal -->
        <div class="modal-overlay" id="adm-dash-notif-modal"><div class="modal-box"><h3>Dashboard Notification</h3>
            <textarea id="dash-notif-text" placeholder="Notification Text..."></textarea>
            <button class="btn-green" onclick="sendDashNotif()">·àã·ä≠ (Send)</button>
            <button class="btn-red" onclick="clearDashNotif()">·ä†·å•·çã (Delete)</button>
            <button class="btn-blue" onclick="document.getElementById('adm-dash-notif-modal').style.display='none'">Cancel</button>
        </div></div>

        <!-- REWARDS MODAL - Updated to Grid -->
        <div class="modal-overlay" id="rewards-modal"><div class="modal-box"><h3>·ä≠·çç·ã´ ·ä•·äì ·çñ·ã≠·äï·âµ</h3>
            <!-- Rewards Notification Area -->
            <div id="rewards-notif-area" class="rewards-notif" style="display:none;"></div>
            
            <div class="business-balance-grid">
                <div class="balance-item">
                    <div class="balance-label">FWA Points</div>
                    <div class="balance-value fwa-bal" id="rew-bal-fwa">0.00</div>
                </div>
                <div class="balance-item">
                    <div class="balance-label">USD (·ã∂·àã·à≠)</div>
                    <div class="balance-value usd-bal" id="rew-bal-usd">0.00</div>
                </div>
                 <div class="balance-item">
                    <div class="balance-label">ETB</div>
                    <div class="balance-value etb-bal" id="rew-bal-etb">0.00</div>
                </div>
            </div>
            
            <!-- Horizontal Grid for Buttons -->
            <div class="reward-header-grid">
                <!-- Task 4: View Change Rate Button -->
                <button class="btn-blue btn-small" onclick="viewChangeRate()" id="btn-view-change-rate">View Change Rate</button>
                <button class="btn-blue btn-small" onclick="showRewardsExchange()" id="btn-rew-exchange">·ä¢·ä≠·àµ·â∏·äï·åÖ ·àà·àõ·ãµ·à®·åç</button>
                <button class="btn-yellow btn-small" onclick="showCollectPoints()" id="btn-rew-collect">·çñ·ã≠·äï·âµ ·àà·àò·à∞·â•·à∞·â•</button>
                <button class="btn-green btn-small" onclick="showRewardsRedeem()" id="btn-rew-redeem">·àà·àò·å†·âÄ·àù</button>
                <button class="btn-red btn-small" onclick="showRewardsWithdraw()" id="btn-rew-withdraw">·àà·àõ·ãç·å£·âµ</button>
            </div>
            
            <div id="rew-exchange-area" style="display:none; margin-top:10px; border:1px solid #ccc; padding:5px;">
                <p>Convert:</p>
                <select id="rew-conv-type">
                    <option value="FWA_USD">FWA to USD</option>
                    <option value="USD_FWA">USD to FWA</option>
                </select>
                <input type="number" id="rew-conv-amt" placeholder="Amount">
                <button class="btn-green btn-small" onclick="doRewardExchange()">OK (Change)</button>
            </div>
            
            <div id="rew-redeem-area" style="display:none; margin-top:10px;">
                <p>Pay Using:</p>
                <button class="btn-blue btn-small" onclick="redeemPoints('FWA')">FWA</button>
                <button class="btn-green btn-small" onclick="redeemPoints('USD')">·ã∂·àã·à≠</button>
            </div>
            
            <div id="rew-withdraw-area" style="display:none; margin-top:10px;">
                <p>Withdraw As:</p>
                <div style="display:flex; gap:5px;">
                     <button class="btn-green btn-small" onclick="requestWithdrawal('ETB')">ETB</button>
                     <!-- Task 9: Change Telebirr to USDT -->
                     <button class="btn-blue btn-small" onclick="requestWithdrawal('USDT')">USDT</button>
                </div>
            </div>
            
            <button class="btn-red" onclick="document.getElementById('rewards-modal').style.display='none'" style="margin-top:10px;">Close</button>
        </div></div>

        <!-- Withdraw Input Modal -->
        <div class="modal-overlay" id="withdraw-input-modal"><div class="modal-box"><h3>Withdraw <span id="with-curr"></span></h3>
             <input type="number" id="with-amt-req" placeholder="Amount to Withdraw">
             <div id="with-method-area">
                 <p>Select Method:</p>
                 <select id="with-method-select" onchange="toggleWithMethodInput()">
                     <option value="Telebirr">Telebirr</option>
                     <option value="CBE">CBE (Bank)</option>
                     <!-- Task 9 -->
                     <option value="Crypto">Crypto (USDT)</option>
                     <option value="PayPal">PayPal</option>
                     <option value="Card">Visa/MasterCard</option>
                 </select>
                 <input type="text" id="with-acc-input" placeholder="09... (10 digits)">
             </div>
             <button class="btn-green" onclick="submitWithdrawRequest()">Submit (OK)</button>
             <button class="btn-red" onclick="document.getElementById('withdraw-input-modal').style.display='none'">Cancel</button>
        </div></div>

        <!-- Collect Points Modal (Task 10/11) -->
        <div class="modal-overlay" id="collect-points-modal"><div class="modal-box"><h3>·çñ·ã≠·äï·âµ ·ã≠·à∞·â•·àµ·â°</h3>
            <button class="btn-blue" onclick="setupReferral()" id="btn-share-ref">·àà·åì·ã∞·äõ ·çã·à≤·àç ·ãå·â•·äï ·â†·àõ·åã·à´·âµ</button>
            <button class="btn-green" onclick="setupWatchFree()">·â†·äê·çÉ ·ä†·åà·àç·åç·àé·âµ ·ä•·ãç·äê·â∞·äõ ·àò·à®·åÉ ·â†·àò·àò·àç·ä®·âµ</button>
            <button class="btn-yellow" onclick="setupWatchPrem()">·â†·ä≠·çç·ã´ ·ä†·åà·àç·åç·àé·âµ ·ä•·ãç·äê·â∞·äõ ·àò·à®·åÉ ·â†·àò·àò·àç·ä®·âµ</button>
            <button class="btn-blue" onclick="showTransferFWA()">·àà·åì·ã∞·äõ·ãé FWA ·çñ·ã≠·äï·âµ ·ã≠·àã·ä©</button>
            <button class="btn-red" onclick="document.getElementById('collect-points-modal').style.display='none'">Close</button>
        </div></div>
        
        <!-- FWA Transfer Modal -->
        <div class="modal-overlay" id="fwa-transfer-modal"><div class="modal-box"><h3>Send FWA Points</h3>
            <div id="fwa-transfer-list"></div>
            <button class="btn-red" onclick="document.getElementById('fwa-transfer-modal').style.display='none'">Close</button>
        </div></div>
        
        <!-- Referral Link Modal -->
        <div class="modal-overlay" id="referral-modal"><div class="modal-box"><h3>·àõ·åã·à≠·ã´</h3>
            <p id="ref-desc">·çã·à≤·àç ·ãå·â• ·ä†·çï·äï ·â†·à∂·àª·àç ·àö·ã≤·ã´ ·ã´·åã·à©·ç¢</p>
            <p><span id="ref-target-display">5</span> ·à∞·ãç ·â†·à≠·àµ·ãé ·åã·â†·ãõ ·ä®·â∞·àò·ãò·åà·â° <span id="ref-rew-amt">0.7</span> FWA ·ã´·åà·äõ·àâ·ç¢</p>
            <button class="btn-green" onclick="copyRefLink()" id="btn-copy-link">Share Link (Copy)</button>
            <button class="btn-red" onclick="document.getElementById('referral-modal').style.display='none'">Close</button>
        </div></div>

        <!-- Watch Reward Info Modal -->
        <div class="modal-overlay" id="watch-reward-modal"><div class="modal-box"><h3>·àõ·àµ·å†·äï·âÄ·âÇ·ã´</h3>
            <p id="watch-reward-msg"></p>
            <button class="btn-green" onclick="startWatchSession()">OK (·åÄ·àù·à≠)</button>
            <button class="btn-red" onclick="document.getElementById('watch-reward-modal').style.display='none'">·ã≠·âÖ·à≠·â•·äù</button>
        </div></div>

        <!-- Group Control Modal (Task 4) -->
        <div class="modal-overlay" id="grp-ctrl-modal"><div class="modal-box"><h3 id="grp-ctrl-title">Group Control</h3>
             <div id="grp-owner-opts" style="display:none;">
                 <button class="btn-red" onclick="showGrpMembers('ban')">·ä†·â£·àç ·â∞·âÜ·å£·å†·à≠/·ä†·åç·ãµ</button>
                 <button class="btn-red" onclick="showGrpMembers('add_admin')">·àú·ä≠·âµ ·å®·àù·à≠</button>
                 <button class="btn-red" onclick="showGrpMembers('remove_admin')">·ä®·ä†·ãµ·àö·äï ·ä†·àµ·ãà·åç·ãµ</button>
                 <button class="btn-blue" onclick="grpAction('requests')">·ã®·àò·âÄ·àã·âÄ·àç ·å•·ã´·âÑ</button>
                 <button class="btn-green" onclick="openGrpChat()">·â†·åç·à©·çï ·ã≠·å´·ãà·â±</button>
                 <button class="btn-yellow" onclick="startAdminLiveStream()">Live Start</button>
             </div>
             <div id="grp-guest-opts" style="display:none;">
                 <p id="grp-status-text">Join to see content.</p>
                 <button class="btn-green" onclick="grpAction('join')" id="btn-grp-join">Join (·ã≠·âÄ·àã·âÄ·àâ)</button>
                 <!-- New Play Button for Task 1 -->
                 <button class="btn-green" onclick="openGrpChat()" id="btn-grp-play" style="display:none;">·â†·åç·à©·çï ·ã≠·å´·ãà·â±</button>
             </div>
             <button class="btn-red" onclick="document.getElementById('grp-ctrl-modal').style.display='none'">Close</button>
        </div></div>

        <!-- Group Members List Modal -->
        <div class="modal-overlay" id="grp-members-modal"><div class="modal-box"><h3 id="grp-members-title">Members</h3>
             <div id="grp-members-list"></div>
             <button class="btn-red" onclick="document.getElementById('grp-members-modal').style.display='none'">Close</button>
        </div></div>

        <!-- Language Modal -->
        <div class="modal-overlay" id="lang-modal"><div class="modal-box"><h3>Select Language</h3>
            <button class="btn-blue btn-small" onclick="setLang('en')">English</button>
            <button class="btn-blue btn-small" onclick="setLang('am')">Amharic (·ä†·àõ·à≠·äõ)</button>
            <button class="btn-blue btn-small" onclick="setLang('or')">Oromiffa (Afaan Oromoo)</button>
            <button class="btn-blue btn-small" onclick="setLang('tg')">Tigrinya (·âµ·åç·à≠·äõ)</button>
            <button class="btn-blue btn-small" onclick="setLang('fr')">French (Fran√ßais)</button>
            <button class="btn-blue btn-small" onclick="setLang('ch')">Chinese (‰∏≠Êñá)</button>
            <button class="btn-red" onclick="document.getElementById('lang-modal').style.display='none'">Close</button>
        </div></div>

        <!-- Watch/Talk Modal -->
        <div class="modal-overlay" id="watch-talk-modal"><div class="modal-box"><h3>Live Action</h3>
            <p>Select option for <b id="live-target-user"></b></p>
            <button class="btn-green" onclick="joinLive('watch')">Watch (·â∞·ä®·â≥·â∞·àç)</button>
            <button class="btn-blue" onclick="joinLive('talk')">Talk (·ä†·ãç·à´)</button>
            <button class="btn-red" onclick="document.getElementById('watch-talk-modal').style.display='none'">Cancel</button>
        </div></div>

        <!-- Comment Action Modal -->
        <div class="modal-overlay" id="comment-type-modal"><div class="modal-box"><h3 id="t-com-act">Action</h3>
            <button class="btn-blue" onclick="openComSub('give')">Give Comment</button>
            <button class="btn-blue" onclick="openComSub('view')">View Comments</button>
            <button class="btn-red" onclick="document.getElementById('comment-type-modal').style.display='none'">Cancel</button>
        </div></div>

        <!-- Give/View Sub Modal -->
        <div class="modal-overlay" id="comment-media-modal"><div class="modal-box"><h3 id="t-com-media">Select Type</h3>
            <button class="btn-blue" onclick="processComment('text')">Text</button>
            <button class="btn-blue" onclick="processComment('image')">Image</button>
            <button class="btn-blue" onclick="processComment('video')">Video</button>
            <button class="btn-blue" onclick="processComment('audio')">Voice</button>
            <button class="btn-red" onclick="document.getElementById('comment-media-modal').style.display='none'">Cancel</button>
        </div></div>

        <!-- View Comments List Modal -->
        <div class="modal-overlay" id="view-comments-list-modal"><div class="modal-box"><h3>Comments</h3><div id="comments-display-area" style="text-align:left; max-height:300px; overflow-y:auto;"></div><button class="btn-red" onclick="document.getElementById('view-comments-list-modal').style.display='none'">Close</button></div></div>

        <!-- Share Modal -->
        <div class="modal-overlay" id="share-modal"><div class="modal-box"><h3>Share To</h3>
            <button class="btn-blue" onclick="shareTo('telegram')">Telegram</button>
            <button class="btn-blue" onclick="shareTo('facebook')">Facebook</button>
            <button class="btn-blue" onclick="shareTo('tiktok')">TikTok</button>
            <button class="btn-blue" onclick="shareTo('youtube')">YouTube</button>
            <button class="btn-green" onclick="setupFWAShare()">FWA (Share to Users)</button>
            <button class="btn-red" onclick="closeShare()">Close</button>
        </div></div>

        <div class="modal-overlay" id="admin-login-modal"><div class="modal-box"><h3>Admin Verification</h3><input type="password" id="admin-pass-in" placeholder="Admin Code (Hidden)"><button class="btn-green" onclick="adminLogin()">Enter</button><button class="btn-red" onclick="document.getElementById('admin-login-modal').style.display='none'">Cancel</button></div></div>

        <!-- Receipt Modal -->
        <div class="modal-overlay" id="receipt-modal"><div class="modal-box"><h3>Payment Receipt</h3>
            <p>Receipt Uploaded Successfully.</p>
            <div id="receipt-actions">
                <button class="btn-blue" onclick="downloadReceipt()">Save Receipt to Phone</button>
                <button class="btn-green" onclick="closeReceiptModal()">Receive Receipt (OK)</button>
            </div>
        </div></div>
        
        <!-- Conversion Progress Modal -->
        <div class="modal-overlay" id="convert-progress-modal"><div class="modal-box">
             <h3>Converting...</h3>
             <div class="progress-container">
                 <div class="progress-bar" id="convert-progress-bar">0%</div>
             </div>
             <p id="convert-status-text">Processing...</p>
             <button class="btn-green" id="btn-download-converted" style="display:none;" onclick="downloadConvertedFile()">Download</button>
             <button class="btn-red" id="btn-close-convert" style="display:none;" onclick="document.getElementById('convert-progress-modal').style.display='none'">Close</button>
        </div></div>
        
        <!-- PPT/PDF Input Modal -->
        <div class="modal-overlay" id="ppt-pdf-input-modal"><div class="modal-box">
             <h3 id="ppt-pdf-title">Convert File</h3>
             <button class="btn-blue" onclick="setupConversionInput('text')">Write Text (·çÉ·çç)</button>
             <button class="btn-yellow" onclick="setupConversionInput('file')">From File (·ä®·çã·ã≠·àç)</button>
             
             <div id="conv-input-area" style="display:none; margin-top:10px;">
                 <textarea id="conv-text-input" placeholder="Enter text here..." style="display:none; height:100px;"></textarea>
                 <input type="file" id="conv-file-input" class="hidden-input" accept="image/*, .txt">
                 <button class="btn-blue" id="btn-upload-conv-file" style="display:none;" onclick="document.getElementById('conv-file-input').click()">Select File</button>
                 <button class="btn-green" onclick="startRealConversion()">Convert & Download</button>
             </div>
             
             <button class="btn-red" onclick="document.getElementById('ppt-pdf-input-modal').style.display='none'" style="margin-top:10px;">Cancel</button>
        </div></div>

        <!-- Payment Methods Modal (Task 10) -->
        <div class="modal-overlay" id="payment-method-modal"><div class="modal-box"><h3>Select Payment Method</h3>
             <p id="pay-method-msg"></p>
             <button class="btn-green" onclick="processPayment('FWA')">Pay with FWA Point</button>
             <button class="btn-blue" onclick="processPayment('ETB')">Pay with ETB</button>
             <!-- Task 9: Update Payment Text -->
             <button class="btn-yellow" onclick="processPayment('USDT')">Pay with USDT/Card</button>
             <button class="btn-red" onclick="document.getElementById('payment-method-modal').style.display='none'">Cancel</button>
        </div></div>
        
        <!-- USDT Options Modal Updated Task 9 -->
        <div class="modal-overlay" id="usdt-options-modal"><div class="modal-box"><h3>USDT/PayPal/Crypto/Card Payment</h3>
             <p>Choose Option:</p>
             <div style="display:flex; flex-wrap:wrap; gap:5px; justify-content:center;">
                 <button class="btn-blue btn-tiny" onclick="setupUsdtType('USDT')">USDT</button>
                 <button class="btn-blue btn-tiny" onclick="setupUsdtType('PayPal')">PayPal</button>
                 <button class="btn-blue btn-tiny" onclick="setupUsdtType('Crypto')">Crypto</button>
                 <button class="btn-blue btn-tiny" onclick="setupUsdtType('Card')">Master/Visa Card</button>
             </div>
             <input type="text" id="usdt-card-input" placeholder="Card/Wallet Address" style="margin-top:10px;">
             <input type="text" id="usdt-trans-id" placeholder="Transaction ID">
             <button class="btn-blue" onclick="promptUpload('pay-intl')">Upload Screenshot</button>
             <input type="file" id="file-pay-intl" class="hidden-input">
             <button class="btn-green" onclick="submitIntlPayment()">Submit for Approval</button>
             <button class="btn-red" onclick="document.getElementById('usdt-options-modal').style.display='none'">Cancel</button>
        </div></div>

        <!-- FWA Notes Modal - UPDATED -->
        <div class="modal-overlay" id="fwa-notes-modal"><div class="modal-box">
            <h3>FWA Notes Images and Designs</h3>
            <div id="fwa-buttons-container" class="fwa-notes-grid">
                <button class="fwa-note-btn" onclick="showFWAImage(1)">1 FWA</button>
                <button class="fwa-note-btn" onclick="showFWAImage(5)">5 FWA</button>
                <button class="fwa-note-btn" onclick="showFWAImage(10)">10 FWA</button>
                <button class="fwa-note-btn" onclick="showFWAImage(50)">50 FWA</button>
                <button class="fwa-note-btn" onclick="showFWAImage(100)">100 FWA</button>
                <button class="fwa-note-btn" onclick="showFWAImage(200)">200 FWA</button>
                <button class="fwa-note-btn" onclick="showFWAImage(500)">500 FWA</button>
                <button class="fwa-note-btn" onclick="showFWAImage(1000)">1000 FWA</button>
            </div>
            <div id="fwa-image-display" class="fwa-image-container" style="display:none;">
                <!-- Image will be displayed here -->
            </div>
            <button class="btn-red fwa-back-btn" onclick="closeFWAViewer()" style="display:none;">Back to FWA Notes</button>
            <button class="btn-red" onclick="document.getElementById('fwa-notes-modal').style.display='none'" style="margin-top: 15px;">Close</button>
        </div></div>

        <!-- Verification Modal -->
        <div class="modal-overlay" id="verification-modal"><div class="modal-box"><h3>Verification Required</h3>
            <div id="verif-step-1">
                <p>Choose Verification Method:</p>
                <button class="btn-blue" onclick="startVerification('google')">Verify via Google (Automatic)</button>
                <button class="btn-yellow" onclick="startVerification('admin')">Verify via Admin (Manual)</button>
            </div>
            <div id="verif-step-google" style="display:none;">
                <input type="text" id="verif-otp" placeholder="Enter SMS OTP">
                <input type="text" id="verif-email-code" placeholder="Enter Email Code">
                <button class="btn-green" onclick="finalizeVerification('google')">Confirm Codes</button>
            </div>
            <div id="verif-step-admin" style="display:none;">
                <p>Please contact Admin for code.</p>
                <input type="text" id="verif-admin-code" placeholder="Enter Admin Code">
                <button class="btn-green" onclick="finalizeVerification('admin')">Confirm Code</button>
            </div>
            <button class="btn-red" onclick="document.getElementById('verification-modal').style.display='none'">Cancel</button>
        </div></div>

        <!-- 1. AGREEMENT & WELCOME (UPDATED - HIDDEN CONTENT) -->
        <div id="view-agreement" class="section show">
            <div id="welcome-content">
                <div style="text-align:center; margin-bottom:10px;">
                    <button class="btn-blue policy-btn-small" onclick="togglePolicy()" id="btn-toggle-policy" data-lang-key="btn-policy">·çñ·àä·à≤ (Policy)</button>
                </div>
                
                <!-- HIDDEN BY DEFAULT (Task 1) -->
                <div id="policy-content" style="display:none;">
                    <div class="split-container">
                        <div class="split-left">
                            <h4 id="t-w-s" data-lang-key="t-w-s">·ä•·äï·ä≥·äï ·ã∞·àÖ·äì ·àò·å°</h4>
                            <p id="t-in" data-lang-key="t-in">·ã≠·àÖ ·ã®·çã·à≤·àç ·ãå·â• ·ä†·çï ·â†·â∞·ä†·àõ·äí·äê·âµ ·ä•·äï·ã≤·à∞·à´ ·ã®·â∞·âÄ·ã®·à∞ ·ã≤·åÇ·â≥·àç ·àò·à®·åÉ ·àò·åã·à™·ã´ ·äê·ãç·ç¢ ·àÅ·àå·àù ·âµ·ä≠·ä≠·àà·äõ ·àò·à®·åÉ·ãé·âΩ·äï ·ã´·âÄ·à≠·â£·àç·ç¢ ·ä•·ãç·äê·â∞·äõ ·àò·à®·åÉ·ãà·âΩ·äï ·àò·àò·àç·ä®·âµ ·ä•·äì ·àò·åã·à´·âµ ·ã≠·âΩ·àã·àâ ·â†·â∞·å®·àõ·à™·àù ·àå·àé·âΩ ·ã®·çì·ãà·à≠ ·çñ·ã≠·äï·âµ ·ã®·â¢·ãù·äê·àµ ·ä•·äì ·çí·ã≤·ä§·çç ·ä†·åà·àç·åç·àé·â∂·âΩ·äï ·ã´·åà·äõ·àâ ·ä•·äì·àò·à∞·åç·äì·àà·äï·ç¢</p>
                        </div>
                        <div class="split-right">
                            <h4 id="t-p-s" data-lang-key="t-p-s">·å•·â•·âÖ ·àò·àò·à™·ã´</h4>
                            <p id="t-po" data-lang-key="t-po">·çñ·àà·â≤·ä´·ç£ ·å•·àã·âª·ç£ ·ãò·à®·äù·äê·âµ ·ä•·äì ·àÄ·à∞·â∞·äõ ·àò·à®·åÉ ·àõ·âÖ·à®·â• ·â†·å•·â•·âÖ ·ã®·â∞·ä®·àà·ä®·àà ·äê·ãç·ç¢ ·çñ·àä·à≤·ã´·âΩ·äï ·å•·à∞·ãç ·ä®·â∞·åà·äô ·â†·å•·â•·âÖ ·ã®·à≤·àµ·â∞·àù ·âÅ·å•·å•·à´·âΩ·äï ·ä•·äì ·â†·å•·â•·âÖ ·à≤·àµ·â∞·àõ·âΩ·äï ·â†·à´·àµ ·à∞·à≠ ·ä®·ä†·åà·àç·åç·àé·â≥·âΩ·äï ·à≤·àµ·â∞·àù ·àä·ã´·åç·ãµ·ãà·âµ ·ã≠·âΩ·àã·àç·ç¢</p>
                        </div>
                    </div>
                
                    <div style="display: flex; gap: 10px; margin-top: 5px; justify-content: center;">
                        <button class="btn-green btn-tiny" onclick="handleAgree()" id="btn-agree" data-lang-key="btn-agree">·ä•·àµ·àõ·àõ·àà·àÅ</button>
                        <button class="btn-red btn-tiny" onclick="handleDisagree()" id="btn-disagree" data-lang-key="btn-disagree">·ä†·àç·àµ·àõ·àõ·àù</button>
                    </div>
                </div>
                <div class="blue-spacer"></div>
                
                <!-- Main Logo with FWA Brand -->
                <div class="brand-area" id="main-brand-logo">
                    <div class="side-logo-container left-logo"><img src="eagle_image.jpg" class="side-logo-img"></div>
                    <div class="complex-logo">
                        <div class="ring ring-blue"><div class="ring ring-red"><div class="ring ring-yellow"><div class="ring ring-green"></div></div></div></div>
                        <img src="lion_image.jpg" class="center-lion">
                    </div>
                    <div class="side-logo-container right-logo"><img src="dove_image.jpg" class="side-logo-img"></div>
                </div>
                
                <!-- FWA Brand Text -->
                <div class="fwa-brand">
                    <span class="fwa-letter letter-f">F</span>
                    <span class="fwa-letter letter-w">W</span>
                    <span class="fwa-letter letter-a">A</span>
                </div>

            </div>
            <div id="auth-section" style="display:none;">
                <p style="color: green; font-weight: bold; font-size: 14px;" id="t-thx" data-lang-key="t-thx">·ä†·åà·àç·åç·àé·â≥·âΩ·äï·äï ·àµ·àà·àò·à®·å° ·ä•·äì·àò·à∞·åç·äì·àà·äï! ·ä†·ã≤·àµ ·ä®·àÜ·äë ·ã≠·àò·ãù·åà·â°·ç£ ·ä´·àà·ãé·âµ ·ã≠·åç·â°·ç¢</p>
                <div style="display:flex; gap:10px;"><button class="btn-red" onclick="showAuth('signup')" id="btn-sh-s" data-lang-key="btn-sh-s">·àò·àò·ãù·åà·â¢·ã´</button><button class="btn-red" onclick="showAuth('login')" id="btn-sh-l" data-lang-key="btn-sh-l">·àò·åç·â¢·ã´</button></div>
                
                <div id="form-signup" style="display:none; margin-top:10px; border: 1px solid #dc3545; padding: 10px; border-radius: 5px;">
                    <div id="signup-step-1">
                        <h3 style="color:#dc3545;" id="h-s" data-lang-key="h-s">·àù·ãù·åà·â£ (·ä†·ã≤·àµ ·â•·âª)</h3>
                        <input type="text" id="reg-name" placeholder="Full Name">
                        <input type="text" id="reg-phone" placeholder="Phone (09... 10 digits)">
                        <input type="email" id="reg-email" placeholder="Email (@gmail.com only)">
                        <!-- Simple referral tracking -->
                        <input type="text" id="reg-ref" placeholder="Referrer Phone (Optional - ·àõ·äï ·åã·â†·ãò·ãé·âµ)">
                        <div class="password-wrapper">
                            <input type="password" id="reg-pass" placeholder="Password (6 digits)">
                            <button class="toggle-password" type="button" onclick="togglePasswordVisibility('reg-pass', this)">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <button class="btn-green" onclick="preSignup()" data-lang-key="btn-next">Next</button>
                    </div>
                    <div id="signup-step-2" style="display:none;">
                        <h3>Upload Profile Photo</h3>
                        <button class="btn-blue" onclick="promptUpload('profile')">Upload Photo</button>
                        <input type="file" id="file-profile" class="hidden-input" accept="image/*">
                        <button class="btn-green" onclick="showVerificationChoice()" data-lang-key="btn-confirm">Confirm</button>
                    </div>
                </div>

                <div id="form-login" style="display:none; margin-top:10px; border: 1px solid #dc3545; padding: 10px; border-radius: 5px;">
                    <h3 style="color:#dc3545;" id="h-l" data-lang-key="h-l">·àò·åç·â¢·ã´ (·äê·â£·à≠)</h3>
                    <input type="text" id="log-phone" placeholder="Phone">
                    <div class="password-wrapper">
                        <input type="password" id="log-pass" placeholder="Password">
                        <button class="toggle-password" type="button" onclick="togglePasswordVisibility('log-pass', this)">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <button class="btn-blue" onclick="doLogin()" data-lang-key="btn-login">Login</button>
                </div>
            </div>
        </div>

        <!-- 2. MAIN DASHBOARD - UPDATED LAYOUT -->
        <div id="view-home" class="section">
            <div style="display:flex; align-items:center; justify-content:space-between; border-bottom:1px solid #ddd; padding-bottom:5px;">
                <div style="display:flex; align-items:center;">
                    <!-- DASHBOARD HEADER LOGO -->
                    <div style="width: 50px; height: 50px; margin-right: 10px;">
                        <img src="image_fwa_arma.jpg" style="width:100%; height:100%; object-fit:cover; border-radius:50%; border: 2px solid #007bff;">
                    </div>
                    <h2 id="t-d" style="margin:0;" data-lang-key="t-d">·ã≥·àΩ·â¶·à≠·ãµ</h2>
                </div>
                
                <!-- NEW: Rewards Button -->
                <button class="btn-green btn-tiny" style="width:auto; padding:5px 10px; background-color:#17a2b8;" onclick="checkGlobalLock('openRewards')" id="btn-dash-rewards" data-lang-key="btn-dash-rewards">·ä≠·çç·ã´ ·ã≠·âÄ·â†·àâ/·çñ·ã≠·äï·âµ</button>
            </div>
            
            <!-- Task 2: VPN Button Below Rewards Button (Actually on Dashboard below header) -->
            <button class="vpn-dashboard-btn" onclick="setupVPN()" id="btn-vpn-dash" style="display:none;"> <!-- Hidden here as moved to header -->
                ·â™·â¢·ä§·äï___·ã´·â•·à© <img src="proton_icon.png" class="proton-icon" alt="Proton">
            </button>
            
            <!-- Task 6: Dashboard Notification Area -->
            <div id="dashboard-notif-area" style="display:none;" class="dashboard-notif"></div>

            <div class="dash-layout" style="margin-top:10px;">
                <div class="dash-left">
                    <!-- Horizontal Flex Container for Free/Premium Buttons -->
                    <div style="display:flex; gap:5px; margin-bottom:5px;">
                        <div style="flex:1;">
                            <button class="btn-green" style="border-radius: 0; width:100%; height:100%;" id="btn-fc" onclick="checkGlobalLock('toggleList', 'free')" data-lang-key="btn-fc">
                                ·ã®·äê·çÉ<br>·ä†·åà·àç·åç·àé·âµ<br>·àõ·ãï·ä®·àç
                            </button>
                        </div>
                        <div style="flex:1;">
                            <button class="btn-yellow" style="border-radius: 0; width:100%; height:100%;" id="btn-pc" onclick="checkGlobalLock('toggleList', 'prem')" data-lang-key="btn-pc">
                                ·ã®·ä≠·çç·ã´<br>·çï·à™·àö·ã®·àù<br>·ä†·åà·àç·åç·àé·âµ
                            </button>
                        </div>
                    </div>
                    
                    <div id="list-free" style="display:none; padding-left: 10px;">
                        <!-- Horizontal arrangement for free buttons where possible -->
                        <div class="flex-row">
                             <button class="btn-green btn-small" onclick="checkGlobalLock('checkViewInfoDisclaimer')" id="btn-lv" data-lang-key="btn-lv">·àò·à®·åÉ ·àò·àò·àç·ä®·âµ</button>
                             <button class="btn-green btn-small" onclick="checkGlobalLock('navTo', 'post-info')" id="btn-lp" data-lang-key="btn-lp">·àò·à®·åÉ ·àò·àà·å†·çç</button>
                        </div>
                        <div class="flex-row">
                            <!-- Task 2: Red Button for Free -->
                            <button class="btn-red btn-small" style="position:relative;" onclick="checkGlobalLock('navTo', 'view-perfect-info-free')" id="btn-perf-free" data-lang-key="btn-perf-free">
                                ·ä•·ãç·äê·â∞·äõ ·çê·à≠·çå·ä≠·âµ ·àò·à®·åÉ
                                <span id="perfect-info-indicator"></span>
                            </button>
                        </div>
                        <div class="flex-row">
                             <button class="btn-green btn-small" onclick="checkGlobalLock('handleGroupCreate')" id="btn-lg" data-lang-key="btn-lg">·åç·à©·çï ·àò·çç·å†·à≠</button>
                             <button class="btn-green btn-small" onclick="checkGlobalLock('showMyGroups')" id="btn-lmg" data-lang-key="btn-lmg">·ã®·çà·å†·à©·âµ·äï ·åç·à©·çï ·àà·àò·àò·àç·ä®·âµ</button>
                        </div>
                        <div class="flex-row">
                             <button class="btn-green btn-small" onclick="checkGlobalLock('handleChatList')" id="btn-lc" data-lang-key="btn-lc">·âª·âµ</button>
                             <button class="btn-green btn-small" onclick="checkGlobalLock('showUserList', 'users')" id="btn-lu" data-lang-key="btn-lu">·â∞·å†·âÉ·àö·ãé·âΩ</button>
                        </div>
                        <button class="btn-green btn-small" onclick="checkGlobalLock('navTo', 'feedback-sec')" id="btn-lf" data-lang-key="btn-lf">·àà·çã·à≤·àç ·ãå·â• ·ä†·çï ·çà·å£·à™ ·ä†·àµ·â∞·ã´·ã®·âµ ·àà·àò·àµ·å†·âµ ·ä•·äì ·àà·àò·àò·àç·ä®·âµ</button>
                        <button class="btn-green btn-small" onclick="checkAuth('business-sec')" id="btn-lb" data-lang-key="btn-lb">·â¢·ãù·äê·àµ</button>
                        <!-- Task 4: Live Watch Removed from Free Service -->
                        <button class="btn-green btn-small" style="background-color:#333; display:none;" onclick="checkAuth('report-inbox')" id="btn-admin-rep">·à™·çñ·à≠·âµ ·àò·âÄ·â†·ã´ (Admin)</button>
                    </div>

                    <div id="list-prem" style="display:none; padding-left: 10px;">
                        <!-- Premium buttons in horizontal grid -->
                        <div class="grid-3-col">
                            <button class="btn-yellow btn-small" onclick="checkPremAccess('video')" id="btn-prem-vid" data-lang-key="btn-prem-vid">·å•·à´·âµ ·ã´·àà·ãç ·â™·ã≤·ãÆ</button>
                            <button class="btn-yellow btn-small" onclick="checkPremAccess('news')" id="btn-prem-news" data-lang-key="btn-prem-news">·ãú·äì (High Quality)</button>
                            <!-- Task 2: High Quality Layout Fix -->
                            <button class="btn-yellow btn-small hq-btn-layout" onclick="checkPremAccess('image')" id="btn-prem-img">
                                <span data-lang-key="btn-prem-img">·àù·àµ·àç (High Quality)</span>
                                <img src="image_fasil_1.jpg" class="hq-logo-right">
                            </button>
                            
                            <button class="btn-yellow btn-small" onclick="checkPremAccess('ppt')" id="btn-pp" data-lang-key="btn-pp">PowerPoint</button>
                            <button class="btn-yellow btn-small" onclick="checkPremAccess('pdf')" id="btn-ppdf" data-lang-key="btn-ppdf">PDF</button>
                            <!-- Task 10: Black Button for Paid Perfect Info -->
                            <button class="btn-black btn-small" onclick="checkPremAccess('xfwa')" id="btn-perf-paid" data-lang-key="btn-perf-paid">·çê·à≠·çå·ä≠·âµ ·àò·à®·åÉ ·â†·ä≠·çç·ã´</button>
                        </div>
                    </div>
                </div>
                <div class="dash-right">
                    <!-- RIGHT PANEL LOGO - Replaced with image_fasil_1.jpg (Task 9) -->
                    <div class="brand-area" style="transform: scale(0.5);">
                        <div class="side-logo-container left-logo"><img src="eagle_image.jpg" class="side-logo-img"></div>
                        <div class="complex-logo">
                            <div class="ring ring-blue">
                                <div class="ring ring-red">
                                    <div class="ring ring-yellow"></div>
                                    <div class="ring ring-green"></div>
                                </div>
                            </div>
                            <!-- Task 9: Replaced center image with image_fasil_1.jpg -->
                            <img src="image_fasil_1.jpg" class="center-lion" style="background-color: transparent; border: none;">
                        </div>
                        <div class="side-logo-container right-logo"><img src="dove_image.jpg" class="side-logo-img"></div>
                    </div>
                </div>
            </div>
            
            <button class="btn-green" style="margin-top:20px;" onclick="doLogout()" id="btn-out" data-lang-key="btn-out">·ãç·å£</button>
            
            <!-- Task 12: Dashboard Like/Follow Buttons -->
            <div class="dash-actions-row">
                <button class="dash-action-btn" onclick="dashboardAction('like')" id="dash-like-btn">
                    <i class="fas fa-heart"></i> Like <span id="dash-like-count">0</span>
                </button>
                <button class="dash-action-btn" onclick="dashboardAction('follow')" id="dash-follow-btn">
                    <i class="fas fa-user-plus"></i> Follow <span id="dash-follow-count">0</span>
                </button>
            </div>
        </div>

        <!-- 3. SECTIONS -->

        <!-- Post Info (Replaced with Code A version + Task 2 Loading) -->
        <div id="post-info" class="section">
            <h3 id="t-ph" data-lang-key="t-ph">·àò·à®·åÉ ·àò·àà·å†·çç</h3>
            <div id="post-type-select">
                <button class="btn-blue" onclick="setupPost('text')" id="btn-pt">üìù Text</button>
                <button class="btn-blue" onclick="setupPost('image')" id="btn-pi">üì∑ Image</button>
                <button class="btn-blue" onclick="setupPost('video')" id="btn-pv">üé• Video</button>
                <button class="btn-blue" onclick="setupPost('audio')" id="btn-pa">üéôÔ∏è Audio</button>
            </div>
            <div id="post-form-area" style="display:none; border-top:1px solid #ccc; margin-top:10px; padding-top:10px;">
                <p id="post-instr" style="color:blue; font-size:12px;"></p>
                <div style="display:flex; gap:5px;">
                     <input type="text" id="p-title" placeholder="Title (Required)">
                     <button class="btn-red btn-tiny" onclick="clearPostForm()">·ä†·çÖ·ã≥ (Clear)</button>
                </div>
                <textarea id="p-content" placeholder="Details (Text Only)..." style="display:none;"></textarea>
                <input type="file" id="file-post" class="hidden-input">
                <button class="btn-green" onclick="submitPost()" id="btn-pnow">Post Now</button>
            </div>
            <button class="btn-red btn-small" onclick="goBack()" id="btn-bk1">Back</button>
        </div>

        <!-- View Info (Standard User Posts) -->
        <div id="view-info" class="section">
            <h3 id="t-vh" data-lang-key="t-vh">·àò·à®·åÉ ·àò·àò·àç·ä®·âµ (User Posts)</h3>
            <div style="display:flex; gap:5px;">
                <button class="btn-blue btn-small" onclick="renderPosts('text')" id="btn-vt">Text</button>
                <button class="btn-blue btn-small" onclick="renderPosts('image')" id="btn-vi">Image</button>
                <button class="btn-blue btn-small" onclick="renderPosts('video')" id="btn-vv">Video</button>
                <button class="btn-blue btn-small" onclick="renderPosts('audio')" id="btn-va">Audio</button>
            </div>
            <div id="feed-container" style="margin-top:10px;"></div>
            <button class="btn-red btn-small" onclick="goBack()" id="btn-bk2">Back</button>
        </div>

        <!-- Task 2: Perfect Info Section (Free - Red Button) -->
        <div id="view-perfect-info-free" class="section">
            <h3 style="color:#28a745;" id="perfect-header-title" data-lang-key="perfect-header-title">·ä•·ãç·äê·â∞·äõ ·çê·à≠·çå·ä≠·âµ ·àò·à®·åÉ (Free)</h3>
            <p id="txt-perf-desc" data-lang-key="txt-perf-desc">·â†·ãö·àÖ ·åà·çÖ ·ä•·ãç·äê·â∞·äõ ·àò·à®·åÉ ·ã´·åà·äõ·àâ ·çê·à≠·çå·ä≠·âµ ·àò·à®·åÉ ·äê·ãç·ç¢</p>
            <!-- Only Admin "Free" Posts -->
             <div id="perfect-info-buttons" style="display:flex; gap:5px; flex-wrap:wrap;">
                <button class="btn-red btn-small" onclick="renderAdminPosts('text', 'free')" id="btn-pi-txt">·â¥·ä≠·àµ·âµ (Text)</button>
                <button class="btn-red btn-small" onclick="renderAdminPosts('image', 'free')" id="btn-pi-img">·àù·àµ·àç (Image)</button>
                <button class="btn-red btn-small" onclick="renderAdminPosts('video', 'free')" id="btn-pi-vid">·â¢·ã≤·ãÆ (Video)</button>
                <button class="btn-red btn-small" onclick="renderAdminPosts('audio', 'free')" id="btn-pi-aud">·ãµ·àù·çÖ (Audio)</button>
                <button class="btn-green btn-small" id="btn-admin-live-watch" onclick="joinAdminLive()">·ä†·ãµ·àö·äï ·àã·ã≠·â≠ ·â∞·ä®·â≥·â∞·àç</button>
            </div>
            <div id="perfect-feed-container" style="margin-top:10px;"></div>
            <button class="btn-red btn-small" onclick="resetPerfectInfoView()">Back</button>
        </div>

        <!-- xFWA Premium Feed Section (Paid - Black Button) -->
        <div id="view-xfwa-info" class="section">
            <h3 style="color:gold;">Premium Content (<span id="prem-content-title">Paid</span>)</h3>
            <!-- Updated Task 2: Show Buttons for Paid Content - Task 10: Sub-buttons added -->
             <div id="xfwa-info-buttons" style="display:flex; gap:5px; flex-wrap:wrap;">
                <button class="btn-red btn-small" onclick="renderAdminPosts('text', 'paid', currentPremSubtype)">·â¥·ä≠·àµ·âµ (Text)</button>
                <button class="btn-red btn-small" onclick="renderAdminPosts('image', 'paid', currentPremSubtype)">·àù·àµ·àç (Image)</button>
                <button class="btn-red btn-small" onclick="renderAdminPosts('video', 'paid', currentPremSubtype)">·â¢·ã≤·ãÆ (Video)</button>
                <button class="btn-red btn-small" onclick="renderAdminPosts('audio', 'paid', currentPremSubtype)">·ãµ·àù·çÖ (Audio)</button>
                <button class="btn-green btn-small" onclick="joinAdminLive()">·ä†·ãµ·àö·äï ·àã·ã≠·â≠ ·â∞·ä®·â≥·â∞·àç</button>
            </div>
            <div id="xfwa-feed-container" style="margin-top:10px;"></div>
            <button class="btn-red btn-small" onclick="goBack()">Back</button>
        </div>

        <!-- Admin Report Inbox + Admin Post Button -->
        <div id="report-inbox" class="section">
            <h3>·à™·çñ·à≠·âµ ·àò·âÄ·â†·ã´ (Admin)</h3>
            <div style="margin-bottom:10px; display:flex; flex-direction:column; gap:5px;">
                <button class="btn-blue btn-small" onclick="promptAdminAction('changePass')">1. Change Admin Pass</button>
                <button class="btn-blue btn-small" onclick="promptAdminAction('userStats')">2. User Activity Monitor</button>
                <button class="btn-green btn-small" onclick="promptAdminAction('premPay')">3. Premium Payment Receiver</button>
                <button class="btn-blue btn-small" onclick="promptAdminAction('ctrlWithdraw')">4. Control Withdraw</button>
                <button class="btn-red btn-small" onclick="promptAdminAction('viewRep')">5. Receive Reports (Ban/Unban)</button>
                <button class="btn-blue btn-small" style="background-color:#6f42c1;" onclick="promptAdminAction('ctrlBiz')">6. Control Business (·ä≠·çà·âµ/·ãù·åã)</button>
                <!-- Task 3: PremiPost Button -->
                <button class="btn-green btn-small" style="background-color:#17a2b8;" onclick="document.getElementById('adm-premi-post-modal').style.display='flex'">PremiPost (Premium Content)</button>
                <!-- Task 2.6: Admin Post Button (For Free/Perfect Info) -->
                <button class="btn-green btn-small" style="background-color:#17a2b8;" onclick="openAdminPostMenu()">7. ·ä†·ãµ·àö·äï ·çñ·àµ·âµ (Admin Post)</button>
                <button class="btn-blue btn-small" style="background-color:#fd7e14;" onclick="promptAdminAction('ctrlPdf')">8. Control PDF & Points (·ä≠·çà·âµ/·ãù·åã)</button>
                <button class="btn-blue btn-small" style="background-color:purple;" onclick="openVerificationPanel()">9. User Verification</button>
            </div>
            <!-- Container for dynamic admin content -->
            <div id="admin-dynamic-content" style="text-align:left; margin-top:10px;"></div>
            <button class="btn-red btn-small" onclick="goBack()">Back</button>
        </div>

        <!-- Business -->
        <div id="business-sec" class="section">
            <h3 id="t-bh" data-lang-key="t-bh">·â¢·ãù·äê·àµ ·àõ·ãï·ä®·àç</h3>
            
            <!-- Task 5: Business Notification Area -->
            <div id="business-notif-area" style="display:none;" class="business-notif"></div>

            <div class="business-balance-grid">
                <div class="balance-item">
                    <div class="balance-label">USD</div>
                    <div class="balance-value usd-bal" id="bal-usd">0.00</div>
                </div>
                <div class="balance-item">
                    <div class="balance-label">GBP</div>
                    <div class="balance-value gbp-bal" id="bal-gbp">0.00</div>
                </div>
                <div class="balance-item">
                    <div class="balance-label">EUR</div>
                    <div class="balance-value eur-bal" id="bal-eur">0.00</div>
                </div>
                <div class="balance-item">
                    <div class="balance-label">ETB</div>
                    <div class="balance-value etb-bal" id="bal-etb">0.00</div>
                </div>
                <div class="balance-item">
                    <div class="balance-label">FWA</div>
                    <div class="balance-value fwa-bal" id="bal-fwa">0.00</div>
                </div>
            </div>
            <div style="background:#f9f9f9; padding:10px; border:1px solid #ddd; margin-top:10px; border-radius:5px;">
                <p style="color:green; font-weight:bold;">Total (USD): <span id="bal-total">0.00</span></p>
                <p style="color:red; font-weight:bold;">Total (ETB): <span id="bal-total-etb">0.00</span></p>
                <p style="color:#9c27b0; font-weight:bold;">Total (FWA): <span id="bal-total-fwa">0.00</span></p>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px;">
                <button class="btn-green" onclick="navTo('deposit-sec')" id="btn-bd" data-lang-key="btn-bd">Deposit</button>
                <button class="btn-blue" onclick="document.getElementById('exchange-modal').style.display='flex'" id="btn-b-exch" data-lang-key="btn-b-exch">Exchange & View Exchange</button>
                <button class="btn-blue" onclick="navTo('withdraw-sec')" id="btn-bw" data-lang-key="btn-bw">Withdraw</button>
                <button class="btn-yellow" onclick="navTo('intl-sec')" id="btn-bi" data-lang-key="btn-bi">International Purchase</button>
            </div>
            <button class="btn-blue" onclick="openFWAViewer()" id="btn-view-fwa" style="margin-top: 10px; background: #9c27b0;">View FWA Notes Images and Designs</button>
            <button class="btn-red btn-small" onclick="goBack()" id="btn-bk3" style="margin-top: 10px;">Back</button>
        </div>

        <!-- Deposit -->
        <div id="deposit-sec" class="section">
            <h3 id="t-dep-h" data-lang-key="t-dep-h">Deposit</h3>
            <div id="dep-step-1">
                <input type="number" id="dep-amt" placeholder="Amount">
                <select id="dep-cur">
                    <option value="ETB">ETB</option>
                    <option value="USD">USD</option>
                    <option value="GBP">GBP</option>
                    <option value="EUR">EUR</option>
                    <option value="FWA">FWA</option>
                </select>
                <button class="btn-green" onclick="preDeposit()">Submit</button>
            </div>
            <div id="dep-step-2" class="hidden">
                <button class="btn-blue" onclick="promptUpload('deposit')">Upload Receipt</button>
                <input type="file" id="file-deposit" class="hidden-input">
            </div>
            <button class="btn-red btn-small" onclick="goBack()" id="btn-bk4">Back</button>
        </div>

        <!-- Withdraw -->
        <div id="withdraw-sec" class="section">
            <h3 id="t-with-h" data-lang-key="t-with-h">Withdraw</h3>
            <select id="w-cur">
                <option value="USD">From USD</option>
                <option value="GBP">From GBP</option>
                <option value="EUR">From EUR</option>
                <option value="ETB">From ETB</option>
                <option value="FWA">From FWA</option>
            </select>
            <select id="w-method" onchange="toggleReceiverInput()">
                <option value="Telebirr">Telebirr</option>
                <option value="CBE">CBE</option>
                <option value="PayPal">PayPal</option>
                <option value="FWA">FWA Transfer</option>
            </select>
            <!-- Telebirr specific styling -->
            <input type="text" id="w-dest" placeholder="Phone/Account" style="display:none; margin-bottom: 2px; font-size: 13px;">
            <input type="number" id="w-amt" placeholder="Amount">
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px;">
                <button class="btn-compact btn-blue" onclick="reqWithdraw()" id="btn-sub-with">Withdraw</button>
                <button class="btn-compact btn-red" onclick="goBack()" id="btn-bk5">Back</button>
            </div>
        </div>

        <!-- Intl Purchase -->
        <div id="intl-sec" class="section">
            <h3 id="t-intl-h" data-lang-key="t-intl-h">International Purchase</h3>
            <button class="btn-blue" onclick="document.getElementById('intl-list').style.display='block'">·àù·à®·å• (Select)</button>
            <div id="intl-list" class="hidden" style="margin-top:10px;">
                <p>Select Service to Pay:</p>
                <div style="display:flex; flex-direction:column; gap:5px;">
                    <button class="btn-blue btn-small" onclick="triggerIntlPay('ChatGPT', 20)">1. ChatGPT ($20)</button>
                    <button class="btn-blue btn-small" onclick="triggerIntlPay('Amazon', 0)">2. Amazon</button>
                    <button class="btn-blue btn-small" onclick="triggerIntlPay('Hosting', 10)">3. Hosting ($10)</button>
                    <button class="btn-blue btn-small" onclick="triggerIntlPay('Domain', 12)">4. Domain ($12)</button>
                    <button class="btn-blue btn-small" onclick="triggerIntlPay('Netflix', 15)">5. Netflix ($15)</button>
                </div>
                <input type="file" id="file-intl" class="hidden-input">
            </div>
            <button class="btn-red btn-small" onclick="goBack()" id="btn-bk6">Back</button>
        </div>

        <!-- Premium Pay (General) -->
        <div id="prem-pricing" class="section">
            <!-- Task 3: Remove Header Text and place Control Box -->
            <div id="prem-control-box"></div>
            
            <p><span id="prem-service-name" style="display:none;">Service</span></p>
            
            <!-- Task 10: Horizontal Payment Buttons -->
            <div class="payment-options-row">
                <button class="btn-green" onclick="selectDuration('daily')" id="btn-pay-daily">Daily (<span id="rate-d"></span>)</button>
                <button class="btn-green" onclick="selectDuration('weekly')" id="btn-pay-weekly">Weekly (<span id="rate-w"></span>)</button>
                <button class="btn-green" onclick="selectDuration('monthly')" id="btn-pay-monthly">Monthly (<span id="rate-m"></span>)</button>
                <button class="btn-green" onclick="selectDuration('yearly')" id="btn-pay-yearly">Yearly</button>
            </div>
            
            <div id="pay-up-area" style="display:none;">
                <button class="btn-blue" onclick="promptUpload('pay')">Upload Receipt</button>
                <input type="file" id="file-pay" class="hidden-input">
                <button class="btn-green" onclick="submitLocalPayment()">Confirm Submission</button>
            </div>
            <button class="btn-red btn-small" onclick="goBack()" id="btn-bk7">Back</button>
        </div>

        <!-- Feedback -->
        <div id="feedback-sec" class="section">
            <h3 id="t-fh" data-lang-key="t-fh">Feedback</h3>
            <p id="t-fb-sub" data-lang-key="t-fb-sub">·àà·çã·à≤·àç ·ãå·â• ·ä†·çï ·çà·å£·à™ ·ä†·àµ·â∞·ã´·ã®·âµ ·àà·àò·àµ·å†·âµ</p>
            <button class="btn-blue" onclick="giveFb('text')" id="btn-fb-txt">Text</button>
            <button class="btn-yellow" onclick="openRealLiveStream()" id="btn-fb-live">
                <span class="live-indicator" id="fb-live-indicator"></span> Real Live
            </button>
            <hr>
            <button class="btn-blue" onclick="viewFbs()" id="btn-view-fb">View Feedbacks</button>
            <div id="fb-list"></div>
            <button class="btn-red btn-small" onclick="goBack()" id="btn-bk8">Back</button>
        </div>

        <!-- Chat / Group -->
        <div id="chat-sec" class="section">
            <h3 id="t-chat-h" data-lang-key="t-chat-h">Chat</h3>
            <div id="chat-box" style="height:200px; overflow-y:auto; border:1px solid #ddd; margin-bottom:5px;"></div>
            <div style="display:flex; gap:5px;">
                 <input type="text" id="chat-in" placeholder="Type..." style="width:50%;">
                 <button class="btn-blue btn-tiny" onclick="sendChat('text')" style="width:20%;">Send</button>
                 <button class="btn-yellow btn-tiny" onclick="document.getElementById('chat-file').click()" style="width:30%;">File</button>
                 <input type="file" id="chat-file" class="hidden-input" onchange="sendChat('file')">
            </div>
            <button class="btn-red btn-small" onclick="goBack()" id="btn-bk9">Back</button>
        </div>

        <!-- Received Shares View -->
        <div id="received-shares-sec" class="section">
            <h3>Shared With You</h3>
            <div id="shared-list-area"></div>
            <button class="btn-red btn-small" onclick="goBack()">Back</button>
        </div>

        <!-- User List (Read Only for Users button, Active for Chat) -->
        <div id="user-list-sec" class="section">
            <h3 id="t-users-h" data-lang-key="t-users-h">Users</h3>
            
            <!-- Task 1: These buttons should only show if accessed via Chat -->
            <div id="chat-action-buttons" style="display:none; gap:5px; margin-bottom:10px;">
                <button class="btn-green btn-small" onclick="filterMessages()" style="flex:1;">·àò·àç·ä•·ä≠·âµ ·â∞·âÄ·â†·àç (Receive Msg)</button>
                <!-- Task 4/2: SEND button triggers compose -->
                <button class="btn-blue btn-small" onclick="initiateSendMsg()" style="flex:1;">Send (·à¥·äï·ãµ)</button>
            </div>
            
            <p id="user-select-hint" style="color:red; display:none;">Select a User to Send To:</p>
            <div id="ul-cont"></div>
            <button class="btn-green" id="btn-grp-done" style="display:none;" onclick="createGroup()">Done (5+)</button>
            <button class="btn-green" id="btn-share-done" style="display:none;" onclick="executeShare()">OK (Share)</button>
            <button class="btn-red btn-small" onclick="goBack()" id="btn-bk10">Back</button>
        </div>

        <!-- Live Users List -->
        <div id="view-live-list" class="section">
            <h3>Live Users</h3>
            <div id="live-list-cont"></div>
            <button class="btn-red btn-small" onclick="goBack()">Back</button>
        </div>

        <!-- My Groups -->
        <div id="my-groups-sec" class="section">
            <h3 id="t-mygrp-h" data-lang-key="t-mygrp-h">Groups</h3>
            <div id="grp-list"></div>
            <button class="btn-red btn-small" onclick="goBack()" id="btn-bk11">Back</button>
        </div>

        <!-- Live View (Real Camera) - UPDATED -->
        <div id="view-live" class="section">
            <div class="live-stream-container">
                <div class="live-overlay-top">
                    <span class="live-badge">LIVE</span>
                    <span class="live-viewers-badge" id="live-viewers-count">üëÅÔ∏è 0</span>
                </div>
                <div class="floating-hearts">
                    <div class="heart-icon" style="left:10%; animation-delay:0s;">‚ù§Ô∏è</div>
                    <div class="heart-icon" style="left:30%; animation-delay:0.5s;">üî•</div>
                    <div class="heart-icon" style="left:70%; animation-delay:1.2s;">‚ù§Ô∏è</div>
                    <div class="heart-icon" style="left:50%; animation-delay:2s;">üëç</div>
                </div>
                <video id="live-video-element" autoplay playsinline style="width:100%; height:100%; object-fit:cover;"></video>
                <div class="live-overlay-bottom">
                    <div id="live-chat-box" style="height:100px; overflow-y:auto; color:white; text-shadow:1px 1px 2px black; font-size:12px; margin-bottom:5px;"></div>
                    <div style="display:flex; gap:5px;">
                        <input type="text" id="live-chat-input" placeholder="Say something..." style="background:rgba(255,255,255,0.5); border:none; color:white;">
                        <button class="btn-blue btn-tiny" onclick="sendLiveChat()">Send</button>
                    </div>
                </div>
            </div>
            
            <div class="live-controls">
                <button class="btn-green" onclick="startRealLiveStream()">Start Live</button>
                <button class="btn-red" onclick="stopRealLiveStream()">Stop Live</button>
                <button class="btn-yellow" onclick="toggleLiveAudio()" id="live-audio-btn">üîá Mute</button>
            </div>
            <!-- Task 6: Live Users List Button -->
            <button class="btn-blue" style="margin-top: 10px;" onclick="handleLiveList()">·àã·ã≠·â≠ ·àã·ã≠ ·ã´·àâ ·à∞·ãà·âΩ</button>
            <button class="btn-red" onclick="stopRealLiveStream(); goBack();" style="margin-top: 15px;">Exit</button>
        </div>

        <!-- Profile -->
        <div id="view-profile" class="section">
            <h2 id="t-prof" data-lang-key="t-prof">·ã®·åç·àç ·àõ·ãï·ä®·àç</h2>
            <div style="text-align:left;">
                <p>Phone: <b id="prof-phone"></b></p>
                <h4 id="t-edit-prof">Edit Profile</h4>
                <input type="text" id="prof-name-edit" placeholder="Name">
                <input type="password" id="old-pass" placeholder="Old Password">
                <div class="password-wrapper">
                    <input type="password" id="new-pass" placeholder="New Password">
                    <button class="toggle-password" type="button" onclick="togglePasswordVisibility('new-pass', this)">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
                <div class="password-wrapper">
                    <input type="password" id="conf-pass" placeholder="Confirm Password">
                    <button class="toggle-password" type="button" onclick="togglePasswordVisibility('conf-pass', this)">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
                <button class="btn-blue" onclick="promptUpload('profile-edit')" id="btn-chg-pic">Change Photo</button>
                <input type="file" id="file-profile-edit" class="hidden-input" accept="image/*">
                <button class="btn-green" onclick="saveProfile()" id="btn-up-prof">Update</button>
            </div>
            
            <div style="display: flex; gap: 10px; margin-top: 10px;">
                 <button class="btn-red" onclick="goBack()" id="btn-prof-out">Back</button>
                 <button class="btn-red" style="background-color: black;" onclick="deleteAccount()">Delete Account</button>
            </div>
        </div>

    </div>

    <!-- Hidden Input for Comments -->
    <input type="file" id="comment-file-input" class="hidden-input">
    <input type="file" id="universal-file" class="hidden-input">

    <!-- Footer Wrapper with Marquee Below -->
    <div class="footer-wrapper">
        <div class="bottom-nav">
            <button class="nav-btn nav-home" onclick="navTab('home')"><i class="fas fa-home"></i> <span id="nav-h" data-lang-key="nav-h">Home</span></button>
            <button class="nav-btn nav-live" onclick="navTab('live')">
                <i class="fas fa-broadcast-tower"></i> 
                <!-- Task 3: Live text change -->
                <span id="live-btn-txt" style="font-weight:bold;">LiVe0</span> 
            </button>
            <button class="nav-btn nav-profile" onclick="navTab('profile')">
                <i class="fas fa-user"></i> <span id="nav-p" data-lang-key="nav-p">Profile</span>
            </button>
        </div>
        <div class="bottom-marquee">
            <span>·çã·à≤·àç ·ãå·â• ·ä†·çï - Fasil Web App (Service Center) | üî• Firebase Online | <span id="live-status-text">üî¥ Offline</span></span>
        </div>
    </div>

    <!-- FIREBASE SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs, query, orderBy, onSnapshot, doc, updateDoc, increment, runTransaction, getDoc, setDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // Your Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAWS8PJ0kmu56hixesxV1KrMH8NRciH6U0",
            authDomain: "fasil-web-app-3a732.firebaseapp.com",
            projectId: "fasil-web-app-3a732",
            storageBucket: "fasil-web-app-3a732.appspot.com",
            messagingSenderId: "239133072986",
            appId: "1:239133072986:web:0dcbd768e1e916b9b64263"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        
        console.log("üî• Firebase Initialized Successfully!");
        
        // Global Firebase tools
        window.firebaseTools = {
            db: db,
            
            // Save post to Firebase
            savePost: async function(postData) {
                try {
                    const docRef = await addDoc(collection(db, "posts"), {
                        ...postData,
                        timestamp: new Date()
                    });
                    console.log("‚úÖ Post saved to Firebase:", docRef.id);
                    return { success: true, id: docRef.id };
                } catch (error) {
                    console.error("‚ùå Error saving post:", error);
                    return { success: false, error: error };
                }
            },
            
            // Get posts from Firebase
            getPosts: async function() {
                try {
                    const q = query(collection(db, "posts"), orderBy("timestamp", "desc"));
                    const querySnapshot = await getDocs(q);
                    const posts = [];
                    querySnapshot.forEach((doc) => {
                        posts.push({ id: doc.id, ...doc.data() });
                    });
                    console.log("‚úÖ Posts loaded from Firebase:", posts.length);
                    return posts;
                } catch (error) {
                    console.error("‚ùå Error getting posts:", error);
                    return [];
                }
            },
            
            // Update Post (Likes/Follows)
            updatePostStats: async function(postId, stats) {
                try {
                    const postRef = doc(db, "posts", postId);
                    await updateDoc(postRef, stats);
                    return { success: true };
                } catch (error) {
                    console.error("‚ùå Error updating stats:", error);
                    return { success: false };
                }
            },
            
            // Save user to Firebase
            saveUser: async function(userData) {
                try {
                    const docRef = await addDoc(collection(db, "users"), {
                        ...userData,
                        createdAt: new Date()
                    });
                    console.log("‚úÖ User saved to Firebase:", userData.phone);
                    return { success: true, id: docRef.id };
                } catch (error) {
                    console.error("‚ùå Error saving user:", error);
                    return { success: false, error: error };
                }
            },
            
            // Get users from Firebase
            getUsers: async function() {
                try {
                    const querySnapshot = await getDocs(collection(db, "users"));
                    const users = [];
                    querySnapshot.forEach((doc) => {
                        users.push({id: doc.id, ...doc.data()});
                    });
                    console.log("‚úÖ Users loaded from Firebase:", users.length);
                    return users;
                } catch (error) {
                    console.error("‚ùå Error getting users:", error);
                    return [];
                }
            },
            
            // Update user balance in Firebase (Task 5 Persistence)
            updateUserBalance: async function(userId, currency, amount) {
                try {
                    // Check if userId is valid Firestore ID, otherwise find by phone
                    let userRef;
                    if(userId && userId.length > 5) {
                        userRef = doc(db, "users", userId);
                    } else {
                        // Fallback logic handled in app logic usually
                        return { success: false };
                    }
                    
                    await updateDoc(userRef, {
                        [`bal${currency}`]: increment(amount)
                    });
                    console.log(`‚úÖ ${currency} balance updated for user ${userId}`);
                    return { success: true };
                } catch (error) {
                    console.error("‚ùå Error updating balance:", error);
                    return { success: false, error: error };
                }
            },
            
            // Task 12: Generate Auto ID Transaction
            generateFWAID: async function() {
                const counterRef = doc(db, "settings", "userCounter");
                try {
                    const newId = await runTransaction(db, async (transaction) => {
                        const counterDoc = await transaction.get(counterRef);
                        let nextCount = 1;
                        if (counterDoc.exists()) {
                            nextCount = counterDoc.data().count + 1;
                        } else {
                             // Initialize if missing
                             transaction.set(counterRef, { count: 0 });
                        }
                        
                        transaction.set(counterRef, { count: nextCount }, { merge: true });
                        const idStr = "FWA" + String(nextCount).padStart(5, '0');
                        return idStr;
                    });
                    return newId;
                } catch (e) {
                    console.error("ID Gen Error: ", e);
                    // Fallback locally if offline
                    return "FWA" + String(Math.floor(Math.random()*10000)).padStart(5,'0');
                }
            },

            // Task 6: Ban User Update
            banUser: async function(phone, status) {
                // Find doc by phone
                const q = query(collection(db, "users")); 
                const snap = await getDocs(q);
                let uid = null;
                snap.forEach(d => { if(d.data().phone === phone) uid = d.id; });
                
                if(uid) {
                    await updateDoc(doc(db, "users", uid), { isBanned: status });
                    return true;
                }
                return false;
            },

            // Task 6: Delete User
            deleteUser: async function(phone) {
                 const q = query(collection(db, "users")); 
                 const snap = await getDocs(q);
                 let uid = null;
                 snap.forEach(d => { if(d.data().phone === phone) uid = d.id; });
                 
                 if(uid) {
                     await deleteDoc(doc(db, "users", uid));
                     return true;
                 }
                 return false;
            },
            
            // Real-time posts listener
            setupRealtimePosts: function(callback) {
                const q = query(collection(db, "posts"), orderBy("timestamp", "desc"));
                return onSnapshot(q, (snapshot) => {
                    const posts = [];
                    snapshot.forEach((doc) => {
                        posts.push({ id: doc.id, ...doc.data() });
                    });
                    callback(posts);
                });
            },
            
            // Real-time live stream status
            setupLiveStreamStatus: function(callback) {
                const q = query(collection(db, "liveStream"), orderBy("timestamp", "desc"));
                return onSnapshot(q, (snapshot) => {
                    const liveStreams = [];
                    snapshot.forEach((doc) => {
                        liveStreams.push({ id: doc.id, ...doc.data() });
                    });
                    callback(liveStreams);
                });
            },
            
            // Save live stream status
            saveLiveStreamStatus: async function(streamData) {
                try {
                    const docRef = await addDoc(collection(db, "liveStream"), {
                        ...streamData,
                        timestamp: new Date()
                    });
                    return { success: true, id: docRef.id };
                } catch (error) {
                    console.error("‚ùå Error saving live stream:", error);
                    return { success: false, error: error };
                }
            },
            
            // Test connection
            testConnection: async function() {
                try {
                    // await addDoc(collection(db, "test"), { test: true, time: new Date() });
                    return true;
                } catch (error) {
                    return false;
                }
            }
        };
        
        // Test and show PERMANENT status
        window.firebaseTools.testConnection().then(success => {
            const statusEl = document.getElementById('firebase-status');
            if(success) {
                statusEl.textContent = 'üî• Online';
                statusEl.className = 'firebase-status firebase-online';
                statusEl.style.display = 'block'; // Always visible
            } else {
                statusEl.textContent = 'üî¥ Offline';
                statusEl.className = 'firebase-status firebase-offline';
                statusEl.style.display = 'block'; // Always visible
            }
        });
    </script>

    <script>
        // --- DATA ---
        let user = JSON.parse(localStorage.getItem('fg_user')) || null;
        let users = JSON.parse(localStorage.getItem('fg_users')) || [];
        let posts = JSON.parse(localStorage.getItem('fg_posts')) || [];
        // Add Persistent Delete Logic
        let deletedPostIds = JSON.parse(localStorage.getItem('fg_deleted_posts')) || [];
        let sharedItems = JSON.parse(localStorage.getItem('fg_shared')) || [];
        let reports = JSON.parse(localStorage.getItem('fg_reports')) || [];
        let paymentRequests = JSON.parse(localStorage.getItem('fg_pay_requests')) || [];
        let withdrawRequests = JSON.parse(localStorage.getItem('fg_withdraw_requests')) || [];
        
        // Admin Posts (Task 2.6)
        let adminPosts = JSON.parse(localStorage.getItem('fg_admin_posts')) || [];
        // Admin Live Status
        let adminLiveStatus = JSON.parse(localStorage.getItem('fg_admin_live')) || false;
        
        // Task 4: Expanded Group Data
        let groups = JSON.parse(localStorage.getItem('fg_groups')) || [];
        
        let chats = JSON.parse(localStorage.getItem('fg_chats')) || {};
        let feedbacks = JSON.parse(localStorage.getItem('fg_fbs')) || [];
        let adminPass = localStorage.getItem('fg_admin_pass') || 'abc123456abc';
        let bizStatus = localStorage.getItem('fg_biz_status') || 'open'; // open or closed
        let pdfStatus = localStorage.getItem('fg_pdf_status') || 'open'; // open or closed
        
        // Task 6: Global Lock and Notifications
        let globalLock = localStorage.getItem('fg_global_lock') || 'unlock';
        let dashboardNotif = localStorage.getItem('fg_dash_notif') || '';
        let businessNotif = localStorage.getItem('fg_biz_notif') || '';
        let rewardNotif = localStorage.getItem('fg_rew_notif') || '';
        let controlBoxText = localStorage.getItem('fg_ctrl_box_text') || '';
        let controlBoxVisible = localStorage.getItem('fg_ctrl_box_vis') || 'hide';
        let sizeLimits = JSON.parse(localStorage.getItem('fg_size_limits')) || {};
        let premiumReleaseStatus = localStorage.getItem('fg_prem_release') || 'hold'; // 'release' means free access, 'hold' means pay
        
        // Task 13: Automatic Balance Control
        let automaticBalanceStatus = localStorage.getItem('fg_auto_bal') || 'open';

        // Auto Reward Settings
        let rewardSettings = JSON.parse(localStorage.getItem('fg_rew_settings')) || {
            follow: { count: 100, amount: 1, currency: 'ETB' },
            like: { count: 100, amount: 1, currency: 'ETB' }
        };

        // Visibility Toggles
        let vpnVisible = localStorage.getItem('fg_vpn_visible') === 'true'; // default false
        let bizVisible = localStorage.getItem('fg_biz_visible') !== 'false'; // default true

        // Rates stored in localStorage so Admin can change them
        let RATES = JSON.parse(localStorage.getItem('fg_rates')) || { USD: 1, ETB: 120, GBP: 0.9, EUR: 0.95, FWA: 50 };
        // Task 14: Control Points Rates
        let pointRates = JSON.parse(localStorage.getItem('fg_point_rates')) || { share: 0.5, video: 0.8, audio: 0.6, text: 0.1, share_target: 5 };
        // Task 16: Premium Rates
        let premRates = JSON.parse(localStorage.getItem('fg_prem_rates')) || { daily: 5, weekly: 25, monthly: 30 };
        
        let lang = 'am';
        let hasAgreed = false;
        let viewHistory = [];
        let activePostType = 'text';
        let activeChat = null;
        let activeCommentPostId = null;
        let pendingAct = null;
        let uploadTarget = '';
        let liveStream = null;
        let comMode = 'view'; 
        let pendingAdminAction = null;
        let lastReceiptUrl = '';
        let firebaseUnsubscribe = null;
        let pendingDeposit = null;
        let pendingIntlCost = 0;
        let liveStreamActive = false;
        let liveViewers = 0;
        let liveViewersInterval = null;
        let liveChatMessages = [];
        let liveAudioMuted = false;
        let targetLiveUser = null;
        let pendingReportId = null;
        let pendingChatSendType = 'text';
        let activeChatUser = null;
        let watchTimer = null;
        let activePremService = 'ppt'; // Default
        let currentPremSubtype = null; // Store which sub-feed is active
        
        // Task 10: New Payment Flow Variables
        let pendingPayDuration = null; 
        
        // Task 2: Compose Target
        let composeTarget = null;
        
        // Real Conversion Vars
        let pendingConvMode = 'text'; // 'text' or 'file'

        // Task 14: Hybrid Verification
        let pendingRegData = null;

        // --- SPLASH SCREEN (3 seconds) ---
        window.onload = function() {
            setTimeout(function() {
                document.getElementById('splash-screen').style.display = 'none';
            }, 3000);
            
            // Check Referral on Load (Simplified)
            // checkReferral();
            
            // Initialize FWA balance if not exists
            if(user && user.balFWA === undefined) {
                user.balFWA = 0;
                localStorage.setItem('fg_user', JSON.stringify(user));
            }
            if(user && !user.paidServices) {
                user.paidServices = {}; // Track specific services like 'ppt', 'pdf'
                localStorage.setItem('fg_user', JSON.stringify(user));
            }
            
            // Initialize Dashboard Likes/Follows if not exists
            if(user && user.dashLikes === undefined) { user.dashLikes = 0; }
            if(user && user.dashFollows === undefined) { user.dashFollows = 0; }
            
            // Update live indicators
            updateLiveIndicators();
            updateAdminLiveIndicator();
            // Initial Balance Check
            upBal();
            
            // Render Notifications
            renderNotifications();
            applyControlBox();
            updateDashStats();
            
            // Task 12: Header ID
            if(user && user.fwaId) {
                document.getElementById('header-fwa-id').innerText = user.fwaId;
            }
            
            // Update Auto Status
            document.getElementById('auto-status-text').innerText = automaticBalanceStatus === 'open' ? 'Open' : 'Blocked';
        };

        // --- FIREBASE INTEGRATION FUNCTIONS ---
        async function loadFirebaseData() {
            if(!window.firebaseTools) {
                console.log("Firebase not loaded yet");
                return;
            }
            
            try {
                // Load posts from Firebase
                const firebasePosts = await window.firebaseTools.getPosts();
                if(firebasePosts.length > 0) {
                    // Filter out locally deleted posts
                    posts = firebasePosts.filter(p => !deletedPostIds.includes(p.id));
                    console.log("Loaded", posts.length, "posts from Firebase");
                    
                    // Update local storage as backup
                    localStorage.setItem('fg_posts', JSON.stringify(posts));
                }
                
                // Load users from Firebase
                const firebaseUsers = await window.firebaseTools.getUsers();
                if(firebaseUsers.length > 0) {
                    users = firebaseUsers;
                    console.log("Loaded", users.length, "users from Firebase");
                    
                    // Update local storage as backup
                    localStorage.setItem('fg_users', JSON.stringify(users));
                }
                
                // Sync Current User
                if(user) {
                    const freshUser = users.find(u => u.phone === user.phone);
                    if(freshUser) {
                        // Check Ban Status on Load
                        if(freshUser.isBanned) {
                            alert("You have been banned by the Admin.");
                            doLogout();
                            return;
                        }
                        user = freshUser;
                        localStorage.setItem('fg_user', JSON.stringify(user));
                        upBal();
                        if(user.fwaId) document.getElementById('header-fwa-id').innerText = user.fwaId;
                    }
                }

                // Setup real-time updates
                if(window.firebaseTools.setupRealtimePosts) {
                    firebaseUnsubscribe = window.firebaseTools.setupRealtimePosts((updatedPosts) => {
                        // Apply persistent delete filter
                        posts = updatedPosts.filter(p => !deletedPostIds.includes(p.id));
                        // Refresh posts view if active
                        if(document.getElementById('view-info').classList.contains('show')) {
                            renderPosts(activePostType);
                        }
                    });
                }
                
                // Setup live stream status updates
                if(window.firebaseTools.setupLiveStreamStatus) {
                    window.firebaseTools.setupLiveStreamStatus((liveStreams) => {
                        // Filter active streams
                        const activeStreams = liveStreams.filter(s => s.isActive);
                        if(activeStreams.length > 0) {
                            liveViewers = activeStreams.length; // Count broadcasters only
                            updateLiveIndicators(true);
                        } else {
                            liveViewers = 0;
                            updateLiveIndicators(false);
                        }
                    });
                }
                
            } catch (error) {
                console.error("Error loading Firebase data:", error);
            }
        }
        
        // Call on page load
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                loadFirebaseData();
            }, 2000);
        });

        // --- NEW FUNCTIONS ---
        
        function showLoading(txt) {
            document.getElementById('loading-text').innerText = txt || "Processing...";
            document.getElementById('loading-overlay').style.display = 'flex';
        }
        
        function hideLoading() {
            document.getElementById('loading-overlay').style.display = 'none';
            document.getElementById('upload-progress-bar').style.width = '0%';
        }

        // 1. Password Show/Hide Toggle
        function togglePasswordVisibility(passwordFieldId, button) {
            const passwordField = document.getElementById(passwordFieldId);
            const icon = button.querySelector('i');
            
            if (passwordField.type === 'password') {
                passwordField.type = 'text';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                passwordField.type = 'password';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        }
        
        // 1.5 Toggle Policy
        function togglePolicy() {
            const el = document.getElementById('policy-content');
            if(el.style.display === 'none') {
                el.style.display = 'block';
            }
            else el.style.display = 'none';
        }

        // 2. FWA Notes Viewer - UPDATED
        function openFWAViewer() {
            document.getElementById('fwa-notes-modal').style.display = 'flex';
            document.getElementById('fwa-buttons-container').style.display = 'grid';
            document.getElementById('fwa-image-display').style.display = 'none';
            document.querySelector('.fwa-back-btn').style.display = 'none';
        }
        
        function showFWAImage(amount) {
            // Hide buttons
            document.getElementById('fwa-buttons-container').style.display = 'none';
            
            // Show image container
            const imageContainer = document.getElementById('fwa-image-display');
            imageContainer.style.display = 'block';
            
            // Show back button
            document.querySelector('.fwa-back-btn').style.display = 'block';
            
            // Placeholder for your images - replace with actual image paths
            const imageMap = {
                1: 'fwa_1_note.jpg',
                5: 'fwa_5_note.jpg',
                10: 'fwa_10_note.jpg',
                50: 'fwa_50_note.jpg',
                100: 'fwa_100_note.jpg',
                200: 'fwa_200_note.jpg',
                500: 'fwa_500_note.jpg',
                1000: 'fwa_1000_note.jpg'
            };
            
            const imgName = imageMap[amount] || `fwa_${amount}_note.jpg`;
            imageContainer.innerHTML = `
                <h4>${amount} FWA Note Design</h4>
                <img src="${imgName}" alt="${amount} FWA Note" class="fwa-note-image">
                <p style="font-size: 14px; color: #333; margin-top: 10px;">
                    Official ${amount} FWA Currency Note Design
                </p>
                <p style="font-size: 12px; color: #666; margin-top: 5px;">
                    Image: ${imgName} - Upload this image to your project folder
                </p>
            `;
        }
        
        function closeFWAViewer() {
            // Show buttons again
            document.getElementById('fwa-buttons-container').style.display = 'grid';
            
            // Hide image container
            document.getElementById('fwa-image-display').style.display = 'none';
            
            // Hide back button
            document.querySelector('.fwa-back-btn').style.display = 'none';
        }
        
        // 3. Updated Balance Display with FWA - UPDATED to actually update
        function upBal() {
            if (!user) return;
            
            // Ensure numbers
            if(!user.balUSD) user.balUSD = 0;
            if(!user.balETB) user.balETB = 0;
            if(!user.balFWA) user.balFWA = 0;
            if(!user.balGBP) user.balGBP = 0;
            if(!user.balEUR) user.balEUR = 0;
            
            // Update displayed balances
            const balUSD = document.getElementById('bal-usd'); if(balUSD) balUSD.innerText = (user.balUSD).toFixed(2);
            const balGBP = document.getElementById('bal-gbp'); if(balGBP) balGBP.innerText = (user.balGBP).toFixed(2);
            const balEUR = document.getElementById('bal-eur'); if(balEUR) balEUR.innerText = (user.balEUR).toFixed(2);
            const balETB = document.getElementById('bal-etb'); if(balETB) balETB.innerText = (user.balETB).toFixed(2);
            const balFWA = document.getElementById('bal-fwa'); if(balFWA) balFWA.innerText = (user.balFWA).toFixed(2);
            const rewFWA = document.getElementById('rew-bal-fwa'); if(rewFWA) rewFWA.innerText = (user.balFWA).toFixed(2);
            const rewUSD = document.getElementById('rew-bal-usd'); if(rewUSD) rewUSD.innerText = (user.balUSD).toFixed(2);
            const rewETB = document.getElementById('rew-bal-etb'); if(rewETB) rewETB.innerText = (user.balETB).toFixed(2);
            
            // Calculate totals using RATES
            const totUSD = (user.balUSD) + 
                          (user.balGBP / RATES.GBP) + 
                          (user.balEUR / RATES.EUR) + 
                          (user.balETB / RATES.ETB) + 
                          (user.balFWA / RATES.FWA);
            
            const totETB = totUSD * RATES.ETB;
            const totFWA = totUSD * RATES.FWA;
            
            const totEl = document.getElementById('bal-total'); if(totEl) totEl.innerText = totUSD.toFixed(2);
            const totETBEl = document.getElementById('bal-total-etb'); if(totETBEl) totETBEl.innerText = totETB.toFixed(2);
            const totFWAEl = document.getElementById('bal-total-fwa'); if(totFWAEl) totFWAEl.innerText = totFWA.toFixed(2);
            
            // Task 5: STRICT Persistence Logic - Update USER array and Firebase
            localStorage.setItem('fg_user', JSON.stringify(user));
            const uIdx = users.findIndex(u => u.phone === user.phone);
            if(uIdx > -1) {
                users[uIdx] = user;
                localStorage.setItem('fg_users', JSON.stringify(users));
                // Sync to Firebase if user has ID
                if(user.id && window.firebaseTools) {
                    // Just triggering an update to a field to keep it fresh, ideally update all balances
                    window.firebaseTools.updateUserBalance(user.id, "ETB", 0); // Dummy update to trigger write logic? No, update actuals
                    // Real implementation in updateBalance functions
                }
            }
        }
        
        // Exchange Functions
        function showRates() {
            const area = document.getElementById('rate-view-area');
            const conv = document.getElementById('convert-area');
            conv.style.display = 'none';
            area.style.display = 'block';
            area.innerHTML = `
                <h4>Current Exchange Rates (to 1 USD)</h4>
                <p>1 USD = ${RATES.FWA} FWA</p>
                <p>1 USD = ${RATES.ETB} ETB</p>
                <p>1 USD = ${RATES.GBP} GBP</p>
                <p>1 USD = ${RATES.EUR} EUR</p>
            `;
        }
        
        function showConvert() {
            document.getElementById('rate-view-area').style.display = 'none';
            document.getElementById('convert-area').style.display = 'block';
        }
        
        function doConvert() {
            const src = document.getElementById('conv-source').value;
            const amt = parseFloat(document.getElementById('conv-amount').value);
            
            if(!amt || amt <= 0) return alert("Please enter valid amount");
            
            // Check balance
            let bal = 0;
            if(src === 'ETB') bal = user.balETB;
            else if(src === 'FWA') bal = user.balFWA;
            else if(src === 'GBP') bal = user.balGBP;
            else if(src === 'EUR') bal = user.balEUR;
            
            if(bal < amt) return alert("Insufficient Balance");
            
            // Deduct
            if(src === 'ETB') user.balETB -= amt;
            else if(src === 'FWA') user.balFWA -= amt;
            else if(src === 'GBP') user.balGBP -= amt;
            else if(src === 'EUR') user.balEUR -= amt;
            
            // Convert to USD
            const rate = RATES[src];
            const usdVal = amt / rate;
            user.balUSD += usdVal;
            
            // Sync
            if(window.firebaseTools && user.id) {
                window.firebaseTools.updateUserBalance(user.id, src, -amt);
                window.firebaseTools.updateUserBalance(user.id, 'USD', usdVal);
            }
            
            upBal();
            alert(`Converted ${amt} ${src} to ${usdVal.toFixed(2)} USD successfully.`);
            document.getElementById('exchange-modal').style.display='none';
        }
        
        // Admin Rate Change
        function promptRate(curr) {
            const val = prompt(`Enter new rate for 1 USD = ? ${curr}`);
            if(val && !isNaN(val)) {
                RATES[curr] = parseFloat(val);
                localStorage.setItem('fg_rates', JSON.stringify(RATES));
                alert("Success!");
            }
        }
        
        // Admin Points Rate Change (Task 14/7)
        function promptPointRate(type) {
            if(type === 'share') {
                const count = prompt("Enter Number of People (e.g. 5):");
                const pts = prompt("Enter Reward FWA Points (e.g. 0.7):");
                if(count && pts) {
                    pointRates.share = parseFloat(pts);
                    pointRates.share_target = parseInt(count);
                    localStorage.setItem('fg_point_rates', JSON.stringify(pointRates));
                    alert("Share Rate Updated!");
                    document.getElementById('ref-target-display').innerText = count;
                    document.getElementById('ref-rew-amt').innerText = pts;
                }
            } else {
                const mins = prompt(`Enter Minutes for ${type} (e.g. 30):`);
                const pts = prompt(`Enter FWA Points for ${mins} mins:`);
                if(mins && pts) {
                    pointRates[type] = parseFloat(pts); 
                    localStorage.setItem('fg_point_rates', JSON.stringify(pointRates));
                    alert(`${type} Rate Updated!`);
                }
            }
        }
        
        // Admin Premium Rate Change (Task 16/8)
        function promptPremRate(service) {
             const type = prompt(`Enter Rate Type for ${service} (daily, weekly, monthly, yearly):`);
             if(!type) return;
             const val = prompt(`Enter Price (ETB) for ${service} - ${type}:`);
             if(val && !isNaN(val)) {
                 if(!premRates[service]) premRates[service] = {};
                 premRates[service][type] = parseFloat(val);
                 localStorage.setItem('fg_prem_rates', JSON.stringify(premRates));
                 alert(`${service} ${type} Price Updated!`);
             }
        }
        
        function updatePremBtnLabels() {
            // Updated dynamically in openPrem
        }
        
        function preDeposit() { 
            const a = parseFloat(document.getElementById('dep-amt').value); 
            const c = document.getElementById('dep-cur').value;
            
            if(!a || a <= 0) return showAlert("Please enter valid amount", "error");
            
            document.getElementById('dep-step-1').style.display = 'none'; 
            document.getElementById('dep-step-2').style.display = 'block'; 
            
            // Store deposit info for later
            pendingDeposit = { amount: a, currency: c };
        }
        
        // Updated deposit function (Task 5 Persistence)
        function finalizeDeposit() {
            if(!pendingDeposit) return;
            
            const a = pendingDeposit.amount;
            const c = pendingDeposit.currency;
            
            // Update user balance
            if(c === 'USD') user.balUSD = (user.balUSD || 0) + (a); 
            else if(c === 'GBP') user.balGBP = (user.balGBP || 0) + (a); 
            else if(c === 'EUR') user.balEUR = (user.balEUR || 0) + (a);
            else if(c === 'FWA') user.balFWA = (user.balFWA || 0) + a;
            else user.balETB = (user.balETB || 0) + a;
            
            // Update Firebase if available
            if(window.firebaseTools && window.firebaseTools.updateUserBalance && user.id) {
                window.firebaseTools.updateUserBalance(user.id, c.toUpperCase(), a);
            }
            
            // Task 3: Ensure Persistence
            upBal(); // This saves to localStorage
            showAlert(`Deposited ${a} ${c} successfully!`, "success"); 
            
            // Reset modal and update balance immediately
            document.getElementById('receipt-modal').style.display = 'none';
            document.getElementById('dep-step-1').style.display = 'block'; 
            document.getElementById('dep-step-2').style.display = 'none'; 
            
            navTo('business-sec');
        }
        
        function toggleReceiverInput() {
            const m = document.getElementById('w-method').value;
            const i = document.getElementById('w-dest');
            i.style.display = 'block';
            i.placeholder = m === 'PayPal' ? 'Email (@gmail)' : 
                          (m === 'CBE' ? '1000... (13 digit)' : 
                          (m === 'FWA' ? 'FWA Account Number' : 'Phone 09...'));
        }
        
        function reqWithdraw() {
            const m = document.getElementById('w-method').value; 
            const d = document.getElementById('w-dest').value;
            const a = parseFloat(document.getElementById('w-amt').value);
            const c = document.getElementById('w-cur').value;
            
            if(!a || a <= 0) return showAlert("Please enter amount", "error");
            
            // Check if user has sufficient balance
            let hasBalance = false;
            let currentBalance = 0;
            
            if(c === 'USD') currentBalance = user.balUSD || 0;
            else if(c === 'GBP') currentBalance = user.balGBP || 0;
            else if(c === 'EUR') currentBalance = user.balEUR || 0;
            else if(c === 'ETB') currentBalance = user.balETB || 0;
            else if(c === 'FWA') currentBalance = user.balFWA || 0;
            
            if(currentBalance < a) return showAlert(`·àÇ·à≥·â•·ãé ·ä†·äê·àµ·â∞·äõ ·äê·ãç (Insufficient Funds). You have ${currentBalance.toFixed(2)} ${c}`, "error");
            
            if(m === 'Telebirr' && !/^09\d{8}$/.test(d)) return showAlert("Telebirr must be 09... (10 digits)", "error");
            if(m === 'PayPal' && !d.endsWith('@gmail.com')) return showAlert("Email required", "error");
            if(m === 'CBE' && (!d.match(/^(1000|10000)\d{9}$/) || d.length !== 13)) return showAlert("Invalid CBE", "error");
            if(m === 'FWA' && !d) return showAlert("FWA Account required", "error");

            document.getElementById('pass-modal').style.display = 'flex';
            pendingAct = () => {
                // Deduct from balance
                if(c === 'USD') user.balUSD -= a;
                else if(c === 'GBP') user.balGBP -= a;
                else if(c === 'EUR') user.balEUR -= a;
                else if(c === 'ETB') user.balETB -= a;
                else if(c === 'FWA') user.balFWA -= a;
                
                // Update Firebase if available
                if(window.firebaseTools && window.firebaseTools.updateUserBalance && user.id) {
                    window.firebaseTools.updateUserBalance(user.id, c.toUpperCase(), -a);
                }
                
                upBal(); // Save and update UI (Task 3 Persistence)
                showAlert(`Successfully withdrew ${a} ${c} to ${m}`, "success"); 
                navTo('business-sec');
            };
        }
        
        function triggerIntlPay(item, cost) {
            if(user.balUSD < cost) {
                return showAlert("Insufficient Funds (USD Balance Low)", "error");
            }
            pendingIntlCost = cost;
            document.getElementById('pass-modal').style.display = 'flex';
            pendingAct = () => { promptUpload('intl'); }; // Upload receipt first
        }
        
        function deductIntlPay() {
            if(pendingIntlCost > 0) {
                user.balUSD -= pendingIntlCost;
                if(window.firebaseTools && user.id) window.firebaseTools.updateUserBalance(user.id, 'USD', -pendingIntlCost);
                upBal(); // Persistence
                pendingIntlCost = 0;
            }
        }

        function verifyPass() { 
            if(document.getElementById('pass-input').value === user.password) { 
                document.getElementById('pass-modal').style.display = 'none'; 
                document.getElementById('pass-input').value = '';
                if(pendingAct) pendingAct(); 
            } else {
                alert("Wrong Password");
            }
        }

        // --- PREMIUM & PAYMENT LOGIC (Task 10) ---
        function openPrem(service, defaultType) { 
            activePremService = service;
            // PDF Control Logic - Task 6 Global Lock check is done in button
            if(user.phone !== '0951337242' && pdfStatus === 'closed') {
                alert("·ãç·ãµ ·ã∞·äï·â†·äû·âª·âΩ·äï ·â†·åç·äï·â£·â≥ ·àã·ã≠ ·äê·ãç ·â†·âÖ·à≠·â• ·âÄ·äï ·ã≠·å†·â•·âÅ·äï·ç¢");
                return;
            }
            // Update labels based on service rates
            const sRates = premRates[service] || { daily: 5, weekly: 25, monthly: 30 };
            document.getElementById('rate-d').innerText = sRates.daily || 0;
            document.getElementById('rate-w').innerText = sRates.weekly || 0;
            document.getElementById('rate-m').innerText = sRates.monthly || 0;
            
            navTo('prem-pricing'); 
        }
        
        // Task 10: Step 1 - Select Duration
        function selectDuration(duration) {
            pendingPayDuration = duration;
            // Task 11: Check Limit Alert before payment
            if(sizeLimits[activePremService] && sizeLimits[activePremService][duration]) {
                const limit = sizeLimits[activePremService][duration];
                alert(`${duration.toUpperCase()} ${activePremService.toUpperCase()} limit is ${limit} characters. (·àò·å†·äï: ${limit} ·çä·ã∞·àç)`);
            }
            
            const sRates = premRates[activePremService] || { daily: 5, weekly: 25, monthly: 30 };
            const amount = sRates[duration] || 0;
            
            document.getElementById('pay-method-msg').innerText = `To Pay: ${amount} ETB for ${duration}`;
            document.getElementById('payment-method-modal').style.display = 'flex';
        }
        
        // Task 10: Step 2 - Process Payment Method
        function processPayment(method) {
            document.getElementById('payment-method-modal').style.display = 'none';
            const sRates = premRates[activePremService] || { daily: 5, weekly: 25, monthly: 30 };
            const amountETB = sRates[pendingPayDuration] || 0;
            
            if(method === 'FWA') {
                // Convert ETB amount to FWA points needed (using RATES)
                const amountFWA = amountETB / (RATES.ETB / RATES.FWA);
                
                if(confirm(`Pay ${amountFWA.toFixed(2)} FWA from your balance?`)) {
                    if(user.balFWA >= amountFWA) {
                        user.balFWA -= amountFWA;
                        if(window.firebaseTools && user.id) window.firebaseTools.updateUserBalance(user.id, 'FWA', -amountFWA);
                        upBal();
                        grantAccess(activePremService); // Success
                    } else {
                        alert("Insufficient FWA Points.");
                    }
                }
            } else if (method === 'ETB') {
                // Show Upload
                document.getElementById('pay-up-area').style.display = 'block';
            } else if (method === 'USDT') {
                document.getElementById('usdt-options-modal').style.display = 'flex';
            }
        }
        
        // Task 9: Setup USDT/PayPal options
        function setupUsdtType(type) {
            document.getElementById('usdt-card-input').placeholder = type + ' Address/Number';
            if(type === 'Card') document.getElementById('usdt-card-input').placeholder = "Card Number (16 digits)";
            alert("Selected: " + type);
        }
        
        function submitIntlPayment() {
             const card = document.getElementById('usdt-card-input').value;
             const txn = document.getElementById('usdt-trans-id').value;
             
             if(!card || !txn) return alert("Fill all fields");
             
             // Save Request
             paymentRequests.push({
                 id: Date.now(),
                 user: user.phone,
                 userName: user.name,
                 userPhoto: user.photo,
                 service: activePremService,
                 type: 'International',
                 details: `Card/Wallet: ${card}, TXN: ${txn}`,
                 status: 'pending',
                 date: new Date().toLocaleString()
             });
             localStorage.setItem('fg_pay_requests', JSON.stringify(paymentRequests));
             
             alert("Payment Submitted. Waiting for Admin Approval.");
             document.getElementById('usdt-options-modal').style.display = 'none';
             goBack();
        }
        
        function submitLocalPayment() {
             // Image already handled by 'pay' upload target
             paymentRequests.push({
                 id: Date.now(),
                 user: user.phone,
                 userName: user.name,
                 userPhoto: user.photo,
                 service: activePremService,
                 type: 'Local',
                 details: 'Receipt Uploaded',
                 status: 'pending',
                 date: new Date().toLocaleString()
             });
             localStorage.setItem('fg_pay_requests', JSON.stringify(paymentRequests));
             
             alert("Payment Submitted. Waiting for Admin Approval.");
             document.getElementById('pay-up-area').style.display = 'none';
             goBack();
        }
        
        function grantAccess(service) {
             if(!user.paidServices) user.paidServices = {};
             user.paidServices[service] = true;
             // Also mark global premium for generic content
             user.isPremium = true; 
             localStorage.setItem('fg_user', JSON.stringify(user));
             const uIdx = users.findIndex(u => u.phone === user.phone);
             if(uIdx > -1) { 
                 users[uIdx].paidServices = user.paidServices; 
                 users[uIdx].isPremium = true;
                 localStorage.setItem('fg_users', JSON.stringify(users)); 
             }
             
             alert("Activated! You can now use " + service.toUpperCase());
             
             // Redirect specific
             if(service === 'ppt' || service === 'pdf') {
                 promptConvert(service);
             } else {
                 navTo('view-xfwa-info');
                 renderAdminPosts('all', 'paid', service);
             }
        }

        // --- PPT/PDF REAL CONVERSION ---
        function promptConvert(type) {
            document.getElementById('ppt-pdf-title').innerText = `Convert to ${type.toUpperCase()}`;
            document.getElementById('ppt-pdf-input-modal').style.display = 'flex';
            // Store type globally for the modal to use
            activePremService = type; 
        }
        
        function setupConversionInput(mode) {
             pendingConvMode = mode;
             document.getElementById('conv-input-area').style.display = 'block';
             if(mode === 'text') {
                 document.getElementById('conv-text-input').style.display = 'block';
                 document.getElementById('btn-upload-conv-file').style.display = 'none';
             } else {
                 document.getElementById('conv-text-input').style.display = 'none';
                 document.getElementById('btn-upload-conv-file').style.display = 'block';
             }
        }
        
        async function startRealConversion() {
            document.getElementById('ppt-pdf-input-modal').style.display = 'none';
            document.getElementById('convert-progress-modal').style.display = 'flex';
            
            const pBar = document.getElementById('convert-progress-bar');
            const pText = document.getElementById('convert-status-text');
            const btn = document.getElementById('btn-download-converted');
            const cls = document.getElementById('btn-close-convert');
            
            btn.style.display = 'none';
            cls.style.display = 'none';
            pBar.style.width = '0%';
            
            let textToConvert = "";
            
            // 1. Get Text (OCR if file)
            if(pendingConvMode === 'text') {
                textToConvert = document.getElementById('conv-text-input').value;
            } else {
                pText.innerText = "Reading File (OCR)...";
                const file = document.getElementById('conv-file-input').files[0];
                if(file) {
                    try {
                        const result = await Tesseract.recognize(file, 'eng', {
                            logger: m => {
                                if(m.status === 'recognizing text') {
                                    pBar.style.width = Math.floor(m.progress * 50) + '%';
                                    pBar.innerText = Math.floor(m.progress * 50) + '%';
                                }
                            }
                        });
                        textToConvert = result.data.text;
                    } catch (e) {
                        alert("Error reading file: " + e);
                        document.getElementById('convert-progress-modal').style.display = 'none';
                        return;
                    }
                }
            }
            
            if(!textToConvert) textToConvert = "No text found.";
            
            // 2. Convert to PPT/PDF
            pText.innerText = `Generating ${activePremService.toUpperCase()}...`;
            
            // Progress simulation for generation part (50% -> 100%)
            let progress = 50;
            const interval = setInterval(() => {
                progress += 5;
                if(progress > 95) clearInterval(interval);
                pBar.style.width = progress + '%';
                pBar.innerText = progress + '%';
            }, 100);
            
            try {
                if(activePremService === 'ppt') {
                    let pptx = new PptxGenJS();
                    let slide = pptx.addSlide();
                    slide.addText(textToConvert, { x: 1, y: 1, w: '80%', h: '80%', fontSize: 18, color: '363636' });
                    await pptx.writeFile({ fileName: `Fasil_Doc_${Date.now()}.pptx` });
                } else {
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF();
                    const splitText = doc.splitTextToSize(textToConvert, 180);
                    doc.text(splitText, 10, 10);
                    doc.save(`Fasil_Doc_${Date.now()}.pdf`);
                }
                
                clearInterval(interval);
                pBar.style.width = '100%';
                pBar.innerText = '100%';
                pText.innerText = "Done! Download started.";
                cls.style.display = 'block';
                
            } catch (e) {
                alert("Error generating file: " + e);
                document.getElementById('convert-progress-modal').style.display = 'none';
            }
        }
        
        function downloadConvertedFile() {
             // Logic handled in startRealConversion (auto save), this just closes
             document.getElementById('convert-progress-modal').style.display = 'none';
        }

        // --- CHAT & USER ---
        function handleGroupCreate() { 
            showUserList('group'); 
        }
        
        // Updated Task 1: Differentiate User List (Users Button) vs Chat (Chat Button)
        function showUserList(mode) {
            // mode: 'users', 'chat', 'group', 'share', 'send', 'admin-pay', 'fwa-transfer'
            const c = document.getElementById('ul-cont'); 
            c.innerHTML = '';
            
            // Task 9: Hide Send/Receive initially for Chat Mode
            if(mode === 'chat') {
                document.getElementById('chat-action-buttons').style.display = 'none';
                document.getElementById('user-select-hint').style.display = 'none';
            } else if (mode === 'send') {
                 document.getElementById('chat-action-buttons').style.display = 'flex';
                 document.getElementById('user-select-hint').style.display = 'block';
            } else {
                 document.getElementById('chat-action-buttons').style.display = 'none';
                 document.getElementById('user-select-hint').style.display = 'none';
            }
            
            users.forEach(u => {
                if(u.phone === user.phone && mode !== 'admin-pay') return; // Admin can see themselves
                
                // Check if this user sent a message
                const k = [user.phone, u.phone].sort().join('_'); 
                const msgs = chats[k] || [];
                const hasMsg = msgs.length > 0 && msgs[msgs.length-1].u === u.name;
                const msgClass = hasMsg ? 'has-msg' : '';
                
                let clickAction = '';
                if(mode === 'group' || mode === 'share') clickAction = `togBlue(this)`;
                else if(mode === 'send') clickAction = `executeChatSend('${u.phone}', '${u.name}')`;
                else if(mode === 'chat') clickAction = `selectUserForChat('${u.phone}', '${u.name}')`; // Task 9 Logic
                else if(mode === 'admin-pay') clickAction = `adminSelectUserForPay('${u.phone}')`; // Admin Pay
                else if(mode === 'fwa-transfer') clickAction = `selectUserForTransfer('${u.phone}', '${u.name}')`;
                else clickAction = ''; // View only for Users mode
                
                c.innerHTML += `<div class="user-item ${msgClass}" onclick="${clickAction}" data-phone="${u.phone}">
                    <img src="${u.photo || 'lion_image.jpg'}"> 
                    <b>${u.name}</b> ${hasMsg ? 'üü¢' : ''}
                </div>`;
            });
            
            document.getElementById('btn-grp-done').style.display = (mode === 'group') ? 'block' : 'none';
            document.getElementById('btn-share-done').style.display = (mode === 'share') ? 'block' : 'none';
            
            navTo('user-list-sec');
        }

        // Task 9: Chat Selection Logic
        function selectUserForChat(phone, name) {
            activeChatUser = {phone, name};
            const c = document.getElementById('ul-cont');
            c.innerHTML = `<div class="user-item">
                    <img src="lion_image.jpg"> 
                    <b>${name}</b> (Selected)
                </div>
                <button class="btn-red btn-tiny" onclick="showUserList('chat')">Cancel Selection</button>`;
            
            document.getElementById('chat-action-buttons').style.display = 'flex';
        }

        // Task 4: Chat Send Functions - Updated Task 2
        function initiateSendMsg() {
            if(activeChatUser) {
                startChatSend(pendingChatSendType); // Default text
            } else {
                document.getElementById('chat-send-type-modal').style.display = 'flex';
            }
        }

        function startChatSend(type) {
            pendingChatSendType = type;
            document.getElementById('chat-send-type-modal').style.display = 'none';
            if(activeChatUser) {
                executeChatSend(activeChatUser.phone, activeChatUser.name);
            } else {
                showUserList('send'); 
            }
        }

        function executeChatSend(targetPhone, targetName) {
            composeTarget = { phone: targetPhone, name: targetName };
            document.getElementById('compose-target-name').innerText = targetName;
            
            if(pendingChatSendType === 'text') {
                document.getElementById('compose-area-text').style.display = 'block';
                document.getElementById('compose-area-media').style.display = 'none';
            } else {
                document.getElementById('compose-area-text').style.display = 'none';
                document.getElementById('compose-area-media').style.display = 'block';
                document.getElementById('compose-media-type').innerText = pendingChatSendType;
            }
            
            document.getElementById('chat-compose-modal').style.display = 'flex';
        }

        function finalizeSendMsg() {
            let msgContent = "";
            let msgType = pendingChatSendType;
            
            if(msgType === 'text') {
                msgContent = document.getElementById('compose-msg').value;
                if(!msgContent) return alert("Empty Message");
            } else {
                const f = document.getElementById('compose-file').files[0];
                if(!f) return alert("Select File");
                msgContent = "File Sent (Simulation)";
            }
            
            const k = [user.phone, composeTarget.phone].sort().join('_');
            if(!chats[k]) chats[k] = [];
            chats[k].push({ u: user.name, t: msgContent, type: msgType });
            localStorage.setItem('fg_chats', JSON.stringify(chats));
            
            alert("OK (Sent)");
            document.getElementById('chat-compose-modal').style.display = 'none';
            document.getElementById('compose-msg').value = '';
            document.getElementById('compose-file').value = '';
            
            activeChatUser = null; 
            showUserList('chat'); 
        }
        
        // --- SHARE SYSTEM ---
        function setupFWAShare() {
            document.getElementById('share-modal').style.display = 'none';
            showUserList('share'); 
        }
        
        function executeShare() {
            const selected = document.querySelectorAll('.bright-blue');
            if(selected.length === 0) return alert("Select at least one user");
            
            selected.forEach(el => {
                const ph = el.getAttribute('data-phone');
                const u = users.find(x => x.phone === ph);
                if(u) {
                    sharedItems.push({
                        from: user.name,
                        to: u.phone,
                        content: "Check out this content on Fasil Web App!",
                        time: new Date().toLocaleTimeString()
                    });
                }
            });
            
            localStorage.setItem('fg_shared', JSON.stringify(sharedItems));
            alert("Shared Successfully!");
            document.getElementById('btn-share-done').style.display = 'none';
            document.querySelectorAll('.bright-blue').forEach(el => el.classList.remove('bright-blue'));
            goBack();
        }
        
        function filterMessages() {
            if(activeChatUser) {
                openChat(activeChatUser.phone);
                return;
            }
            alert("Select a user name first to see messages.");
        }
        
        function togBlue(el) { 
            el.classList.toggle('bright-blue'); 
            checkGrpCount(); 
        }
        
        function checkGrpCount() {
            const cnt = document.querySelectorAll('.bright-blue').length;
            document.getElementById('btn-grp-done').style.display = cnt >= 5 ? 'block' : 'none';
        }
        
        // Updated Task 4: Groups
        function createGroup() {
            const n = prompt("Name:");
            if(n) {
                groups.push({ 
                    id: Date.now(), 
                    name: n, 
                    creator: user.phone, 
                    admins: [user.phone], 
                    members: [user.phone], 
                    requests: [],



 
        ·ä®·ãö·àÖ·àã·ã≠ ·ã≠·ä®·çà·àã·àç·ç¢·ãà·ã∞·àã·ã≠ ·ãà·ã∞·â≥·âΩ·ç¢






                    banned: [],
                    msgs: [] 
                });
                localStorage.setItem('fg_groups', JSON.stringify(groups));
                showAlert("Group Created", "success"); 
                goBack();
            }
        }
        
        function showMyGroups() {
            const c = document.getElementById('grp-list'); 
            c.innerHTML = '';
            
            if(!groups || !Array.isArray(groups) || groups.length === 0) {
                 c.innerHTML = '<p>No groups created yet. Create one!</p>';
                 navTo('my-groups-sec');
                 return;
            }

            groups.forEach(g => {
                const bannedList = g.banned || [];
                const memberList = g.members || [];
                if(bannedList.includes(user.phone)) return;
                
                const isMember = memberList.includes(user.phone);
                const isOwner = g.creator === user.phone;
                let tag = isOwner ? "üü¢ (Owner)" : (isMember ? "üîµ (Member)" : "‚ö™ (Join)");

                c.innerHTML += `<div class="user-item" onclick="handleGroupClick(${g.id})">
                    <b>${g.name}</b> ${tag}
                </div>`; 
            });
            navTo('my-groups-sec');
        }
        
        let activeGroup = null;
        function handleGroupClick(gid) {
            activeGroup = groups.find(x => x.id === gid);
            if(!activeGroup) return;

            const bannedList = activeGroup.banned || [];
            const memberList = activeGroup.members || [];
            const adminList = activeGroup.admins || [];
            const requestsList = activeGroup.requests || [];

            if(bannedList.includes(user.phone)) {
                return alert("You are banned from this group.");
            }
            
            const isMember = memberList.includes(user.phone);
            
            if(isMember) {
                const isOwner = activeGroup.creator === user.phone;
                const isAdmin = adminList.includes(user.phone);
                
                if(isAdmin || isOwner) {
                     document.getElementById('grp-ctrl-title').innerText = activeGroup.name + (isOwner ? " (Owner)" : " (Admin)");
                     document.getElementById('grp-owner-opts').style.display = 'block';
                     document.getElementById('grp-guest-opts').style.display = 'none';
                     document.getElementById('grp-ctrl-modal').style.display = 'flex';
                } else {
                     document.getElementById('grp-ctrl-title').innerText = activeGroup.name;
                     document.getElementById('grp-owner-opts').style.display = 'none';
                     document.getElementById('grp-guest-opts').style.display = 'block';
                     document.getElementById('btn-grp-join').style.display = 'none';
                     document.getElementById('btn-grp-play').style.display = 'block';
                     document.getElementById('grp-status-text').innerText = "You are a member.";
                     document.getElementById('grp-ctrl-modal').style.display = 'flex';
                }
            } else {
                document.getElementById('grp-ctrl-title').innerText = activeGroup.name;
                document.getElementById('grp-owner-opts').style.display = 'none';
                document.getElementById('grp-guest-opts').style.display = 'block';
                document.getElementById('btn-grp-play').style.display = 'none';
                
                if(requestsList.includes(user.phone)) {
                    document.getElementById('grp-status-text').innerText = "Waiting for Admin approval...";
                    document.getElementById('btn-grp-join').style.display = 'none';
                } else {
                    document.getElementById('grp-status-text').innerText = "Join to see content.";
                    document.getElementById('btn-grp-join').style.display = 'block';
                }
                document.getElementById('grp-ctrl-modal').style.display = 'flex';
            }
        }
        
        function showGrpMembers(action) {
            document.getElementById('grp-ctrl-modal').style.display = 'none';
            document.getElementById('grp-members-modal').style.display = 'flex';
            const c = document.getElementById('grp-members-list');
            c.innerHTML = '';
            
            if(!activeGroup) return;
            const members = activeGroup.members || [];
            
            members.forEach(mPhone => {
                const mUser = users.find(u => u.phone === mPhone);
                if(!mUser) return;
                
                let btnHtml = '';
                if(action === 'ban') {
                    if(mPhone !== activeGroup.creator) {
                        btnHtml = `<button class="btn-red btn-tiny" onclick="grpAction('ban_user', '${mPhone}')">Ban</button>`;
                    }
                } else if(action === 'add_admin') {
                     if(!activeGroup.admins.includes(mPhone)) {
                         btnHtml = `<button class="btn-green btn-tiny" onclick="grpAction('make_admin', '${mPhone}')">Make Admin</button>`;
                     }
                } else if(action === 'remove_admin') {
                     if(activeGroup.admins.includes(mPhone) && mPhone !== activeGroup.creator) {
                         btnHtml = `<button class="btn-red btn-tiny" onclick="grpAction('revoke_admin', '${mPhone}')">Remove Admin</button>`;
                     }
                }
                
                c.innerHTML += `<div class="user-item">
                    <img src="${mUser.photo || 'lion_image.jpg'}">
                    <b>${mUser.name}</b>
                    <div style="margin-left:auto;">${btnHtml}</div>
                </div>`;
            });
        }
        
        function grpAction(act, targetPhone) {
            if(act === 'join') {
                document.getElementById('grp-ctrl-modal').style.display = 'none';
                if(!activeGroup.requests) activeGroup.requests = [];
                activeGroup.requests.push(user.phone);
                localStorage.setItem('fg_groups', JSON.stringify(groups));
                alert("Request Sent! Wait for Admin.");
            } 
            else if(act === 'make_admin') {
                if(!activeGroup.admins.includes(targetPhone)) {
                    activeGroup.admins.push(targetPhone);
                    localStorage.setItem('fg_groups', JSON.stringify(groups));
                    alert("Admin Added");
                    showGrpMembers('add_admin'); 
                }
            }
            else if(act === 'revoke_admin') {
                if(targetPhone === activeGroup.creator) return alert("Cannot remove Creator");
                activeGroup.admins = activeGroup.admins.filter(a => a !== targetPhone);
                localStorage.setItem('fg_groups', JSON.stringify(groups));
                alert("Admin Removed");
                showGrpMembers('remove_admin'); 
            }
            else if(act === 'ban_user') {
                if(targetPhone === activeGroup.creator) return alert("Cannot ban Creator");
                if(!activeGroup.banned) activeGroup.banned = [];
                activeGroup.banned.push(targetPhone);
                activeGroup.members = (activeGroup.members || []).filter(m => m !== targetPhone);
                activeGroup.admins = (activeGroup.admins || []).filter(m => m !== targetPhone);
                localStorage.setItem('fg_groups', JSON.stringify(groups));
                alert("User Banned");
                showGrpMembers('ban'); 
            }
            else if(act === 'requests') {
                 document.getElementById('grp-ctrl-modal').style.display = 'none';
                 if(!activeGroup.requests || activeGroup.requests.length === 0) return alert("No requests");
                 const r = activeGroup.requests[0]; 
                 const conf = confirm(`Accept ${r}?`);
                 if(conf) {
                     if(!activeGroup.members) activeGroup.members = [];
                     activeGroup.members.push(r);
                     activeGroup.requests = activeGroup.requests.filter(x => x !== r);
                     localStorage.setItem('fg_groups', JSON.stringify(groups));
                     alert("Member Added");
                 }
            }
        }
        
        function openGrpChat() {
            document.getElementById('grp-ctrl-modal').style.display = 'none';
            openGrp(activeGroup.id);
        }

        function handleChatList() { 
            showUserList('chat'); 
        }
        
        function openChat(ph) { 
            activeChat = { type: 'p', id: ph }; 
            navTo('chat-sec'); 
            renderChat(); 
        }
        
        function openGrp(id) { 
            activeChat = { type: 'g', id: id }; 
            navTo('chat-sec'); 
            renderChat(); 
        }
        
        function sendChat(t) {
            let txt = "";
            let msgType = t;
            
            if(t === 'text') {
                txt = document.getElementById('chat-in').value; 
                if(!txt) return;
            } else {
                 txt = "File Sent";
                 msgType = 'image'; 
            }

            const msg = { u: user.name, t: txt, type: msgType };
            if(activeChat.type === 'p') { 
                const k = [user.phone, activeChat.id].sort().join('_'); 
                if(!chats[k]) chats[k] = []; 
                chats[k].push(msg); 
                localStorage.setItem('fg_chats', JSON.stringify(chats)); 
            } else { 
                const g = groups.find(x => x.id === activeChat.id); 
                g.msgs.push(msg); 
                localStorage.setItem('fg_groups', JSON.stringify(groups)); 
            }
            document.getElementById('chat-in').value = '';
            renderChat();
        }
        
        function renderChat() {
            const c = document.getElementById('chat-box'); 
            let msgs = [];
            if(activeChat.type === 'p') { 
                const k = [user.phone, activeChat.id].sort().join('_'); 
                msgs = chats[k] || []; 
            } else {
                const g = groups.find(x => x.id === activeChat.id);
                msgs = g ? g.msgs : [];
            }
            c.innerHTML = msgs.map(m => `<div><b>${m.u}:</b> ${m.t}</div>`).join('');
            c.scrollTop = c.scrollHeight;
        }
        
        // --- LIVE - UPDATED TO REAL LIVE ---
        function openRealLiveStream() {
            // Task 6: Login Enforce
            if(!user) {
                alert("Please Login First (·ä•·â£·ä≠·ãé ·àò·åÄ·àò·à≠·ã´ ·ã≠·åç·â°)");
                document.getElementById('welcome-content').style.display = 'none';
                document.getElementById('auth-section').style.display = 'block';
                navTo('view-agreement');
                return;
            }
            
            showView('view-live');
            document.getElementById('live-chat-box').innerHTML = ''; // Clear chat
            updateLiveViewers();
        }
        
        // --- PROFILE - Updated Task 11 & 7 (Immediate Update) ---
        function saveProfile() {
            const n = document.getElementById('prof-name-edit').value; 
            const o = document.getElementById('old-pass').value; 
            const p = document.getElementById('new-pass').value; 
            const cp = document.getElementById('conf-pass').value;
            if(p && p !== cp) return showAlert("Passwords do not match", "error");
            if(o && o !== user.password) return showAlert("Old Password Wrong", "error");
            
            // Task 12: Update User Object
            if(n) user.name = n; 
            if(p) user.password = p;
            
            // Update users array via reference
            const uIdx = users.findIndex(u => u.phone === user.phone);
            if(uIdx > -1) {
                users[uIdx] = user; // Ensure the main array has the new data
                localStorage.setItem('fg_users', JSON.stringify(users));
                localStorage.setItem('fg_user', JSON.stringify(user));
                
                // Clear inputs
                document.getElementById('old-pass').value = '';
                document.getElementById('new-pass').value = '';
                document.getElementById('conf-pass').value = '';
                
                // Sync with Firebase (Task 5 Persistence)
                if(window.firebaseTools && user.id) {
                    // This is simplified, ideally we update fields in Firestore
                }
                
                showAlert("Updated Successfully (·ãò·àù·äó·àç)! Please use new password next time.", "success");
            }
        }
        
        function deleteAccount() {
             if(confirm("Are you sure?")) {
                 users = users.filter(u => u.phone !== user.phone);
                 localStorage.setItem('fg_users', JSON.stringify(users));
                 if(window.firebaseTools && user.id) window.firebaseTools.deleteUser(user.phone);
                 doLogout();
             }
        }

        // --- FEEDBACK ---
        function giveFb(t) {
            if(t === 'live') openRealLiveStream();
            else { 
                const x = prompt("Text:"); 
                if(x) { 
                    feedbacks.push({ u: user.name, c: x }); 
                    localStorage.setItem('fg_fbs', JSON.stringify(feedbacks)); 
                    showAlert("Sent", "success"); 
                } 
            }
        }
        
        function viewFbs() { 
            document.getElementById('fb-list').innerHTML = feedbacks.map(f => `<div><b>${f.u}:</b> ${f.c}</div>`).join(''); 
        }
        
        // --- VPN & VISIBILITY (Task 6 & 7) ---
        function setupVPN() {
            // Step 1
            alert("·ã≠·àÖ ·ã®·çã·à≤·àç ·ãå·â• ·ä†·çï ·ãµ·àÖ·à®·åà·çÖ ·ä†·àç·à∞·à´ ·ä´·àà·ãé·âµ ·ãà·ã≠·àù ·ä¢·äï·â∞·à≠·äî·âµ ·âΩ·åç·à´ ·ä´·åã·å†·àò·ãé·âµ ·çï·àÆ·â∂·äï ·â™·çí·ä§·äï ·ã´·â•·à©·ç¢");
            window.open("https://play.google.com/store/apps/details?id=ch.protonvpn.android"); 
            
            setTimeout(() => {
                const conf1 = confirm("·çï·àÆ·â∂·äï ·â™·çí·ä§·äï ·ä†·ãç·à≠·ã∞·ãç ·ä†·â•·à≠·â∞·ãã·àç? ·ãà·ã∞ ·çã·à≤·àç ·ãå·â• ·ä†·çï ·ã≠·àò·àà·à±·ç¢ (Return to App?)");
                if(conf1) {
                    // Step 2
                    alert("·ä†·àÅ·äï ·ã∞·åç·àû ·ä¶·à≠·â¢·âµ (Orbot) ·ä†·çï ·àõ·â•·à´·âµ ·ã´·àµ·çà·àç·åã·àç·ç¢ ·ã≠·àÖ ·ä†·çï ·ä¢·äï·â∞·à≠·äî·âµ ·â¢·âã·à®·å•·àù ·â™·çí·ä§·äë ·ä•·äï·ã≤·à∞·à´ ·ã´·ã∞·à≠·åã·àç·ç¢");
                    window.open("https://play.google.com/store/apps/details?id=org.torproject.android");
                    
                    setTimeout(() => {
                        const conf2 = confirm("·ä¶·à≠·â¢·âµ ·ä†·çï ·ä†·ãç·à≠·ã∞·ãç ·äÆ·äî·ä≠·âµ ·ä†·ãµ·à≠·åà·ãã·àç? ·ãà·ã∞ ·çã·à≤·àç ·ãå·â• ·ä†·çï ·ã≠·àò·àà·à±·ç¢");
                        if(conf2) {
                            alert("·ä†·àÅ·äï ·çã·à≤·àç ·ãå·â• ·ä†·çï ·â†·âµ·ä≠·ä≠·àç ·ã≠·à∞·à´·àç! (Setup Complete)");
                        }
                    }, 5000);
                }
            }, 3000);
        }
        
        function toggleVPNVisibility(mode) {
             vpnVisible = (mode === 'show');
             localStorage.setItem('fg_vpn_visible', vpnVisible);
             alert(mode === 'show' ? "VPN Button Visible" : "VPN Button Hidden");
        }
        
        function toggleBizVisibility(mode) {
             bizVisible = (mode === 'show');
             localStorage.setItem('fg_biz_visible', bizVisible);
             alert(mode === 'show' ? "Business Button Visible" : "Business Button Hidden");
             document.getElementById('adm-biz-ctrl-modal').style.display = 'none';
        }
        
        // Apply Visibility on Load/Nav
        function applyVisibilitySettings() {
             const vpnBtn = document.getElementById('btn-vpn-dash');
             if(vpnBtn) vpnBtn.style.display = vpnVisible ? 'block' : 'none';
             
             const bizBtn = document.getElementById('btn-lb');
             if(bizBtn) bizBtn.style.display = bizVisible ? 'block' : 'none';
        }
        
        // Overwrite navToHome to apply visibility
        let originalNavToHome = navToHome;
        navToHome = function() {
            originalNavToHome();
            applyVisibilitySettings();
        };

        // Init
        if(user && user.balFWA === undefined) {
            user.balFWA = 0;
            localStorage.setItem('fg_user', JSON.stringify(user));
        }
        
        setTimeout(() => {
            const statusEl = document.getElementById('firebase-status');
            if(window.firebaseTools) {
                statusEl.style.display = 'block'; 
            }
        }, 3000);
        
        if(user) {
            upBal();
            applyVisibilitySettings();
        }

        // Language System - Task 1 (Complete Translation)
        const translations = {
            'am': {
                'head-txt': '·ä•·äï·ä≥·äï ·ãà·ã∞ ·çã·à≤·àç ·ãå·â• ·ä†·çï ·ã®·ä†·åà·àç·åç·àé·âµ ·àõ·ãï·ä®·àç ·â†·ã∞·àÖ·äì ·àò·å°!',
                't-w-s': '·ä•·äï·ä≥·äï ·ã∞·àÖ·äì ·àò·å°',
                't-in': '·ã≠·àÖ ·ã®·çã·à≤·àç ·ãå·â• ·ä†·çï ·â†·â∞·ä†·àõ·äí·äê·âµ ·ä•·äï·ã≤·à∞·à´ ·ã®·â∞·âÄ·ã®·à∞ ·ã≤·åÇ·â≥·àç ·àò·à®·åÉ ·àò·åã·à™·ã´ ·äê·ãç·ç¢',
                't-p-s': '·å•·â•·âÖ ·àò·àò·à™·ã´',
                't-po': '·çñ·àà·â≤·ä´·ç£ ·å•·àã·âª·ç£ ·ãò·à®·äù·äê·âµ ·ä•·äì ·àÄ·à∞·â∞·äõ ·àò·à®·åÉ ·àõ·âÖ·à®·â• ·â†·å•·â•·âÖ ·ã®·â∞·ä®·àà·ä®·àà ·äê·ãç·ç¢',
                'btn-agree': '·ä•·àµ·àõ·àõ·àà·àÅ',
                'btn-disagree': '·ä†·àç·àµ·àõ·àõ·àù',
                't-thx': '·ä†·åà·àç·åç·àé·â≥·âΩ·äï·äï ·àµ·àà·àò·à®·å° ·ä•·äì·àò·à∞·åç·äì·àà·äï! ·ä†·ã≤·àµ ·ä®·àÜ·äë ·ã≠·àò·ãù·åà·â°·ç£ ·ä´·àà·ãé·âµ ·ã≠·åç·â°·ç¢',
                'btn-sh-s': '·àò·àò·ãù·åà·â¢·ã´',
                'btn-sh-l': '·àò·åç·â¢·ã´',
                'h-s': '·àù·ãù·åà·â£ (·ä†·ã≤·àµ ·â•·âª)',
                'h-l': '·àò·åç·â¢·ã´ (·äê·â£·à≠)',
                't-d': '·ã≥·àΩ·â¶·à≠·ãµ',
                'btn-dash-rewards': '·ä≠·çç·ã´ ·ã≠·âÄ·â†·àâ/·çñ·ã≠·äï·âµ',
                'btn-fc': '·ã®·äê·çÉ ·ä†·åà·àç·åç·àé·âµ ·àõ·ãï·ä®·àç',
                'btn-pc': '·ã®·ä≠·çç·ã´ ·çï·à™·àö·ã®·àù ·ä†·åà·àç·åç·àé·âµ',
                'btn-lv': '·àò·à®·åÉ ·àò·àò·àç·ä®·âµ',
                'btn-lp': '·àò·à®·åÉ ·àò·àà·å†·çç',
                'btn-perf-free': '·ä•·ãç·äê·â∞·äõ ·çê·à≠·çå·ä≠·âµ ·àò·à®·åÉ (Free)',
                'btn-lg': '·åç·à©·çï ·àò·çç·å†·à≠',
                'btn-lmg': '·ã®·çà·å†·à©·âµ·äï ·åç·à©·çï ·àà·àò·àò·àç·ä®·âµ',
                'btn-lc': '·âª·âµ',
                'btn-lf': '·àà·çã·à≤·àç ·ãå·â• ·ä†·çï ·çà·å£·à™ ·ä†·àµ·â∞·ã´·ã®·âµ ·àà·àò·àµ·å†·âµ ·ä•·äì ·àà·àò·àò·àç·ä®·âµ',
                'btn-lu': '·â∞·å†·âÉ·àö·ãé·âΩ',
                'btn-lb': '·â¢·ãù·äê·àµ',
                'btn-prem-vid': '·å•·à´·âµ ·ã´·àà·ãç ·â™·ã≤·ãÆ',
                'btn-prem-news': '·ãú·äì (High Quality)',
                'btn-prem-img': '·àù·àµ·àç (High Quality)',
                'btn-pp': 'PowerPoint',
                'btn-ppdf': 'PDF',
                'btn-perf-paid': '·çê·à≠·çå·ä≠·âµ ·àò·à®·åÉ ·â†·ä≠·çç·ã´',
                'btn-view-change-rate': 'View Change Rate',
                'btn-rew-exchange': '·ä¢·ä≠·àµ·â∏·äï·åÖ ·àà·àõ·ãµ·à®·åç',
                'btn-rew-collect': '·çñ·ã≠·äï·âµ ·àà·àò·à∞·â•·à∞·â•',
                'btn-rew-redeem': '·àà·àò·å†·âÄ·àù',
                'btn-rew-withdraw': '·àà·àõ·ãç·å£·âµ',
                'btn-share-ref': '·àà·åì·ã∞·äõ ·çã·à≤·àç ·ãå·â•·äï ·â†·àõ·åã·à´·âµ',
                'btn-copy-link': 'Share Link (Copy)',
                'ref-desc': '·çã·à≤·àç ·ãå·â• ·ä†·çï·äï ·â†·à∂·àª·àç ·àö·ã≤·ã´ ·ã´·åã·à©·ç¢',
                'txt-disclaimer-msg': '·â†·ãö·àÖ ·åà·çÖ ·àã·ã≠ ·ã®·àö·àò·àà·ä®·â±·âµ ·àò·à®·åÉ ·àõ·äï·äõ·ãç·àù ·â∞·å†·âÉ·àö ·â†·äê·çÉ·äê·âµ ·ã®·àö·àà·å•·çè·â∏·ãç ·àç·å•·çé·âΩ ·äê·ãç·ç¢',
                'btn-view-confirm': '·àà·àò·àò·àç·ä®·âµ (View)',
                'btn-view-cancel': '·ã≠·âÖ·à≠·â•·äù (Cancel)',
                'txt-perf-desc': '·â†·ãö·àÖ ·åà·çÖ ·ä•·ãç·äê·â∞·äõ ·àò·à®·åÉ ·ã´·åà·äõ·àâ ·çê·à≠·çå·ä≠·âµ ·àò·à®·åÉ ·äê·ãç·ç¢',
                'btn-pi-txt': '·â¥·ä≠·àµ·âµ (Text)',
                'btn-pi-img': '·àù·àµ·àç (Image)',
                'btn-pi-vid': '·â¢·ã≤·ãÆ (Video)',
                'btn-pi-aud': '·ãµ·àù·çÖ (Audio)',
                'btn-out': '·ãç·å£',
                't-ph': '·àò·à®·åÉ ·àò·àà·å†·çç',
                't-vh': '·àò·à®·åÉ ·àò·àò·àç·ä®·âµ',
                't-bh': '·â¢·ãù·äê·àµ ·àõ·ãï·ä®·àç',
                't-prof': '·ã®·åç·àç ·àõ·ãï·ä®·àç',
                'nav-h': 'Home',
                'nav-l': 'Live',
                'nav-p': 'Profile',
                'btn-policy': '·çñ·àä·à≤ (Policy)',
                'btn-next': '·âÄ·å£·ã≠ (Next)',
                'btn-confirm': '·ä†·à®·åã·åç·å• (Confirm)',
                'btn-login': '·åç·â£ (Login)',
                'pass-req': '·ã®·ã≠·àà·çç ·âÉ·àç ·ã´·àµ·çà·àç·åã·àç',
                'disclaimer-title': '·àõ·àµ·å†·äï·âÄ·âÇ·ã´ (Disclaimer)',
                'perfect-header-title': '·ä•·ãç·äê·â∞·äõ ·çê·à≠·çå·ä≠·âµ ·àò·à®·åÉ (Free)',
                'btn-bd': 'Deposit',
                'btn-b-exch': 'Exchange & View',
                'btn-bw': 'Withdraw',
                'btn-bi': 'Intl Purchase',
                't-dep-h': 'Deposit',
                't-with-h': 'Withdraw',
                't-intl-h': 'Intl Purchase',
                'txt-processing': '·ä•·ã®·à∞·à´ ·äê·ãç...'
            },
            'en': {
                'head-txt': 'Welcome to Fasil Web App Service Center!',
                't-w-s': 'Welcome',
                't-in': 'This is Fasil Web App, a digital info sharing platform designed for reliability.',
                't-p-s': 'Strict Policy',
                't-po': 'Politics, hate speech, racism, and fake news are strictly prohibited.',
                'btn-agree': 'I Agree',
                'btn-disagree': 'I Disagree',
                't-thx': 'Thank you for choosing us! Sign up if new, Login if existing.',
                'btn-sh-s': 'Register',
                'btn-sh-l': 'Login',
                'h-s': 'Registration (New)',
                'h-l': 'Login (Existing)',
                't-d': 'Dashboard',
                'btn-dash-rewards': 'Receive Pay/Points',
                'btn-fc': 'Free Service Center',
                'btn-pc': 'Premium Payment Service',
                'btn-lv': 'View Info',
                'btn-lp': 'Post Info',
                'btn-perf-free': 'Real Perfect Info (Free)',
                'btn-lg': 'Create Group',
                'btn-lmg': 'View My Groups',
                'btn-lc': 'Chat',
                'btn-lf': 'Feedback to Creator',
                'btn-lu': 'Users',
                'btn-lb': 'Business',
                'btn-prem-vid': 'High Quality Video',
                'btn-prem-news': 'News (High Quality)',
                'btn-prem-img': 'Image (High Quality)',
                'btn-pp': 'PowerPoint',
                'btn-ppdf': 'PDF',
                'btn-perf-paid': 'Perfect Info (Paid)',
                'btn-view-change-rate': 'View Change Rate',
                'btn-rew-exchange': 'To Exchange',
                'btn-rew-collect': 'To Collect Points',
                'btn-rew-redeem': 'To Use/Redeem',
                'btn-rew-withdraw': 'To Withdraw',
                'btn-share-ref': 'Share Fasil Web to Friends',
                'btn-copy-link': 'Share Link (Copy)',
                'ref-desc': 'Share Fasil Web App on Social Media.',
                'txt-disclaimer-msg': 'Information here is posted freely by users. Authenticity is not guaranteed.',
                'btn-view-confirm': 'View',
                'btn-view-cancel': 'Cancel',
                'txt-perf-desc': 'You will find real perfect information here.',
                'btn-pi-txt': 'Text',
                'btn-pi-img': 'Image',
                'btn-pi-vid': 'Video',
                'btn-pi-aud': 'Audio',
                'btn-out': 'Logout',
                't-ph': 'Post Info',
                't-vh': 'View Info',
                't-bh': 'Business Center',
                't-prof': 'Profile Center',
                'nav-h': 'Home',
                'nav-l': 'Live',
                'nav-p': 'Profile',
                'btn-policy': 'Policy',
                'btn-next': 'Next',
                'btn-confirm': 'Confirm',
                'btn-login': 'Login',
                'pass-req': 'Password Required',
                'disclaimer-title': 'Disclaimer',
                'perfect-header-title': 'Real Perfect Info (Free)',
                'btn-bd': 'Deposit',
                'btn-b-exch': 'Exchange & View',
                'btn-bw': 'Withdraw',
                'btn-bi': 'Intl Purchase',
                't-dep-h': 'Deposit',
                't-with-h': 'Withdraw',
                't-intl-h': 'Intl Purchase',
                'txt-processing': 'Processing...'
            },
            'or': {
                'head-txt': 'Baga nagaan gara Fasil Web App dhuftan!',
                't-w-s': 'Baga Nagaan Dhuftan',
                't-in': 'Kuni Fasil Web App, waltajjii odeeffannoo dijitaalaa amansiisaa ta\'eedha.',
                't-p-s': 'Seera Cimaa',
                't-po': 'Siyaasa, jibbiinsa, sanyummaa fi oduu sobaa dorkaa dha.',
                'btn-agree': 'Waliigaleera',
                'btn-disagree': 'Waliihingalu',
                't-thx': 'Galatoomaa! Yoo haaraa taatan galmaa\'aa.',
                'btn-sh-s': 'Galmaa\'i',
                'btn-sh-l': 'Seeni',
                'h-s': 'Galmee',
                'h-l': 'Seensa',
                't-d': 'Daashbooardii',
                'btn-dash-rewards': 'Kaffaltii/Qabxii Fudhadhu',
                'btn-fc': 'Tajaajila Bilisaa',
                'btn-pc': 'Tajaajila Kaffaltii',
                'btn-lv': 'Odeeffannoo Ilaaluu',
                'btn-lp': 'Odeeffannoo Maxxansuu',
                'btn-perf-free': 'Odeeffannoo Sirrii (Bilisa)',
                'btn-lg': 'Gare Uumuu',
                'btn-lmg': 'Gare Koo Ilaaluu',
                'btn-lc': 'Haasaa',
                'btn-lf': 'Yaada Kennuu',
                'btn-lu': 'Fayyadamtoota',
                'btn-lb': 'Daldala',
                'btn-prem-vid': 'Viidiyo Qulqullina',
                'btn-prem-news': 'Oduu (Qulqullina)',
                'btn-prem-img': 'Fakkii (Qulqullina)',
                'btn-pp': 'PowerPoint',
                'btn-ppdf': 'PDF',
                'btn-perf-paid': 'Odeeffannoo Sirrii (Kaffaltii)',
                'btn-view-change-rate': 'Gatii Jijjiirraa Ilaali',
                'btn-rew-exchange': 'Jijjiiruuf',
                'btn-rew-collect': 'Qabxii Sassaabuuf',
                'btn-rew-redeem': 'Fayyadamuuf',
                'btn-rew-withdraw': 'Baasuuf',
                'btn-share-ref': 'Hiriyootaaf Qoodaa',
                'btn-copy-link': 'Liinkii Koppii Godhi',
                'ref-desc': 'Fasil Web App miidiyaa hawaasaa irratti qoodaa.',
                'txt-disclaimer-msg': 'Odeeffannoon asii kan fayyadamtootaan maxxanfame.',
                'btn-view-confirm': 'Ilaaluu',
                'btn-view-cancel': 'Dhiisi',
                'txt-perf-desc': 'Asitti odeeffannoo dhugaa argattu.',
                'btn-pi-txt': 'Barreeffama',
                'btn-pi-img': 'Fakkii',
                'btn-pi-vid': 'Viidiyoo',
                'btn-pi-aud': 'Sagalee',
                'btn-out': 'Ba\'i',
                't-ph': 'Odeeffannoo',
                't-vh': 'Odeeffannoo',
                't-bh': 'Giddugala Daldalaa',
                't-prof': 'Profaayilii',
                'nav-h': 'Home',
                'nav-l': 'Live',
                'nav-p': 'Profile',
                'btn-policy': 'Seera',
                'btn-next': 'Itti Aanu',
                'btn-confirm': 'Mirkaneessi',
                'btn-login': 'Seeni',
                'pass-req': 'Jecha Darbii Barbaachisa',
                'disclaimer-title': 'Akeekkachiisa',
                'perfect-header-title': 'Odeeffannoo Sirrii (Bilisa)',
                'btn-bd': 'Kuusaa',
                'btn-b-exch': 'Jijjiirraa',
                'btn-bw': 'Baasuu',
                'btn-bi': 'Bittaa Idil-addunyaa',
                't-dep-h': 'Kuusaa',
                't-with-h': 'Baasuu',
                't-intl-h': 'Bittaa Idil-addunyaa',
                'txt-processing': 'Hojjachaa jira...'
            },
            'tg': {
                'head-txt': '·ä•·äï·âã·ãï ·äì·â• ·çã·à≤·àç ·ãå·â• ·ä†·çï ·â•·à∞·àã·àù ·àò·åª·ä•·ä©·àù!',
                't-w-s': '·ä•·äï·âã·ãï ·â•·à∞·àã·àù ·àò·åª·ä•·ä©·àù',
                't-in': '·ä•·ãö ·çã·à≤·àç ·ãå·â• ·ä†·çï ·ã≤·åÇ·â≥·àç ·àì·â†·à¨·â≥ ·àò·àà·ãã·ãà·å¢ ·ä•·ã©·ç¢',
                't-p-s': '·å•·â•·âÇ ·àò·àù·à≠·àí',
                't-po': '·çñ·àà·â≤·ä´·ç£ ·åΩ·àç·ä¢·ç£ ·ãì·àå·âµ·äê·âµ·äï ·àì·à∂·âµ ·àì·â†·à¨·â≥·äï ·àù·àÉ·â• ·ä≠·àç·ä©·àç ·ä•·ã©·ç¢',
                'btn-agree': '·ã≠·à∞·àõ·àõ·ãï',
                'btn-disagree': '·ä†·ã≠·à∞·àõ·àõ·ãï·äï',
                't-thx': '·äê·åà·àç·åç·àé·âµ·äì ·àµ·àà·ãù·àò·à®·åΩ·ä©·àù ·ã®·âê·äï·ã®·àç·äì! ·àì·ãµ·àΩ ·ä•·äï·â∞·äæ·äï·ä©·àù ·â∞·àò·ãù·åà·â°·ç¢',
                'btn-sh-s': '·àò·àò·ãù·åà·â¢',
                'btn-sh-l': '·àò·ä•·â∞·ãä',
                'h-s': '·àù·ãù·åà·â£ (·àì·ãµ·àΩ)',
                'h-l': '·àò·ä•·â∞·ãä (·äê·â£·à≠)',
                't-d': '·ã≥·àΩ·â¶·à≠·ãµ',
                'btn-dash-rewards': '·ä≠·çç·àä·âµ ·â∞·âÄ·â†·àâ/·çñ·ã≠·äï·âµ',
                'btn-fc': '·äì·åª ·ä£·åà·àç·åç·àé·âµ ·àõ·ä•·ä®·àç',
                'btn-pc': '·ä≠·çç·àä·âµ ·çï·à™·àö·ã®·àù ·ä£·åà·àç·åç·àé·âµ',
                'btn-lv': '·àì·â†·à¨·â≥ ·äï·àù·à≠·ä£·ã≠',
                'btn-lp': '·àì·â†·à¨·â≥ ·äï·àù·àç·å£·çç',
                'btn-perf-free': '·âµ·ä≠·ä≠·àà·äõ ·çê·à≠·çå·ä≠·âµ ·àì·â†·à¨·â≥ (Free)',
                'btn-lg': '·åç·à©·çï ·äï·àù·çç·å£·à≠',
                'btn-lmg': '·ãù·çà·å†·à≠·ä©·àù·ãé ·åç·à©·çï ·äï·àù·à≠·ä£·ã≠',
                'btn-lc': '·âª·âµ',
                'btn-lf': '·à≠·ä¢·â∂ ·äï·àù·àÉ·â•',
                'btn-lu': '·â∞·å†·âÄ·àù·â≤',
                'btn-lb': '·â¢·ãù·äê·àµ',
                'btn-prem-vid': '·çÖ·à¨·âµ ·ãò·àà·ãé ·â™·ãµ·ãÆ',
                'btn-prem-news': '·ãú·äì (High Quality)',
                'btn-prem-img': '·àù·àµ·àä (High Quality)',
                'btn-pp': 'PowerPoint',
                'btn-ppdf': 'PDF',
                'btn-perf-paid': '·çê·à≠·çå·ä≠·âµ ·àì·â†·à¨·â≥ ·â•·ä≠·çç·àä·âµ',
                'btn-view-change-rate': '·à∏·à≠·çä ·äï·àù·à≠·ä£·ã≠',
                'btn-rew-exchange': '·ä¢·ä≠·àµ·â∏·äï·åÖ ·äï·àù·åç·â£·à≠',
                'btn-rew-collect': '·çñ·ã≠·äï·âµ ·äï·àù·ä•·ä´·â•',
                'btn-rew-redeem': '·äï·àù·å•·âÉ·àù',
                'btn-rew-withdraw': '·äï·àù·ãç·åª·ä•',
                'btn-share-ref': '·äï·çà·â≥·ãä·äπ·àù ·àº·à≠ ·åç·â†·à©',
                'btn-copy-link': '·àº·à≠ ·àä·äï·ä≠ (Copy)',
                'ref-desc': '·çã·à≤·àç ·ãå·â• ·ä†·çï ·ä£·â• ·à∂·àª·àç ·àö·ãµ·ã´ ·àº·à≠ ·åç·â†·à©·ç¢',
                'txt-disclaimer-msg': '·ä£·â•·ãö ·åà·åΩ ·ä•·ãö ·ä•·âµ·à≠·ä•·ã≠·ãé ·àì·â†·à¨·â≥ ·ãù·äæ·äê ·â∞·å†·âÉ·àö ·â•·äì·åª ·ãù·àç·å•·çé ·ä•·ã©·ç¢',
                'btn-view-confirm': '·äï·àù·à≠·ä£·ã≠',
                'btn-view-cancel': '·ã≠·â∞·ãà·äí',
                'txt-perf-desc': '·ä£·â•·ãö ·åà·åΩ ·âµ·ä≠·ä≠·àà·äõ ·àì·â†·à¨·â≥ ·ã≠·à®·ä≠·â°·ç¢',
                'btn-pi-txt': '·çÖ·àë·çç',
                'btn-pi-img': '·àù·àµ·àä',
                'btn-pi-vid': '·â™·ãµ·ãÆ',
                'btn-pi-aud': '·ãµ·àù·çÇ',
                'btn-out': '·ãç·åª·ä•',
                't-ph': '·àì·â†·à¨·â≥ ·àù·àç·å£·çç',
                't-vh': '·àì·â†·à¨·â≥ ·àù·à≠·ä£·ã≠',
                't-bh': '·â¢·ãù·äê·àµ ·àõ·ä•·ä®·àç',
                't-prof': '·äì·ã≠ ·â•·àï·â≤ ·àõ·ä•·ä®·àç',
                'nav-h': 'Home',
                'nav-l': 'Live',
                'nav-p': 'Profile',
                'btn-policy': '·çñ·àä·à≤',
                'btn-next': '·âÄ·åª·àä',
                'btn-confirm': '·ä†·à®·åã·åç·åΩ',
                'btn-login': '·ä•·â∞·ãç',
                'pass-req': '·çì·àµ·ãà·à≠·ãµ ·ã®·ãµ·àä',
                'disclaimer-title': '·àò·å†·äï·âÄ·âï·â≥',
                'perfect-header-title': '·âµ·ä≠·ä≠·àà·äõ ·çê·à≠·çå·ä≠·âµ ·àì·â†·à¨·â≥ (Free)',
                'btn-bd': '·ä£·âÄ·àù·å•',
                'btn-b-exch': '·âÄ·ã≠·à≠',
                'btn-bw': '·ä£·ãç·åΩ·ä•',
                'btn-bi': '·ãì·àà·àù ·àà·ä∏ ·ãï·ã≥·åã',
                't-dep-h': '·ä£·âÄ·àù·å•',
                't-with-h': '·ä£·ãç·åΩ·ä•',
                't-intl-h': '·ãì·àà·àù ·àà·ä∏ ·ãï·ã≥·åã',
                'txt-processing': '·ã≠·à∞·à≠·àï ·ä£·àé...'
            },
            'fr': {
                'head-txt': 'Bienvenue au centre de service Fasil Web App!',
                't-w-s': 'Bienvenue',
                't-in': 'Ceci est Fasil Web App, une plateforme de partage d\'informations.',
                't-p-s': 'Politique Stricte',
                't-po': 'La politique, les discours de haine et les fausses nouvelles sont interdits.',
                'btn-agree': 'J\'accepte',
                'btn-disagree': 'Je refuse',
                't-thx': 'Merci de nous avoir choisis! Inscrivez-vous si vous √™tes nouveau.',
                'btn-sh-s': 'S\'inscrire',
                'btn-sh-l': 'Se connecter',
                'h-s': 'Inscription (Nouveau)',
                'h-l': 'Connexion (Existant)',
                't-d': 'Tableau de bord',
                'btn-dash-rewards': 'Recevoir Paye/Points',
                'btn-fc': 'Centre de Service Gratuit',
                'btn-pc': 'Service Premium Payant',
                'btn-lv': 'Voir Info',
                'btn-lp': 'Poster Info',
                'btn-perf-free': 'Info Parfaite (Gratuit)',
                'btn-lg': 'Cr√©er Groupe',
                'btn-lmg': 'Voir Mes Groupes',
                'btn-lc': 'Chat',
                'btn-lf': 'Feedback',
                'btn-lu': 'Utilisateurs',
                'btn-lb': 'Affaires',
                'btn-prem-vid': 'Vid√©o Haute Qualit√©',
                'btn-prem-news': 'Nouvelles (Haute Qualit√©)',
                'btn-prem-img': 'Image (Haute Qualit√©)',
                'btn-pp': 'PowerPoint',
                'btn-ppdf': 'PDF',
                'btn-perf-paid': 'Info Parfaite (Payant)',
                'btn-view-change-rate': 'Voir Taux de Change',
                'btn-rew-exchange': '√âchanger',
                'btn-rew-collect': 'Collecter Points',
                'btn-rew-redeem': 'Utiliser',
                'btn-rew-withdraw': 'Retirer',
                'btn-share-ref': 'Partager avec des amis',
                'btn-copy-link': 'Copier Lien',
                'ref-desc': 'Partagez Fasil Web App sur les r√©seaux sociaux.',
                'txt-disclaimer-msg': 'Les informations ici sont post√©es librement par les utilisateurs.',
                'btn-view-confirm': 'Voir',
                'btn-view-cancel': 'Annuler',
                'txt-perf-desc': 'Vous trouverez ici des informations r√©elles.',
                'btn-pi-txt': 'Texte',
                'btn-pi-img': 'Image',
                'btn-pi-vid': 'Vid√©o',
                'btn-pi-aud': 'Audio',
                'btn-out': 'Sortir',
                't-ph': 'Poster Info',
                't-vh': 'Voir Info',
                't-bh': 'Centre d\'Affaires',
                't-prof': 'Profil',
                'nav-h': 'Accueil',
                'nav-l': 'Live',
                'nav-p': 'Profil',
                'btn-policy': 'Politique',
                'btn-next': 'Suivant',
                'btn-confirm': 'Confirmer',
                'btn-login': 'Entrer',
                'pass-req': 'Mot de passe requis',
                'disclaimer-title': 'Avertissement',
                'perfect-header-title': 'Info Parfaite (Gratuit)',
                'btn-bd': 'D√©p√¥t',
                'btn-b-exch': '√âchange',
                'btn-bw': 'Retrait',
                'btn-bi': 'Achat Intl',
                't-dep-h': 'D√©p√¥t',
                't-with-h': 'Retrait',
                't-intl-h': 'Achat Intl',
                'txt-processing': 'Traitement...'
            },
            'ch': {
                'head-txt': 'Ê¨¢ËøéÊù•Âà∞ Fasil Web App ÊúçÂä°‰∏≠ÂøÉ!',
                't-w-s': 'Ê¨¢Ëøé',
                't-in': 'ËøôÊòØ Fasil Web AppÔºå‰∏Ä‰∏™Êï∞Â≠ó‰ø°ÊÅØÂÖ±‰∫´Âπ≥Âè∞„ÄÇ',
                't-p-s': '‰∏•Ê†ºÊîøÁ≠ñ',
                't-po': '‰∏•Á¶ÅÊîøÊ≤ª„ÄÅ‰ªáÊÅ®Ë®ÄËÆ∫„ÄÅÁßçÊóè‰∏ª‰πâÂíåÂÅáÊñ∞Èóª„ÄÇ',
                'btn-agree': 'ÊàëÂêåÊÑè',
                'btn-disagree': 'Êàë‰∏çÂêåÊÑè',
                't-thx': 'ÊÑüË∞¢ÈÄâÊã©Êàë‰ª¨ÔºÅÂ¶ÇÊûúÊòØÊñ∞Áî®Êà∑ËØ∑Ê≥®ÂÜå„ÄÇ',
                'btn-sh-s': 'Ê≥®ÂÜå',
                'btn-sh-l': 'ÁôªÂΩï',
                'h-s': 'Ê≥®ÂÜå (Êñ∞Áî®Êà∑)',
                'h-l': 'ÁôªÂΩï (Áé∞ÊúâÁî®Êà∑)',
                't-d': '‰ª™Ë°®Êùø',
                'btn-dash-rewards': 'Êé•Êî∂‰ªòÊ¨æ/ÁßØÂàÜ',
                'btn-fc': 'ÂÖçË¥πÊúçÂä°‰∏≠ÂøÉ',
                'btn-pc': 'È´òÁ∫ß‰ªòË¥πÊúçÂä°',
                'btn-lv': 'Êü•Áúã‰ø°ÊÅØ',
                'btn-lp': 'ÂèëÂ∏É‰ø°ÊÅØ',
                'btn-perf-free': 'ÁúüÂÆûÂÆåÁæé‰ø°ÊÅØ (ÂÖçË¥π)',
                'btn-lg': 'ÂàõÂª∫Áæ§ÁªÑ',
                'btn-lmg': 'Êü•ÁúãÊàëÁöÑÁæ§ÁªÑ',
                'btn-lc': 'ËÅäÂ§©',
                'btn-lf': 'ÂèçÈ¶à',
                'btn-lu': 'Áî®Êà∑',
                'btn-lb': 'ÂïÜ‰∏ö',
                'btn-prem-vid': 'È´òË¥®ÈáèËßÜÈ¢ë',
                'btn-prem-news': 'Êñ∞Èóª (È´òË¥®Èáè)',
                'btn-prem-img': 'ÂõæÁâá (È´òË¥®Èáè)',
                'btn-pp': 'PowerPoint',
                'btn-ppdf': 'PDF',
                'btn-perf-paid': 'ÂÆåÁæé‰ø°ÊÅØ (‰ªòË¥π)',
                'btn-view-change-rate': 'Êü•ÁúãÊ±áÁéá',
                'btn-rew-exchange': 'ÂÖëÊç¢',
                'btn-rew-collect': 'Êî∂ÈõÜÁßØÂàÜ',
                'btn-rew-redeem': '‰ΩøÁî®',
                'btn-rew-withdraw': 'ÂèñÊ¨æ',
                'btn-share-ref': 'ÂàÜ‰∫´ÁªôÊúãÂèã',
                'btn-copy-link': 'Â§çÂà∂ÈìæÊé•',
                'ref-desc': 'Âú®Á§æ‰∫§Â™í‰Ωì‰∏äÂàÜ‰∫´ Fasil Web App„ÄÇ',
                'txt-disclaimer-msg': 'ËøôÈáåÁöÑ‰ø°ÊÅØÁî±Áî®Êà∑Ëá™Áî±ÂèëÂ∏É„ÄÇ',
                'btn-view-confirm': 'Êü•Áúã',
                'btn-view-cancel': 'ÂèñÊ∂à',
                'txt-perf-desc': '‰Ω†‰ºöÂú®ËøôÈáåÊâæÂà∞ÁúüÂÆûÁöÑ‰ø°ÊÅØ„ÄÇ',
                'btn-pi-txt': 'ÊñáÊú¨',
                'btn-pi-img': 'ÂõæÂÉè',
                'btn-pi-vid': 'ËßÜÈ¢ë',
                'btn-pi-aud': 'Èü≥È¢ë',
                'btn-out': 'ÈÄÄÂá∫',
                't-ph': 'ÂèëÂ∏É‰ø°ÊÅØ',
                't-vh': 'Êü•Áúã‰ø°ÊÅØ',
                't-bh': 'ÂïÜ‰∏ö‰∏≠ÂøÉ',
                't-prof': '‰∏™‰∫∫‰∏≠ÂøÉ',
                'nav-h': 'È¶ñÈ°µ',
                'nav-l': 'Áõ¥Êí≠',
                'nav-p': 'ÁÆÄ‰ªã',
                'btn-policy': 'ÊîøÁ≠ñ',
                'btn-next': '‰∏ã‰∏ÄÊ≠•',
                'btn-confirm': 'Á°ÆËÆ§',
                'btn-login': 'ÁôªÂΩï',
                'pass-req': 'ÈúÄË¶ÅÂØÜÁ†Å',
                'disclaimer-title': 'ÂÖçË¥£Â£∞Êòé',
                'perfect-header-title': 'ÁúüÂÆûÂÆåÁæé‰ø°ÊÅØ (ÂÖçË¥π)',
                'btn-bd': 'Â≠òÊ¨æ',
                'btn-b-exch': 'ÂÖëÊç¢ & Êü•Áúã',
                'btn-bw': 'ÂèñÊ¨æ',
                'btn-bi': 'ÂõΩÈôÖË¥≠‰π∞',
                't-dep-h': 'Â≠òÊ¨æ',
                't-with-h': 'ÂèñÊ¨æ',
                't-intl-h': 'ÂõΩÈôÖË¥≠‰π∞',
                'txt-processing': 'Â§ÑÁêÜ‰∏≠...'
            }
        };

        function openLangModal() {
            document.getElementById('lang-modal').style.display = 'flex';
        }
        
        function setLang(l) {
            lang = l;
            document.getElementById('lang-modal').style.display = 'none';
            document.getElementById('lang-btn-txt').innerText = 
                l === 'am' ? 'Language' : 
                (l === 'en' ? 'English' : 
                (l === 'or' ? 'Oromiffa' : 
                (l === 'tg' ? 'Tigrinya' : 
                (l === 'fr' ? 'Fran√ßais' : '‰∏≠Êñá'))));
            
            toggleLanguage();
        }
        
        function getTrans(key) {
            return (translations[lang] && translations[lang][key]) ? translations[lang][key] : key; 
        }

        function toggleLanguage() {
            const t = translations[lang];
            if(!t) return;
            for (const key in t) {
                const el = document.getElementById(key);
                if(el) el.innerText = t[key];
            }
        }

        // --- CORE FUNCTIONS ---
        function handleAgree() {
            document.getElementById('welcome-content').style.display = 'none';
            document.getElementById('auth-section').style.display = 'block';
            hasAgreed = true;
            window.scrollTo(0,0);
        }

        function handleDisagree() {
            window.close();
            alert("Application Closed (Policy Declined)");
            document.body.innerHTML = "<h1>Access Denied</h1>";
        }
        
        function showAuth(t) {
            if(t === 'signup') {
                document.getElementById('form-signup').style.display = 'block';
                document.getElementById('form-login').style.display = 'none';
            } else {
                document.getElementById('form-signup').style.display = 'none';
                document.getElementById('form-login').style.display = 'block';
            }
        }

        function preSignup() {
            const n = document.getElementById('reg-name').value;
            const p = document.getElementById('reg-phone').value;
            const e = document.getElementById('reg-email').value;
            const pass = document.getElementById('reg-pass').value;
            const ref = document.getElementById('reg-ref').value; 
            
            if(!n || !p || !e || !pass) return alert("Fill all fields");
            if(p.length !== 10 || !p.startsWith('09')) return alert("Phone must be 09... (10 digits)");
            if(users.find(u => u.phone === p)) return alert("User already exists");
            if(!e.endsWith('@gmail.com')) return alert("Email must be @gmail.com");
            if(pass.length !== 6) return alert("Password must be 6 digits");
            
            // Task 12: Generate ID logic is inside finalSignup (after verification)
            
            // Store pending data
            pendingRegData = { name: n, phone: p, email: e, password: pass, ref: ref };
            
            document.getElementById('signup-step-1').style.display = 'none';
            document.getElementById('signup-step-2').style.display = 'block';
        }

        // Task 8 & 14: Verification Logic
        function showVerificationChoice() {
            document.getElementById('verification-modal').style.display = 'flex';
        }

        function startVerification(method) {
            document.getElementById('verif-step-1').style.display = 'none';
            if(method === 'google') {
                document.getElementById('verif-step-google').style.display = 'block';
                // Trigger Firebase Auth (Simulation)
                alert("Sending SMS and Email via Firebase...");
            } else {
                document.getElementById('verif-step-admin').style.display = 'block';
                // Update status to pending admin
                alert("Please contact Admin (0951337242) to get your verification code.");
            }
        }

        function finalizeVerification(method) {
            let verified = false;
            if(method === 'google') {
                const otp = document.getElementById('verif-otp').value;
                const emailCode = document.getElementById('verif-email-code').value;
                if(otp && emailCode) verified = true; // Simulate correct check
            } else {
                const code = document.getElementById('verif-admin-code').value;
                // Simple admin code simulation, real one would check DB
                if(code === '123456') verified = true; 
            }

            if(verified) {
                document.getElementById('verification-modal').style.display = 'none';
                finalSignup(); // Proceed to create account
            } else {
                alert("Incorrect Code/s. Please try again.");
            }
        }

        async function finalSignup() {
            const { name, phone, email, password, ref } = pendingRegData;
            
            // Task 12: Generate Auto ID
            let fwaId = "FWA00001";
            if(window.firebaseTools && window.firebaseTools.generateFWAID) {
                fwaId = await window.firebaseTools.generateFWAID();
            } else {
                // Fallback for local testing
                const nextNum = users.length + 1;
                fwaId = "FWA" + String(nextNum).padStart(5, '0');
            }

            const newUser = {
                id: Date.now().toString(), // Temp ID for local, Firebase adds its own
                fwaId: fwaId,
                name: name, phone: phone, email: email, password: password,
                photo: uploadTarget || 'lion_image.jpg',
                balUSD: 0.00, balETB: 0.00, balGBP: 0.00, balEUR: 0.00, balFWA: 0.00,
                isPremium: false,
                paidServices: {}, 
                isBanned: false,
                dashLikes: 0,
                dashFollows: 0
            };
            
            // Referral Logic
            if(ref) {
                 const refUser = users.find(u => u.phone === ref);
                 if(refUser) {
                     refUser.balFWA = (refUser.balFWA || 0) + 0.14; 
                     localStorage.setItem('fg_users', JSON.stringify(users));
                     if(window.firebaseTools && refUser.id) window.firebaseTools.updateUserBalance(refUser.id, 'FWA', 0.14);
                 }
            }
            
            users.push(newUser);
            localStorage.setItem('fg_users', JSON.stringify(users));
            
            // Save to Firebase
            if(window.firebaseTools && window.firebaseTools.saveUser) {
                window.firebaseTools.saveUser(newUser);
            }
            
            alert("Congratulations! You have successfully registered on Fasil Web. (·ä•·äï·ä≥·äï ·ã∞·àµ ·ä†·àà·ãé·âµ!)");
            
            // Task 8: Redirect to Login
            showAuth('login');
            navTo('view-agreement'); // Stay on auth page
            document.getElementById('welcome-content').style.display = 'none';
            document.getElementById('auth-section').style.display = 'block';
        }

        // Referral System
        function checkReferral() {
            const urlParams = new URLSearchParams(window.location.search);
            const refId = urlParams.get('ref');
            if(refId) {
                document.getElementById('reg-ref').value = refId;
            }
        }
        
        function setupReferral() {
            document.getElementById('collect-points-modal').style.display = 'none';
            document.getElementById('referral-modal').style.display = 'flex';
        }
        
        function copyRefLink() {
            const baseUrl = window.location.href.split('?')[0]; 
            const refUrl = `${baseUrl}?ref=${user.phone}`;
            
            const tempInput = document.createElement("input");
            tempInput.value = refUrl;
            document.body.appendChild(tempInput);
            tempInput.select();
            document.execCommand("copy");
            document.body.removeChild(tempInput);
            
            alert("Link Copied! (·àä·äï·ä© ·â∞·ãà·àµ·ã∑·àç)");
        }

        function doLogin() {
            const p = document.getElementById('log-phone').value;
            const pass = document.getElementById('log-pass').value;
            const u = users.find(x => x.phone === p && x.password === pass);
            
            if(u) {
                // Task 6: Check Ban
                if(u.isBanned) {
                    alert("You have been banned by the Admin (·â†·ä†·ãµ·àö·äï ·â≥·åç·ã∞·ãã·àç)");
                    return;
                }
                user = u;
                // Ensure props exist
                if(user.balFWA === undefined) user.balFWA = 0;
                if(user.dashLikes === undefined) user.dashLikes = 0;
                if(user.dashFollows === undefined) user.dashFollows = 0;
                
                localStorage.setItem('fg_user', JSON.stringify(user));
                
                // Task 12: Show ID
                if(user.fwaId) document.getElementById('header-fwa-id').innerText = user.fwaId;
                
                navToHome();
            } else {
                alert("Invalid Credentials");
            }
        }

        function doLogout() {
            user = null;
            localStorage.removeItem('fg_user');
            location.reload();
        }

        function navToHome() {
            document.getElementById('view-agreement').classList.remove('show');
            showView('view-home');
            upBal();
            renderNotifications();
            updateDashStats(); 
            // Task 1: Check Admin Visibility
            const adminBtn = document.getElementById('btn-admin-rep');
            if(user && user.phone === '0951337242') {
                adminBtn.style.display = 'block';
            } else {
                adminBtn.style.display = 'none';
            }
            updatePremBtnLabels();
        }

        // --- NAVIGATION & UI ---
        function checkGlobalLock(action, param) {
             // Exception for Super Admin
             if(user && user.phone === '0951337242') {
                 // Pass
             } else if(globalLock === 'lock') {
                 alert("·ä†·çï·ã¥·âµ ·àã·ã≠ ·àµ·àà·àÜ·äê ·â†·ä†·ãµ·àö·äï ·â∞·âÜ·àç·çè·àç ·ä•·àµ·ä®·àö·ä®·çà·âµ ·â†·âµ·ä•·åç·àµ·âµ ·ã≠·å†·â•·âÅ·äï ·ä•·äì·àò·à∞·åç·äì·àà·äï");
                 return;
             }
             
             if(action === 'toggleList') toggleList(param);
             else if(action === 'checkViewInfoDisclaimer') checkViewInfoDisclaimer();
             else if(action === 'navTo') navTo(param);
             else if(action === 'handleGroupCreate') handleGroupCreate();
             else if(action === 'showMyGroups') showMyGroups();
             else if(action === 'handleChatList') handleChatList();
             else if(action === 'showUserList') showUserList(param);
             else if(action === 'handleLiveList') handleLiveList();
             else if(action === 'openRewards') openRewards(); 
        }

        function toggleList(t) {
            if(t === 'free') {
                document.getElementById('list-prem').style.display = 'none';
            } else if (t === 'prem') {
                document.getElementById('list-free').style.display = 'none';
            }
            
            const el = document.getElementById('list-' + t);
            el.style.display = el.style.display === 'block' ? 'none' : 'block';
        }
        
        function navTo(id) {
            if(id !== 'view-home') {
                 viewHistory.push(document.querySelector('.section.show').id);
            } else {
                 viewHistory = []; 
            }
            
            document.querySelectorAll('.section').forEach(s => s.classList.remove('show'));
            document.getElementById(id).classList.add('show');
            window.scrollTo(0,0);
        }
        
        function goBack() {
            if(viewHistory.length > 0) {
                const prev = viewHistory.pop();
                document.querySelectorAll('.section').forEach(s => s.classList.remove('show'));
                document.getElementById(prev).classList.add('show');
            } else {
                navTo('view-home');
            }
        }
        
        function showView(id) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('show'));
            document.getElementById(id).classList.add('show');
            window.scrollTo(0,0);
        }

        function checkViewInfoDisclaimer() {
             document.getElementById('view-info-disclaimer').style.display = 'flex';
        }
        
        function confirmViewInfo() {
             document.getElementById('view-info-disclaimer').style.display = 'none';
             navTo('view-info');
        }

        function navTab(t) {
            if(!hasAgreed) {
                alert("Please agree to policy first.");
                return;
            }
            if(!user) {
                alert("Please Login First.");
                document.getElementById('welcome-content').style.display = 'none';
                document.getElementById('auth-section').style.display = 'block';
                navTo('view-agreement');
                return;
            }

            if(t === 'home') navTo('view-home');
            else if(t === 'live') openRealLiveStream(); 
            else if(t === 'profile') {
                document.getElementById('pass-modal').style.display = 'flex';
                pendingAct = () => {
                    document.getElementById('prof-phone').innerText = user.phone;
                    navTo('view-profile');
                };
            }
        }
        
        function closeModal() {
            document.querySelector('.modal-overlay[style*="flex"]').style.display = 'none';
        }

        function showAlert(msg, type) {
            document.getElementById('modal-title').innerText = type === 'error' ? 'Error' : 'Success';
            document.getElementById('modal-title').style.color = type === 'error' ? 'red' : 'green';
            document.getElementById('modal-msg').innerText = msg;
            document.getElementById('custom-modal').style.display = 'flex';
        }

        // --- REWARDS SYSTEM ---
        function openRewards() {
            document.getElementById('rewards-modal').style.display = 'flex';
            document.getElementById('rew-bal-fwa').innerText = user.balFWA.toFixed(2);
            document.getElementById('rew-bal-usd').innerText = user.balUSD.toFixed(2);
            document.getElementById('rew-bal-etb').innerText = user.balETB.toFixed(2); 
            
            const notifArea = document.getElementById('rewards-notif-area');
            if(rewardNotif) {
                notifArea.style.display = 'block';
                notifArea.innerText = rewardNotif;
            } else {
                notifArea.style.display = 'none';
            }
        }
        
        function viewChangeRate() {
            const r = RATES;
            alert(`Current Rates:\n1 USD = ${r.FWA} FWA\n1 USD = ${r.ETB} ETB\n1 USD = ${r.GBP} GBP\n1 USD = ${r.EUR} EUR`);
        }
        
        function showRewardsExchange() {
            document.getElementById('rew-exchange-area').style.display = 'block';
            document.getElementById('rew-redeem-area').style.display = 'none';
            document.getElementById('rew-withdraw-area').style.display = 'none';
        }
        
        function showRewardsRedeem() {
            document.getElementById('rew-exchange-area').style.display = 'none';
            document.getElementById('rew-redeem-area').style.display = 'block';
            document.getElementById('rew-withdraw-area').style.display = 'none';
        }
        
        function showRewardsWithdraw() {
            document.getElementById('rew-exchange-area').style.display = 'none';
            document.getElementById('rew-redeem-area').style.display = 'none';
            document.getElementById('rew-withdraw-area').style.display = 'block';
        }
        
        function requestWithdrawal(type) {
            const existing = withdrawRequests.find(r => r.user === user.phone && r.status === 'pending');
            if(existing) {
                return alert("You have a pending withdrawal request. Please wait.");
            }
            
            document.getElementById('with-curr').innerText = type;
            document.getElementById('withdraw-input-modal').style.display = 'flex';
        }
        
        function toggleWithMethodInput() {
             const m = document.getElementById('with-method-select').value;
             document.getElementById('with-acc-input').placeholder = m === 'Telebirr' ? '09... (10 digits)' : (m === 'Crypto' ? 'USDT Address' : 'Account/Email');
        }
        
        function submitWithdrawRequest() {
            const type = document.getElementById('with-curr').innerText;
            const amt = parseFloat(document.getElementById('with-amt-req').value);
            const method = document.getElementById('with-method-select').value;
            const acc = document.getElementById('with-acc-input').value;
            
            if(!amt || amt <= 0) return alert("Invalid Amount");
            if(!acc) return alert("Account required");
            
            // Check Balance
            if(type === 'ETB' && user.balETB < amt) return alert("Insufficient ETB Balance");
            if(type === 'USDT' && user.balUSD < amt) return alert("Insufficient USD Balance for USDT");

            withdrawRequests.push({
                id: Date.now(),
                user: user.phone,
                userName: user.name,
                type: type,
                amount: amt,
                method: method,
                account: acc,
                status: 'pending',
                date: new Date().toLocaleString()
            });
            localStorage.setItem('fg_withdraw_requests', JSON.stringify(withdrawRequests));
            
            alert(`Withdrawal Request for ${amt} ${type} Submitted.`);
            document.getElementById('withdraw-input-modal').style.display = 'none';
        }
        
        function showCollectPoints() {
            document.getElementById('rewards-modal').style.display = 'none';
            document.getElementById('collect-points-modal').style.display = 'flex';
        }
        
        function showTransferFWA() {
            document.getElementById('collect-points-modal').style.display = 'none';
            showUserList('fwa-transfer'); 
        }
        
        function selectUserForTransfer(phone, name) {
            const amt = prompt(`Send FWA to ${name}.\nEnter Amount:`);
            if(!amt || isNaN(amt) || amt <= 0) return alert("Invalid Amount");
            
            const amount = parseFloat(amt);
            if(user.balFWA < amount) return alert("Insufficient FWA Balance");
            
            const rUser = users.find(u => u.phone === phone);
            if(!rUser) return alert("User not found");
            
            // Execute Transfer
            user.balFWA -= amount;
            rUser.balFWA = (rUser.balFWA || 0) + amount;
            
            if(window.firebaseTools) {
                window.firebaseTools.updateUserBalance(user.id, 'FWA', -amount);
                window.firebaseTools.updateUserBalance(rUser.id, 'FWA', amount);
            }

            localStorage.setItem('fg_user', JSON.stringify(user));
            localStorage.setItem('fg_users', JSON.stringify(users));
            upBal();
            
            alert(`Sent ${amount} FWA to ${name} successfully!`);
            goBack();
        }
        
        function doRewardExchange() {
            const type = document.getElementById('rew-conv-type').value;
            const amt = parseFloat(document.getElementById('rew-conv-amt').value);
            
            if(!amt || amt <= 0) return alert("Invalid Amount");
            
            if(type === 'FWA_USD') {
                if(user.balFWA < amt) return alert("Insufficient FWA");
                user.balFWA -= amt;
                const usdVal = amt / RATES.FWA;
                user.balUSD += usdVal;
                
                if(window.firebaseTools) {
                     window.firebaseTools.updateUserBalance(user.id, 'FWA', -amt);
                     window.firebaseTools.updateUserBalance(user.id, 'USD', usdVal);
                }
            } else {
                if(user.balUSD < amt) return alert("Insufficient USD");
                user.balUSD -= amt;
                const fwaVal = amt * RATES.FWA;
                user.balFWA += fwaVal;
                
                 if(window.firebaseTools) {
                     window.firebaseTools.updateUserBalance(user.id, 'USD', -amt);
                     window.firebaseTools.updateUserBalance(user.id, 'FWA', fwaVal);
                }
            }
            
            upBal();
            openRewards(); 
        }
        
        function redeemPoints(currency) {
            const conf = confirm("Cannot Withdraw. This is for in-app services only.");
            if(conf) {
                document.getElementById('rewards-modal').style.display = 'none';
                navTo('list-prem'); 
                alert("Redirecting to Services...");
                toggleList('prem'); 
            }
        }
        
        // Watch Rewards
        let watchMode = 'free'; 
        
        function setupWatchFree() {
            watchMode = 'free';
            document.getElementById('collect-points-modal').style.display = 'none';
            document.getElementById('watch-reward-msg').innerText = "Watch Free Perfect Info to earn points.";
            document.getElementById('watch-reward-modal').style.display = 'flex';
        }
        
        function setupWatchPrem() {
            if(!user.isPremium && user.phone !== '0951337242') {
                return alert("Premium Users Only. Please Pay first.");
            }
            watchMode = 'prem';
            document.getElementById('collect-points-modal').style.display = 'none';
            document.getElementById('watch-reward-msg').innerText = "Watch Premium Info to earn points.";
            document.getElementById('watch-reward-modal').style.display = 'flex';
        }
        
        function startWatchSession() {
            document.getElementById('watch-reward-modal').style.display = 'none';
            alert("Started! Go watch content.");
            navTo('view-perfect-info-free'); 
        }
        
        function startWatchTimer(type) {
             if(watchTimer) clearInterval(watchTimer);
             
             // Task 13: Check Automatic Control
             if(automaticBalanceStatus === 'closed') {
                 // Do not start timer if automatic balance is blocked
                 return;
             }
             
             let seconds = 0;
             let limit = watchMode === 'prem' ? 1800 : (type === 'video' ? 60 : 30); 
             
             watchTimer = setInterval(() => {
                 seconds++;
                 if(seconds >= limit) {
                     let pts = 0;
                     if(watchMode === 'free') {
                         if(type === 'video') pts = pointRates.video; 
                         else if(type === 'audio') pts = pointRates.audio;
                         else pts = pointRates.text;
                     } else {
                         if(type === 'video') pts = 1.0;
                         else pts = 0.5;
                     }
                     
                     user.balFWA += pts;
                     if(window.firebaseTools && user.id) window.firebaseTools.updateUserBalance(user.id, 'FWA', pts);
                     upBal();
                     
                     const notif = document.createElement('div');
                     notif.style = "position:fixed; top:20px; left:50%; transform:translateX(-50%); background:gold; color:black; padding:5px; border-radius:5px; z-index:9000;";
                     notif.innerText = `+${pts} FWA Points Earned!`;
                     document.body.appendChild(notif);
                     setTimeout(() => notif.remove(), 2000);
                     
                     seconds = 0; 
                 }
             }, 1000);
        }

        // --- ADMIN PAY ---
        function openAdminPay() {
            document.getElementById('adm-pay-user-modal').style.display = 'flex';
        }
        
        function adminGivePay(type) {
            document.getElementById('adm-pay-user-modal').style.display = 'none';
            showUserList('admin-pay'); 
        }
        
        function adminSelectUserForPay(phone) {
            const u = users.find(x => x.phone === phone);
            if(!u) return;
            
            const amt = parseFloat(prompt(`Enter Amount for ${u.name}:`));
            if(!amt || amt <= 0) return;
            
            const curr = prompt("Enter Currency (FWA/USD/ETB):").toUpperCase();
            
            if(curr === 'FWA') u.balFWA = (u.balFWA || 0) + amt;
            else if(curr === 'USD') u.balUSD = (u.balUSD || 0) + amt;
            else if(curr === 'ETB') u.balETB = (u.balETB || 0) + amt;
            else return alert("Invalid Currency");
            
            localStorage.setItem('fg_users', JSON.stringify(users));
            if(window.firebaseTools && u.id) window.firebaseTools.updateUserBalance(u.id, curr, amt);
            
            alert(`Sent ${amt} ${curr} to ${u.name}`);
            goBack();
        }
        
        function adminRewardNotif(action) {
            if(action === 'send') {
                const txt = prompt("Enter Notification Text:");
                if(txt) {
                    rewardNotif = txt;
                    localStorage.setItem('fg_rew_notif', txt);
                    alert("Notification Sent");
                }
            } else {
                rewardNotif = '';
                localStorage.setItem('fg_rew_notif', '');
                alert("Notification Deleted");
            }
            document.getElementById('adm-pay-user-modal').style.display = 'none';
        }

        // --- POST SYSTEM ---
        function clearPostForm() {
            document.getElementById('p-title').value = '';
            document.getElementById('p-content').value = '';
            document.getElementById('file-post').value = '';
        }
        
        function setupPost(t) { 
            activePostType = t; 
            if(t !== 'text') {
                let i = document.getElementById('file-post');
                if(t === 'image') i.accept = 'image/*'; 
                if(t === 'video') i.accept = 'video/*'; 
                if(t === 'audio') i.accept = 'audio/*';
                promptUpload('post');
            } else {
                document.getElementById('post-form-area').style.display = 'block'; 
                document.getElementById('post-type-select').style.display = 'none';
                document.getElementById('p-content').style.display = 'block'; 
                document.getElementById('post-instr').textContent = "Title + Content Required";
            }
        }

        // Task 4: Fast Post with Progress Bar to 100 then load view
        async function submitPost() {
            const t = document.getElementById('p-title').value; 
            const c = document.getElementById('p-content').value;
            
            if(!t) return showAlert("Title required", "error");
            if(activePostType === 'text' && !c) return showAlert("Content required", "error");
            
            const forbidden = ['politics', 'hate', 'war', 'racism', '·çñ·àà·â≤·ä´', '·ãò·à®·äù·äê·âµ', '·å¶·à≠·äê·âµ'];
            if(forbidden.some(w => (t + ' ' + c).toLowerCase().includes(w))) {
                return showAlert("Policy Violation", "error");
            }

            showLoading("Uploading...");
            const pBar = document.getElementById('upload-progress-bar');
            let progress = 0;
            const interval = setInterval(() => {
                progress += 10;
                pBar.style.width = progress + '%';
                pBar.innerText = progress + '%';
                if(progress >= 100) {
                    clearInterval(interval);
                    finalizePostSubmit(t, c);
                }
            }, 100); 
        }
        
        async function finalizePostSubmit(t, c) {
             const savePostData = async (d) => {
                const postData = {
                    t, c, d, 
                    type: activePostType, 
                    u: user.name, 
                    uid: user.phone, 
                    photo: user.photo || '', 
                    likes: 0, follows: 0, 
                    isHidden: false, comments: [],
                    timestamp: new Date()
                };
                
                if(window.firebaseTools && window.firebaseTools.savePost) {
                    const result = await window.firebaseTools.savePost(postData);
                    hideLoading(); 
                    if(result.success) {
                        posts.unshift({ id: result.id, ...postData });
                        localStorage.setItem('fg_posts', JSON.stringify(posts));
                        clearPostForm();
                        document.getElementById('post-form-area').style.display = 'none'; 
                        document.getElementById('post-type-select').style.display = 'block';
                        renderPosts(activePostType); 
                        navTo('view-info'); 
                        return;
                    }
                }
                hideLoading();
                posts.unshift({ id: Date.now(), ...postData });
                localStorage.setItem('fg_posts', JSON.stringify(posts));
                clearPostForm();
                document.getElementById('post-form-area').style.display = 'none'; 
                document.getElementById('post-type-select').style.display = 'block';
                renderPosts(activePostType); 
                navTo('view-info'); 
            };
            
            if(activePostType !== 'text') { 
                const f = document.getElementById('file-post').files[0]; 
                if(f) { 
                    const r = new FileReader(); 
                    r.onload = async e => { await savePostData(e.target.result); }; 
                    r.readAsDataURL(f); 
                } else { await savePostData(null); }
            } else { await savePostData(null); }
        }

        async function renderPosts(type) {
            const c = document.getElementById('feed-container'); 
            c.innerHTML = '<p style="color:#007bff;">üî• ·çñ·àµ·â∂·âΩ ·â†·àò·å´·äï ·àã·ã≠...</p>';
            
            if(posts.length === 0 && window.firebaseTools) {
                const firebasePosts = await window.firebaseTools.getPosts();
                if(firebasePosts.length > 0) {
                    posts = firebasePosts.filter(p => !deletedPostIds.includes(p.id));
                    localStorage.setItem('fg_posts', JSON.stringify(posts));
                }
            }
            
            const fs = posts.filter(p => p.type === type && !p.isHidden);
            
            if(!fs.length) {
                c.innerHTML = '<p>No Posts Here.</p>';
                return;
            }
            
            c.innerHTML = '';
            fs.forEach(p => {
                let m = ''; 
                if(p.d) { 
                    if(p.type === 'image') m = `<img src="${p.d}" width="100%" loading="lazy" style="max-height:300px;object-fit:contain;">`; 
                    else if(p.type === 'video') m = `<video src="${p.d}" controls playsinline preload="metadata" width="100%" style="max-height:300px;"></video>`; 
                    else m = `<audio src="${p.d}" controls preload="metadata"></audio>`; 
                }
                
                let delHtml = '';
                if(p.uid === user.phone || user.phone === '0951337242') {
                     delHtml = `<button class="action-icon" style="color:red;" onclick="tryDelete('${p.id || p.uid}', '${p.uid}')">Delete</button>`;
                } else {
                     delHtml = `<button class="action-icon" style="color:gray;" onclick="alert('Not your post')">Delete</button>`;
                }
                
                let downloadBtn = '';
                if(p.d) downloadBtn = `<button class="action-icon" onclick="downloadMedia('${p.d}', '${p.type}')">Download</button>`;
                else if (p.type === 'text') downloadBtn = `<button class="action-icon" onclick="downloadText('${p.t}', '${p.c}')">Download</button>`;
                
                const firebaseIcon = p.id && p.id.length > 15 ? ' üî•' : ' üì±';
                
                // Task 2: Like/Follow Green Color
                c.innerHTML += `<div class="post-card">
                    <div class="post-header">
                        <img src="${p.photo || 'lion_image.jpg'}"> 
                        <b>${p.u}</b>
                        <span style="font-size:10px;color:#888;margin-left:auto;">${firebaseIcon}</span>
                    </div>
                    <h4>${p.t}</h4>
                    <p>${p.c || ''}</p>
                    ${m}
                    <div class="post-actions">
                        <button class="action-icon" style="color:green;" onclick="likePost('${p.id || p.uid}', this, '${p.uid}')"><i class="fas fa-heart"></i> Like ${p.likes || 0}</button>
                        <button class="action-icon" onclick="openComModal('${p.id || p.uid}')">Comment</button>
                        ${downloadBtn}
                        <button class="action-icon" onclick="sharePost('${p.t}')">Share</button>
                        <button class="action-icon" onclick="promptReport('${p.id || p.uid}', '${p.u}')">Report</button>
                        <button class="action-icon" style="color:green;" onclick="followUser('${p.id || p.uid}', this, '${p.uid}')"><i class="fas fa-user-plus"></i> Follow ${p.follows || 0}</button>
                        ${delHtml}
                    </div>
                </div>`;
            });
        }
        
        function downloadMedia(url, type) {
            const a = document.createElement('a');
            a.href = url;
            a.download = `fasil_download_${Date.now()}.${type === 'image' ? 'jpg' : (type === 'video' ? 'mp4' : 'mp3')}`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        function downloadText(title, content) {
            const element = document.createElement('a');
            const file = new Blob([`Title: ${title}\n\n${content}`], {type: 'text/plain'});
            element.href = URL.createObjectURL(file);
            element.download = "post.txt";
            document.body.appendChild(element);
            element.click();
            document.body.removeChild(element);
        }

        function tryDelete(id, uid) { 
            if(uid === user.phone || user.phone === '0951337242') { 
                deletedPostIds.push(id);
                localStorage.setItem('fg_deleted_posts', JSON.stringify(deletedPostIds));
                posts = posts.filter(p => (p.id || p.uid) !== id); 
                localStorage.setItem('fg_posts', JSON.stringify(posts)); 
                showAlert('Deleted Permanently', 'success'); 
                renderPosts(activePostType); 
            }
        }
        
        // Task 2: Like Logic Update (Multi Like, Self Check)
        async function likePost(id, btn, ownerUid) { 
            if(ownerUid === user.phone) return alert("You cannot like your own post.");
            
            const p = posts.find(x => (x.id || x.uid) === id); 
            if(p) {
                p.likes = (p.likes || 0) + 1; 
                localStorage.setItem('fg_posts', JSON.stringify(posts)); 
                btn.innerHTML = `<i class="fas fa-heart"></i> Like ${p.likes}`; 
                
                checkAutoReward(p.uid, 'like', p.likes);
                
                if(window.firebaseTools && p.id && p.id.length > 5) {
                    await window.firebaseTools.updatePostStats(p.id, { likes: p.likes });
                }
            }
        }
        
        // Task 2: Follow Logic (One time, Self check)
        async function followUser(id, btn, ownerUid) { 
            if(ownerUid === user.phone) return alert("You cannot follow yourself.");
            if(btn.disabled || btn.innerText.includes("Followed")) return alert("Already Followed");

            const p = posts.find(x => (x.id || x.uid) === id); 
            if(p) {
                p.follows = (p.follows || 0) + 1; 
                localStorage.setItem('fg_posts', JSON.stringify(posts)); 
                btn.innerHTML = `<i class="fas fa-check"></i> Followed ${p.follows}`; 
                btn.disabled = true; 
                
                checkAutoReward(p.uid, 'follow', p.follows);

                if(window.firebaseTools && p.id && p.id.length > 5) {
                    await window.firebaseTools.updatePostStats(p.id, { follows: p.follows });
                }
            }
        }
        
        function dashboardAction(type) {
            if(type === 'like') {
                if(user.dashLikes === 0) {
                    user.dashLikes = 1;
                    localStorage.setItem('fg_user', JSON.stringify(user));
                    updateDashStats();
                    alert("You Liked Fasil Web App!");
                } else {
                    alert("You already liked it!");
                }
            } else {
                if(user.dashFollows === 0) {
                    user.dashFollows = 1;
                    localStorage.setItem('fg_user', JSON.stringify(user));
                    updateDashStats();
                    alert("You Followed Fasil Web App!");
                } else {
                    alert("You already followed!");
                }
            }
        }
        
        function updateDashStats() {
            document.getElementById('dash-like-count').innerText = user.dashLikes || 0;
            document.getElementById('dash-follow-count').innerText = user.dashFollows || 0;
            
            if(user.dashLikes > 0) document.getElementById('dash-like-btn').classList.add('active');
            if(user.dashFollows > 0) document.getElementById('dash-follow-btn').classList.add('active');
        }
        
        function checkAutoReward(ownerPhone, type, currentCount) {
             const setting = rewardSettings[type];
             if(!setting) return;
             if(currentCount > 0 && currentCount % setting.count === 0) {
                 const owner = users.find(u => u.phone === ownerPhone);
                 if(owner) {
                     if(setting.currency === 'ETB') owner.balETB = (owner.balETB || 0) + setting.amount;
                     else if(setting.currency === 'FWA') owner.balFWA = (owner.balFWA || 0) + setting.amount;
                     else if(setting.currency === 'USDT') owner.balUSD = (owner.balUSD || 0) + setting.amount;
                     
                     localStorage.setItem('fg_users', JSON.stringify(users));
                     if(window.firebaseTools && owner.id) window.firebaseTools.updateUserBalance(owner.id, setting.currency, setting.amount);
                 }
             }
        }
        
        // Comment System
        function openComModal(id) { 
            activeCommentPostId = id; 
            document.getElementById('comment-type-modal').style.display = 'flex'; 
        }
        
        function openComSub(mode) { 
            comMode = mode; 
            document.getElementById('comment-type-modal').style.display = 'none'; 
            document.getElementById('comment-media-modal').style.display = 'flex';
        }
        
        function processComment(type) {
            document.getElementById('comment-media-modal').style.display = 'none';
            if(comMode === 'give') {
                if(type === 'text') {
                    const txt = prompt("Comment:");
                    if(!txt) return showAlert("Empty", "error");
                    saveComment(activeCommentPostId, type, txt);
                } else {
                    activePostType = type; 
                    const inp = document.getElementById('comment-file-input');
                    inp.accept = type + '/*';
                    inp.click();
                }
            } else {
                const p = posts.find(x => (x.id || x.uid) === activeCommentPostId);
                const coms = (p?.comments || []).filter(c => c.type === type);
                const disp = document.getElementById('comments-display-area');
                if(coms.length === 0) disp.innerHTML = "No Comments";
                else disp.innerHTML = coms.map(c => {
                    let content = c.txt;
                    if(c.type === 'image') content = `<img src="${c.txt}" width="100%" loading="lazy">`;
                    else if(c.type === 'video') content = `<video src="${c.txt}" controls width="100%"></video>`;
                    return `<div><b>${c.u}:</b> <br> ${content}</div><hr>`;
                }).join('');
                document.getElementById('view-comments-list-modal').style.display = 'flex';
            }
        }
        
        function saveComment(pid, type, txt) {
            const p = posts.find(x => (x.id || x.uid) === pid);
            if(!p) return;
            if(!p.comments) p.comments = [];
            p.comments.push({ u: user.name, type, txt });
            localStorage.setItem('fg_posts', JSON.stringify(posts));
            showAlert("Comment Sent", "success");
        }
        
        function sharePost(txt) {
            document.getElementById('share-modal').style.display = 'flex';
        }
        
        function shareTo(platform) {
            const txt = "Check this post on Fasil Web App!";
            let url = "";
            if(platform === 'telegram') url = `https://telegram.me/share/url?url=&text=${txt}`;
            if(platform === 'facebook') url = `https://www.facebook.com/sharer/sharer.php?u=&quote=${txt}`;
            if(platform === 'tiktok') url = `https://www.tiktok.com/`;
            if(platform === 'youtube') url = `https://www.youtube.com/`;
            window.open(url, '_blank');
            closeShare();
            if(watchMode === 'free' || watchMode === 'prem') {
                user.balFWA += pointRates.share;
                upBal();
            }
        }
        
        function closeShare() {
            document.getElementById('share-modal').style.display = 'none';
        }

        function promptUpload(target) {
            uploadTarget = target; 
            if(target === 'profile' || target === 'profile-edit') {
                document.getElementById(target === 'profile' ? 'file-profile' : 'file-profile-edit').click();
            } else if(target === 'deposit') {
                document.getElementById('file-deposit').click();
            } else if(target === 'pay') {
                document.getElementById('file-pay').click();
            } else if(target === 'pay-intl') {
                document.getElementById('file-pay-intl').click();
            } else if(target === 'intl') {
                document.getElementById('file-intl').click();
            } else if(target.startsWith('chat')) {
                alert("Media attached");
            } else if(target === 'post') {
                 document.getElementById('file-post').click();
                 document.getElementById('file-post').onchange = () => {
                     document.getElementById('post-form-area').style.display = 'block'; 
                     document.getElementById('post-type-select').style.display = 'none';
                 }
            }
        }
        
        document.getElementById('file-deposit').onchange = function() {
            document.getElementById('receipt-modal').style.display = 'flex';
        };
        document.getElementById('file-intl').onchange = function() {
            deductIntlPay();
            showAlert("Receipt Uploaded.", "success");
            document.getElementById('intl-list').style.display = 'none';
        };

        function downloadReceipt() {
            alert("Receipt saved to gallery.");
        }
        
        function closeReceiptModal() {
            finalizeDeposit(); 
        }
        
        function promptReport(id, uname) { 
            document.getElementById('report-modal').style.display = 'flex';
            pendingReportId = {id, uname};
        }
        
        function submitReport() {
            const r = document.getElementById('report-reason').value;
            if(r && pendingReportId) {
                const p = posts.find(x => (x.id || x.uid) === pendingReportId.id);
                reports.push({
                    id: pendingReportId.id, reason: r, 
                    reporter: user.name, 
                    reporterPhoto: user.photo, 
                    target: pendingReportId.uname, 
                    postContent: p ? p.t : ''
                }); 
                localStorage.setItem('fg_reports', JSON.stringify(reports)); 
                showAlert("Reported", "success");
                document.getElementById('report-modal').style.display = 'none';
            }
        }

        // --- ADMIN SYSTEM ---
        function checkAuth(targetId) {
            if(targetId === 'report-inbox' || targetId === 'business-sec') {
                document.getElementById('pass-modal').style.display = 'flex';
                pendingAct = () => {
                    if (targetId === 'report-inbox') {
                        document.getElementById('admin-login-modal').style.display = 'flex';
                    } else {
                        if(user && user.phone === '0951337242') {
                            navTo(targetId); 
                        } else if(bizStatus === 'closed') {
                            alert("Closed for maintenance.");
                        } else {
                            navTo(targetId);
                        }
                    }
                };
            } else {
                navTo(targetId);
            }
        }
        
        function adminLogin() {
            const c = document.getElementById('admin-pass-in').value;
            if(c === adminPass) {
                document.getElementById('admin-login-modal').style.display = 'none';
                document.getElementById('admin-pass-in').value = '';
                navTo('report-inbox');
                runAdminAction(); 
            } else {
                alert("Invalid Code");
            }
        }
        
        function promptAdminAction(action) {
            pendingAdminAction = action;
            if(action === 'ctrlBiz') {
                document.getElementById('adm-biz-ctrl-modal').style.display = 'flex';
            } else if (action === 'ctrlPdf') {
                document.getElementById('adm-pdf-ctrl-modal').style.display = 'flex';
            } else if (action === 'premPay') {
                document.getElementById('adm-prem-modal').style.display = 'flex';
            } else if (action === 'ctrlWithdraw') {
                document.getElementById('adm-withdraw-ctrl-modal').style.display = 'flex';
                adminViewWithdrawals();
            } else if (action === 'changePass') {
                document.getElementById('admin-chg-modal').style.display = 'flex';
            } else if (action === 'viewRep') {
                 runAdminAction();
            } else {
                document.getElementById('admin-action-modal').style.display = 'flex';
            }
        }

        function openAdminPostMenu() {
            document.getElementById('admin-post-modal').style.display = 'flex';
        }

        function setupAdminPost(type) {
            document.getElementById('admin-post-modal').style.display = 'none';
            if(type === 'live') {
                startAdminLiveStream();
            } else if (type === 'stop-live') {
                stopAdminLiveStream();
            } else {
                activePostType = type;
                document.getElementById('admin-post-form').style.display = 'flex';
                if(type === 'text') {
                    document.getElementById('adm-p-content').style.display = 'block';
                    document.getElementById('adm-up-btn').style.display = 'none';
                } else {
                    document.getElementById('adm-p-content').style.display = 'none';
                    document.getElementById('adm-up-btn').style.display = 'block';
                    document.getElementById('adm-p-file').accept = type + '/*';
                }
            }
        }
        
        function setupPremiPost(type) {
            document.getElementById('adm-premi-post-modal').style.display = 'none';
            activePostType = 'premium-' + type; 
            
            document.getElementById('admin-post-form').style.display = 'flex';
            document.getElementById('adm-p-content').style.display = 'none';
            document.getElementById('adm-up-btn').style.display = 'block';
            document.getElementById('adm-p-file').accept = (type === 'news' ? 'video/*' : type + '/*'); 
            
            document.querySelector('input[name="adm-post-target"][value="paid"]').checked = true;
        }

        function submitAdminPost() {
            const t = document.getElementById('adm-p-title').value;
            const c = document.getElementById('adm-p-content').value;
            const target = document.querySelector('input[name="adm-post-target"]:checked').value;
            
            if(!t) return alert("Title required");
            
            showLoading("Admin Post Uploading...");
            const pBar = document.getElementById('upload-progress-bar');
            let progress = 0;
            const interval = setInterval(() => {
                progress += 10;
                pBar.style.width = progress + '%';
                pBar.innerText = progress + '%';
                if(progress >= 100) {
                    clearInterval(interval);
                    processAdminPostFile(t, c, target);
                }
            }, 100);
        }

        function processAdminPostFile(t, c, target) {
            let mediaData = null;
            let finalType = activePostType;
            let subType = activePostType; 
            
            if(activePostType.startsWith('premium-')) {
                finalType = activePostType.replace('premium-', ''); 
            }
            
            if (finalType !== 'text') {
                const f = document.getElementById('adm-p-file').files[0];
                if (f) {
                    const r = new FileReader();
                    r.onload = function(e) {
                         mediaData = e.target.result;
                         saveAdminPostInternal(t, c, mediaData, target, subType);
                    };
                    r.readAsDataURL(f);
                    return; 
                } else {
                     mediaData = 'lion_image.jpg'; 
                }
            }
            saveAdminPostInternal(t, c, mediaData, target, subType);
        }
        
        function saveAdminPostInternal(t, c, mediaData, target, subType) {
            const newPost = {
                id: Date.now(),
                t, c, 
                type: subType.replace('premium-', ''), 
                d: mediaData,
                likes: 0, follows: 0,
                target: target, 
                subType: subType, 
                timestamp: new Date()
            };
            
            adminPosts.unshift(newPost);
            localStorage.setItem('fg_admin_posts', JSON.stringify(adminPosts));
            
            hideLoading();
            alert("Posted Successfully!");
            document.getElementById('admin-post-form').style.display = 'none';
            document.getElementById('adm-p-title').value = '';
            document.getElementById('adm-p-content').value = '';
            
            if(target === 'paid') {
                currentPremSubtype = subType;
                navTo('view-xfwa-info'); 
                renderAdminPosts('all', 'paid', subType);
            } else {
                navTo('view-perfect-info-free'); 
                renderAdminPosts('all', 'free');
            }
        }

        function renderAdminPosts(type, target, subTypeFilter = null) {
            currentPremSubtype = subTypeFilter; 
            const containerId = target === 'paid' ? 'xfwa-feed-container' : 'perfect-feed-container';
            const c = document.getElementById(containerId);
            
            if(target === 'free') document.getElementById('perfect-info-buttons').style.display = 'none';
            else document.getElementById('xfwa-info-buttons').style.display = 'none';
            
            startWatchTimer(type);
            
            let fs = adminPosts.filter(p => p.target === target);
            if(type !== 'all') {
                fs = fs.filter(p => p.type === type);
            }
            if(subTypeFilter) {
                fs = fs.filter(p => p.subType === 'premium-' + subTypeFilter || p.subType === subTypeFilter);
            }
            
            c.innerHTML = '';
            if(fs.length === 0) c.innerHTML = '<p>No content available.</p>';
            
            fs.forEach(p => {
                let m = '';
                if(p.type === 'image') m = `<img src="${p.d}" width="100%" loading="lazy">`;
                else if(p.type === 'video') m = `<video src="${p.d}" controls width="100%" preload="metadata"></video>`;
                else if(p.type === 'audio') m = `<audio src="${p.d}" controls preload="metadata"></audio>`;
                else if(p.subType === 'premium-news') m = `<video src="${p.d}" controls width="100%" preload="metadata"></video>`; 
                
                const delBtn = (user.phone === '0951337242') ? `<button class="action-icon" style="color:red;" onclick="deleteAdminPost('${p.id}')">Delete</button>` : '';
                const displayTitle = target === 'paid' ? 'Paid Info' : 'Perfect Info';
                const titleColor = target === 'paid' ? 'gold' : '#28a745';

                c.innerHTML += `<div class="post-card" style="border:2px solid ${titleColor}; text-align:center;">
                    <div style="text-align:center; margin-bottom:10px;">
                         ${m}
                         <h4 style="color:${titleColor};">‚úÖ ${displayTitle}: ${p.t}</h4>
                         <p>${p.c || ''}</p>
                    </div>
                    <div class="post-actions" style="justify-content:center; gap:15px;">
                        <button class="action-icon" onclick="adminPostLike('${p.id}', this)">Like ${p.likes}</button>
                        <button class="action-icon" onclick="adminPostFollow('${p.id}', this)">Follow ${p.follows}</button>
                        <button class="action-icon" onclick="sharePost('${p.t}')">Share</button>
                        <button class="action-icon" onclick="downloadMedia('${p.d || ''}', '${p.type}')">Download</button>
                        ${delBtn}
                    </div>
                </div>`;
            });
        }
        
        function resetPerfectInfoView() {
            document.getElementById('perfect-info-buttons').style.display = 'flex';
            document.getElementById('perfect-feed-container').innerHTML = '';
            if(watchTimer) clearInterval(watchTimer);
            navTo('view-home');
        }
        
        function resetXFWAView() {
            document.getElementById('xfwa-info-buttons').style.display = 'flex';
            document.getElementById('xfwa-feed-container').innerHTML = '';
            if(watchTimer) clearInterval(watchTimer);
            navTo('view-home');
        }
        
        function adminPostLike(id, btn) {
            const p = adminPosts.find(x => x.id == id);
            if(p) {
                p.likes++;
                localStorage.setItem('fg_admin_posts', JSON.stringify(adminPosts));
                btn.innerText = `Like ${p.likes}`;
            }
        }
        
        function adminPostFollow(id, btn) {
            const p = adminPosts.find(x => x.id == id);
            if(p) {
                if(!btn.disabled) {
                    p.follows++;
                    localStorage.setItem('fg_admin_posts', JSON.stringify(adminPosts));
                    btn.innerText = `Follow ${p.follows}`;
                    btn.disabled = true;
                }
            }
        }
        
        function deleteAdminPost(id) {
             if(user.phone === '0951337242') {
                 adminPosts = adminPosts.filter(p => p.id != id);
                 localStorage.setItem('fg_admin_posts', JSON.stringify(adminPosts));
                 alert("Deleted");
                 resetPerfectInfoView();
             }
        }
        
        function startAdminLiveStream() {
            adminLiveStatus = true;
            localStorage.setItem('fg_admin_live', JSON.stringify(true));
            updateAdminLiveIndicator();
            alert("Admin Live Started!");
            openRealLiveStream();
        }
        
        function stopAdminLiveStream() {
            adminLiveStatus = false;
            localStorage.setItem('fg_admin_live', JSON.stringify(false));
            updateAdminLiveIndicator();
            alert("Admin Live Stopped.");
        }

        function updateAdminLiveIndicator() {
            const ind = document.getElementById('perfect-info-indicator');
            if(ind) {
                ind.className = adminLiveStatus ? 'admin-live-active' : 'admin-live-inactive';
            }
            
            const btn = document.getElementById('btn-admin-live-watch');
            if(btn) btn.style.backgroundColor = adminLiveStatus ? '#ffc107' : '#333';
        }
        
        function joinAdminLive() {
            if(adminLiveStatus) {
                openRealLiveStream();
            } else {
                alert("Admin is not live right now.");
            }
        }

        function deletePost(id) {
             deletedPostIds.push(id);
             localStorage.setItem('fg_deleted_posts', JSON.stringify(deletedPostIds));
             posts = posts.filter(p => (p.id || p.uid) !== id);
             localStorage.setItem('fg_posts', JSON.stringify(posts));
        }

        // --- NEW ADMIN TASKS LOGIC ---
        function adminRewardSettings() {
            const fAmt = prompt("Enter Amount for 100 Follows (e.g. 1):", rewardSettings.follow.amount);
            const fCurr = prompt("Enter Currency for Follow (ETB/FWA/USDT):", rewardSettings.follow.currency);
            
            const lAmt = prompt("Enter Amount for 100 Likes (e.g. 1):", rewardSettings.like.amount);
            const lCurr = prompt("Enter Currency for Like (ETB/FWA/USDT):", rewardSettings.like.currency);
            
            if(fAmt && fCurr && lAmt && lCurr) {
                rewardSettings.follow.amount = parseFloat(fAmt);
                rewardSettings.follow.currency = fCurr.toUpperCase();
                rewardSettings.like.amount = parseFloat(lAmt);
                rewardSettings.like.currency = lCurr.toUpperCase();
                
                localStorage.setItem('fg_rew_settings', JSON.stringify(rewardSettings));
                alert("Reward Settings Updated!");
            }
        }

        function adminExchangeSettings() {
            document.getElementById('adm-rate-chg-modal').style.display = 'flex';
        }

        function adminPremiumRelease() {
            if(premiumReleaseStatus === 'hold') {
                premiumReleaseStatus = 'release';
                alert("Premium Content is now RELEASED (Free for all).");
            } else {
                premiumReleaseStatus = 'hold';
                alert("Premium Content is now HELD (Payment required).");
            }
            localStorage.setItem('fg_prem_release', premiumReleaseStatus);
        }

        checkPremAccess = function(type) {
             if(user.phone === '0951337242') {
                 if(type === 'ppt' || type === 'pdf') promptConvert(type);
                 else {
                     navTo('view-xfwa-info');
                     renderAdminPosts('all', 'paid', type);
                     document.getElementById('prem-content-title').innerText = type.toUpperCase();
                 }
                 return;
             }

             if(premiumReleaseStatus === 'release') {
                 if(type === 'ppt' || type === 'pdf') promptConvert(type);
                 else {
                     navTo('view-xfwa-info');
                     renderAdminPosts('all', 'paid', type); 
                     document.getElementById('prem-content-title').innerText = type.toUpperCase() + " (Free Event)";
                 }
                 return;
             }
             
             if(user.paidServices && user.paidServices[type]) {
                 if(type=== 'ppt' || type === 'pdf') promptConvert(type);
                 else {
                     navTo('view-xfwa-info');
                     renderAdminPosts('all', 'paid', type);
                     document.getElementById('prem-content-title').innerText = type.toUpperCase();
                 }
             } else {
                 const pending = paymentRequests.find(r => r.user === user.phone && r.service === type && r.status === 'pending');
                 if(pending) {
                     alert("Payment under verification. Please wait.");
                 } else {
                     alert("This requires Premium Payment. Redirecting to Payment...");
                     openPrem(type); 
                 }
             }
        };

        function updateControlBox(action) {
            if(action === 'send') {
                const txt = document.getElementById('ctrl-box-text').value;
                if(txt) {
                    controlBoxText = txt;
                    controlBoxVisible = 'show';
                    localStorage.setItem('fg_ctrl_box_text', controlBoxText);
                    localStorage.setItem('fg_ctrl_box_vis', controlBoxVisible);
                    alert("Box Updated & Shown");
                }
            } else if (action === 'delete') {
                controlBoxText = '';
                localStorage.setItem('fg_ctrl_box_text', '');
                alert("Text Deleted");
            } else if (action === 'hide') {
                controlBoxVisible = 'hide';
                localStorage.setItem('fg_ctrl_box_vis', 'hide');
                alert("Box Hidden");
            } else if (action === 'show') {
                controlBoxVisible = 'show';
                localStorage.setItem('fg_ctrl_box_vis', 'show');
                alert("Box Shown");
            }
            document.getElementById('adm-ctrl-box-modal').style.display = 'none';
        }

        function applyControlBox() {
            const box = document.getElementById('prem-control-box');
            if(box) {
                if(controlBoxVisible === 'show' && controlBoxText) {
                    box.style.display = 'block';
                    box.innerText = controlBoxText;
                } else {
                    box.style.display = 'none';
                }
            }
        }

        function saveSizeLimit() {
            const service = document.getElementById('ctrl-size-service').value;
            const duration = document.getElementById('ctrl-size-duration').value;
            const limit = document.getElementById('ctrl-size-limit').value;
            
            if(limit) {
                if(!sizeLimits[service]) sizeLimits[service] = {};
                sizeLimits[service][duration] = limit;
                localStorage.setItem('fg_size_limits', JSON.stringify(sizeLimits));
                alert(`Limit saved.`);
                document.getElementById('adm-ctrl-size-modal').style.display = 'none';
            }
        }

        // --- ADMIN CORE CONTINUED ---
        function runAdminAction() {
            if(pendingAdminAction !== 'viewRep') {
                const p = document.getElementById('admin-act-pass').value;
                if(p !== adminPass) {
                    alert("Wrong Code");
                    return;
                }
                document.getElementById('admin-action-modal').style.display = 'none';
                document.getElementById('admin-act-pass').value = '';
            }
            
            const area = document.getElementById('admin-dynamic-content');
            area.innerHTML = '';
            
            if(pendingAdminAction === 'userStats') {
                // Task 6: Ban/Open/Delete buttons
                area.innerHTML = `<h4>User Activity</h4>
                <p>Total Users: ${users.length}</p>
                <div style="max-height:200px; overflow-y:auto;">
                    ${users.map(u => {
                        const banStatus = u.isBanned ? '<span style="color:red">(BANNED)</span>' : '';
                        return `<div class="user-item">
                        <img src="${u.photo || 'lion_image.jpg'}">
                        <span>${u.name} ${banStatus}</span>
                        <div style="margin-left:auto; display:flex; gap:2px;">
                             <button class="btn-red btn-tiny" onclick="adminUserAction('ban', '${u.phone}')">Ban</button>
                             <button class="btn-green btn-tiny" onclick="adminUserAction('open_ban', '${u.phone}')">Open Ban</button>
                             <button class="btn-black btn-tiny" onclick="adminUserAction('delete', '${u.phone}')">Delete</button>
                        </div>
                    </div>`}).join('')}
                </div>`;
            } else if (pendingAdminAction === 'viewRep') {
                 if(reports.length === 0) {
                     area.innerHTML = "<h4>Reports</h4><p>No new reports.</p>";
                } else {
                    area.innerHTML = "<h4>User Reports</h4>";
                    reports.forEach(r => {
                        area.innerHTML += `
                        <div style="border:1px solid red; padding:5px; margin:5px; border-radius:5px;">
                            <p><b>Post:</b> ${r.postContent}</p>
                            <p><b>Reason:</b> ${r.reason}</p>
                            <button class="btn-red btn-tiny" onclick="deletePost('${r.id}'); alert('Deleted');">Delete Post</button>
                            <!-- Task 13: Automatic Control Button -->
                            <button class="btn-blue btn-tiny" onclick="toggleAutomaticControl()">Control Automatic</button>
                        </div>`;
                    });
                }
            }
        }
        
        function adminViewPayments(type) {
             const list = document.getElementById('admin-payment-list');
             list.innerHTML = '';
             const reqs = paymentRequests.filter(r => r.type === type);
             
             if(reqs.length === 0) list.innerHTML = "<p>No payments found.</p>";
             else {
                 reqs.forEach(r => {
                     let statusColor = r.status === 'approved' ? 'green' : (r.status === 'rejected' ? 'red' : 'orange');
                     list.innerHTML += `<div class="user-item">
                        <img src="${r.userPhoto || 'lion_image.jpg'}">
                        <div>
                             <b>${r.userName}</b> <span style="color:${statusColor}">(${r.status})</span><br>
                             <small>Service: ${r.service}</small>
                        </div>
                        <div style="margin-left:auto; display:flex; flex-direction:column; gap:2px;">
                             ${r.status === 'pending' ? `<button class="btn-green btn-tiny" onclick="approvePayment(${r.id})">Approve</button>
                             <button class="btn-red btn-tiny" onclick="rejectPayment(${r.id})">Reject</button>` : ''}
                             <button class="btn-red btn-tiny" style="background:black;" onclick="deletePaymentRequest(${r.id})">Delete</button>
                        </div>
                     </div>`;
                 });
             }
        }
        
        function approvePayment(id) {
             const req = paymentRequests.find(r => r.id === id);
             if(req) {
                 const u = users.find(x => x.phone === req.user);
                 if(u) {
                     if(!u.paidServices) u.paidServices = {};
                     u.paidServices[req.service] = true;
                     u.isPremium = true;
                     localStorage.setItem('fg_users', JSON.stringify(users));
                 }
                 req.status = 'approved';
                 localStorage.setItem('fg_pay_requests', JSON.stringify(paymentRequests));
                 alert("Approved!");
                 adminViewPayments(req.type); 
             }
        }
        
        function rejectPayment(id) {
             const req = paymentRequests.find(r => r.id === id);
             if(req) {
                 req.status = 'rejected';
                 localStorage.setItem('fg_pay_requests', JSON.stringify(paymentRequests));
                 alert("Rejected.");
                 adminViewPayments(req.type); 
             }
        }
        
        function deletePaymentRequest(id) {
            paymentRequests = paymentRequests.filter(r => r.id !== id);
            localStorage.setItem('fg_pay_requests', JSON.stringify(paymentRequests));
            alert("Deleted.");
            document.getElementById('adm-prem-modal').style.display = 'none';
        }
        
        function adminViewWithdrawals() {
             const list = document.getElementById('admin-withdraw-list');
             list.innerHTML = '';
             const reqs = withdrawRequests.filter(r => r.status === 'pending');
             
             if(reqs.length === 0) list.innerHTML = "<p>No pending withdrawals.</p>";
             else {
                 reqs.forEach(r => {
                     list.innerHTML += `<div class="user-item">
                        <div>
                             <b>${r.userName}</b><br>
                             <small>${r.amount} ${r.type}</small>
                        </div>
                        <div style="margin-left:auto;">
                             <button class="btn-green btn-tiny" onclick="approveWithdrawal(${r.id})">Pay</button>
                             <button class="btn-red btn-tiny" onclick="rejectWithdrawal(${r.id})">Reject</button>
                        </div>
                     </div>`;
                 });
             }
        }
        
        function approveWithdrawal(id) {
             const req = withdrawRequests.find(r => r.id === id);
             if(req) {
                 const u = users.find(x => x.phone === req.user);
                 if(u) {
                     if(req.type === 'ETB') u.balETB -= req.amount;
                     else if(req.type === 'USDT') u.balUSD -= req.amount;
                     localStorage.setItem('fg_users', JSON.stringify(users));
                     if(window.firebaseTools && u.id) window.firebaseTools.updateUserBalance(u.id, req.type === 'USDT' ? 'USD' : 'ETB', -req.amount);
                 }
                 req.status = 'approved';
                 localStorage.setItem('fg_withdraw_requests', JSON.stringify(withdrawRequests));
                 alert("Approved & Deducted.");
                 adminViewWithdrawals();
             }
        }
        
        function rejectWithdrawal(id) {
             const req = withdrawRequests.find(r => r.id === id);
             if(req) {
                 req.status = 'rejected';
                 localStorage.setItem('fg_withdraw_requests', JSON.stringify(withdrawRequests));
                 alert("Rejected.");
                 adminViewWithdrawals();
             }
        }
        
        function adminUserAction(action, phone) {
            if(action === 'delete') {
                if(confirm("Permanently Delete User?")) {
                    users = users.filter(u => u.phone !== phone);
                    localStorage.setItem('fg_users', JSON.stringify(users));
                    if(window.firebaseTools) window.firebaseTools.deleteUser(phone);
                    alert("Deleted");
                    runAdminAction(); 
                }
            } else if(action === 'ban') {
                const u = users.find(x => x.phone === phone);
                if(u) {
                    u.isBanned = true; 
                    localStorage.setItem('fg_users', JSON.stringify(users));
                    if(window.firebaseTools) window.firebaseTools.banUser(phone, true);
                    alert("User Banned");
                    runAdminAction();
                }
            } else if(action === 'open_ban') {
                const u = users.find(x => x.phone === phone);
                if(u) {
                    u.isBanned = false; 
                    localStorage.setItem('fg_users', JSON.stringify(users));
                    if(window.firebaseTools) window.firebaseTools.banUser(phone, false);
                    alert("Ban Removed");
                    runAdminAction();
                }
            }
        }
        
        function saveNewAdminPass() {
            const o = document.getElementById('old-adm').value;
            const n = document.getElementById('new-adm').value;
            const c = document.getElementById('conf-adm').value;
            
            if(o !== adminPass) return alert("Old code wrong");
            if(n !== c) return alert("Mismatch");
            if(n.length < 6) return alert("Too short");
            
            adminPass = n;
            localStorage.setItem('fg_admin_pass', n);
            alert("Admin Code Changed");
            document.getElementById('admin-chg-modal').style.display = 'none';
        }
        
        function setBusinessStatus(s) {
            bizStatus = s;
            localStorage.setItem('fg_biz_status', s);
            alert("Business Center is now " + s);
            document.getElementById('adm-biz-ctrl-modal').style.display = 'none';
        }

        function setPdfStatus(s) {
            pdfStatus = s;
            localStorage.setItem('fg_pdf_status', s);
            alert("PDF Service is now " + s);
            document.getElementById('adm-pdf-ctrl-modal').style.display = 'none';
        }
        
        // Task 13: Automatic Control Logic
        function toggleAutomaticControl() {
            if(automaticBalanceStatus === 'open') {
                automaticBalanceStatus = 'closed';
                alert("Automatic Balance Recording STOPPED (Blocked).");
            } else {
                automaticBalanceStatus = 'open';
                alert("Automatic Balance Recording OPENED.");
            }
            localStorage.setItem('fg_auto_bal', automaticBalanceStatus);
            document.getElementById('auto-status-text').innerText = automaticBalanceStatus === 'open' ? 'Open' : 'Blocked';
        }
        
        // Task 14: Verification Panel for Admin
        function openVerificationPanel() {
            alert("Verification Panel:\n1. Send OTP (Simulated via SMS API)\n2. Receive & Verify (Check user input)");
            // In a real app, this would open a list of pending users
        }

        function openAdminBizNotif() {
            document.getElementById('adm-biz-notif-modal').style.display = 'flex';
        }
        
        function sendBizNotif() {
            const txt = document.getElementById('biz-notif-text').value;
            if(!txt) return alert("Empty");
            businessNotif = txt;
            localStorage.setItem('fg_biz_notif', txt);
            renderNotifications();
            alert("Sent");
            document.getElementById('adm-biz-notif-modal').style.display = 'none';
        }
        
        function clearBizNotif() {
            businessNotif = '';
            localStorage.setItem('fg_biz_notif', '');
            renderNotifications();
            alert("Cleared");
            document.getElementById('adm-biz-notif-modal').style.display = 'none';
        }
        
        function openAdminDashNotif() {
            document.getElementById('adm-dash-notif-modal').style.display = 'flex';
        }
        
        function sendDashNotif() {
            const txt = document.getElementById('dash-notif-text').value;
            if(!txt) return alert("Empty");
            dashboardNotif = txt;
            localStorage.setItem('fg_dash_notif', txt);
            renderNotifications();
            alert("Sent");
            document.getElementById('adm-dash-notif-modal').style.display = 'none';
        }
        
        function clearDashNotif() {
            dashboardNotif = '';
            localStorage.setItem('fg_dash_notif', '');
            renderNotifications();
            alert("Cleared");
            document.getElementById('adm-dash-notif-modal').style.display = 'none';
        }
        
        function setGlobalLock(status) {
            globalLock = status; 
            localStorage.setItem('fg_global_lock', status);
            alert("Global Lock: " + status);
            document.getElementById('adm-pdf-ctrl-modal').style.display = 'none';
        }

        function renderNotifications() {
            const d = document.getElementById('dashboard-notif-area');
            if(dashboardNotif) {
                d.style.display = 'block';
                d.innerText = dashboardNotif;
            } else {
                d.style.display = 'none';
            }
            
            const b = document.getElementById('business-notif-area');
            if(businessNotif) {
                b.style.display = 'block';
                b.innerText = businessNotif;
            } else {
                b.style.display = 'none';
            }
        }

        // --- REAL LIVE STREAM FUNCTIONS ---
        function startRealLiveStream() {
            liveStreamActive = true;
            document.querySelector('.live-badge').style.display = 'inline-block';
            
            const videoEl = document.getElementById('live-video-element');
            if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                navigator.mediaDevices.getUserMedia({ video: true, audio: true })
                    .then(function(stream) {
                        videoEl.srcObject = stream;
                        videoEl.play();
                    })
                    .catch(function(error) {
                        console.error("Camera error:", error);
                        alert("Camera access denied or error.");
                    });
            }
            
            liveViewers = 0;
            liveViewersInterval = setInterval(() => {
                liveViewers += Math.floor(Math.random() * 5); 
                updateLiveViewers();
            }, 3000);
            
            if(window.firebaseTools && window.firebaseTools.saveLiveStreamStatus) {
                window.firebaseTools.saveLiveStreamStatus({
                    user: user.name,
                    isActive: true
                });
            }
            
            updateLiveIndicators(true);
        }
        
        function stopRealLiveStream() {
            liveStreamActive = false;
            document.querySelector('.live-badge').style.display = 'none';
            
            const videoEl = document.getElementById('live-video-element');
            if(videoEl.srcObject) {
                videoEl.srcObject.getTracks().forEach(track => track.stop());
                videoEl.srcObject = null;
            }
            
            clearInterval(liveViewersInterval);
            liveViewers = 0;
            updateLiveViewers();
            
            if(window.firebaseTools && window.firebaseTools.saveLiveStreamStatus) {
                window.firebaseTools.saveLiveStreamStatus({
                    user: user.name,
                    isActive: false
                });
            }
            
            updateLiveIndicators(false);
        }
        
        function updateLiveViewers() {
            document.getElementById('live-viewers-count').innerText = "üëÅÔ∏è " + liveViewers;
            updateLiveIndicators(true); 
        }
        
        function sendLiveChat() {
            const input = document.getElementById('live-chat-input');
            const txt = input.value;
            if(!txt) return;
            
            const chatBox = document.getElementById('live-chat-box');
            const msgDiv = document.createElement('div');
            msgDiv.innerText = `${user.name}: ${txt}`;
            chatBox.appendChild(msgDiv);
            chatBox.scrollTop = chatBox.scrollHeight;
            
            input.value = '';
        }
        
        function toggleLiveAudio() {
            const videoEl = document.getElementById('live-video-element');
            if(videoEl && videoEl.srcObject) {
                videoEl.srcObject.getAudioTracks().forEach(track => {
                    track.enabled = !track.enabled;
                    liveAudioMuted = !track.enabled;
                });
                document.getElementById('live-audio-btn').innerText = liveAudioMuted ? "üîá Unmute" : "üîä Mute";
            }
        }
        
        function handleLiveList() {
            showView('view-live-list');
            const c = document.getElementById('live-list-cont');
            c.innerHTML = '';
            
            if(liveStreamActive) {
                c.innerHTML = `<div class="user-item" onclick="openRealLiveStream()">
                    <img src="${user.photo || 'lion_image.jpg'}"> <b>${user.name}</b> (YOU - LIVE)
                </div>`;
            } else {
                c.innerHTML = "<p>No active live streams.</p>";
            }
        }
        
        function joinLive(mode) {
            document.getElementById('watch-talk-modal').style.display = 'none';
            openRealLiveStream();
        }
        
        function updateLiveIndicators(active = false) {
            const text = active ? 'üî¥ Live Now' : 'üî¥ Offline';
            document.getElementById('live-status-text').innerHTML = text;
            document.getElementById('live-status-text').style.color = active ? 'red' : 'black';
            
            const liveBtnTxt = document.getElementById('live-btn-txt');
            if(liveBtnTxt) {
                liveBtnTxt.innerText = active && liveViewers > 0 ? "LiVe" + liveViewers : "LiVe0";
            }
            
            if(document.getElementById('fb-live-indicator')) 
                document.getElementById('fb-live-indicator').style.backgroundColor = active ? 'red' : 'transparent';
        }

        // --- PWA Service Worker Registration ---
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js').then((registration) => {
                    console.log('ServiceWorker registration successful with scope: ', registration.scope);
                }, (err) => {
                    console.log('ServiceWorker registration failed: ', err);
                });
            });
        }

    </script>

<script>
  window.chatbaseConfig = {
    chatbotId: "r-x7-Xm_Y-6mYj6zNq_K1",
    alignment: "left"
  }
</script>
    <script>
(function(){if(!window.chatbase||window.chatbase("getState")!=="initialized"){window.chatbase=(...arguments)=>{if(!window.chatbase.q){window.chatbase.q=[]}window.chatbase.q.push(arguments)};window.chatbase=new Proxy(window.chatbase,{get(target,prop){if(prop==="q"){return target.q}return(...args)=>target(prop,...args)}})}const onLoad=function(){const script=document.createElement("script");script.src="https://www.chatbase.co/embed.min.js";script.id="IeHEhuOCnYiOp86WS22vL";script.domain="www.chatbase.co";document.body.appendChild(script)};if(document.readyState==="complete"){onLoad()}else{window.addEventListener("load",onLoad)}})();
</script>
</body>
</html>
