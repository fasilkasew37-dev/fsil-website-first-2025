á‹ˆ<!DOCTYPE html>
<html lang="am">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="app-title">á‹áˆ²áˆ á‹Œá‰¥ áŠ á• - Fasil Web App (Corrected Full Version)</title>
    <style>
        /* --- áˆ˜á‹°á‰ áŠ› CSS (á‹¨á‹µáˆ®á‹ áˆµá‰³á‹­áˆ) --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            text-align: center;
            padding: 20px;
            background-color: #f0f4f8;
            color: #333;
            margin: 0;
        }
        .section {
            max-width: 700px;
            margin: 20px auto;
            padding: 25px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
            border-top: 6px solid #007bff;
            text-align: left;
            display: none; 
            padding-bottom: 60px;
        }
        #agreement-view { display: block; }
        
        h1, h2 { text-align: center; }
        h1 { color: #007bff; font-size: 28px; margin-bottom: 10px; }
        h2 { color: #555; font-size: 22px; margin: 20px 0; }

        input, select, textarea {
            width: 100%; padding: 12px; margin: 10px 0;
            border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; font-size: 16px;
        }
        
        /* Buttons */
        button, .button-link {
            display: block; width: 100%; padding: 15px; margin: 12px 0;
            text-align: center; border-radius: 8px; font-weight: bold;
            cursor: pointer; border: none; font-size: 16px; color: white; transition: 0.3s;
        }
        .main-btn { background-color: #007bff; }
        .success-btn { background-color: #28a745; }
        .delete-btn { background-color: #dc3545; }
        .premium-btn { background-color: #ffc107; color: #333; }
        .feature-btn { background-color: #8c5aee; }
        .business-btn { background-color: #00a08e; }
        .social-btn { background-color: #ff7043; }
        .language-btn { background-color: #6c757d; }

        /* Custom Modal (Alerts) */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.6); display: none;
            justify-content: center; align-items: center; z-index: 2000;
        }
        .modal-box {
            background: white; padding: 25px; border-radius: 12px;
            width: 85%; max-width: 400px; text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3); animation: popIn 0.3s ease;
        }
        @keyframes popIn { 0% { transform: scale(0.8); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
        
        /* Cards */
        .user-card, .post-card {
            display: flex; align-items: center; padding: 10px;
            border: 1px solid #eee; border-radius: 8px; margin-bottom: 10px;
            background-color: #f9f9f9;
        }
        .user-card img { width: 50px; height: 50px; border-radius: 50%; margin-right: 15px; object-fit: cover; }
        .post-card { display: block; }

        /* Loading */
        .loading-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.9); display: none;
            justify-content: center; align-items: center; z-index: 1000; flex-direction: column;
        }
        .spinner {
            border: 6px solid #f3f3f3; border-top: 6px solid #007bff;
            border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <!-- Loading -->
    <div class="loading-overlay" id="loading-overlay">
        <div class="spinner"></div>
        <p id="loading-txt">... áŠ¥á‹¨á‰°áŒ«áŠ áŠá‹ ...</p>
    </div>

    <!-- Alert Modal -->
    <div class="modal-overlay" id="custom-modal">
        <div class="modal-box">
            <h3 id="modal-title"></h3>
            <p id="modal-text"></p>
            <button class="main-btn" onclick="closeModal()">OK</button>
        </div>
    </div>
    
    <!-- Password Prompt -->
    <div class="modal-overlay" id="password-modal">
        <div class="modal-box">
            <h3>Password Required</h3>
            <p>áŠ¥á‰£áŠ­á‹ á‹¨á‹­áˆˆá á‰ƒáˆ á‹«áˆµáŒˆá‰¡</p>
            <input type="password" id="modal-password-input" style="text-align: center;">
            <button class="success-btn" onclick="confirmActionWithPassword()">Confirm</button>
            <button class="delete-btn" onclick="document.getElementById('password-modal').style.display='none'">Cancel</button>
        </div>
    </div>

    <!-- 1. Agreement View -->
    <div class="section" id="agreement-view">
        <h1 id="title-agreement">áŠ¥áŠ•áŠ³áŠ• á‹ˆá‹° á‹áˆ²áˆ á‹Œá‰¥ á‰ á‹°áˆ…áŠ“ áˆ˜áŒ¡</h1>
        <div style="background:#e9ecef; padding:20px; border-radius:8px; border-left:5px solid #007bff;">
            <h3>ğŸŒ áˆµáˆˆ áŠ á•áˆŠáŠ¬áˆ½áŠ‘</h3>
            <p id="txt-intro">á‹áˆ²áˆ á‹Œá‰¥ áŠ á• á‹²áŒ‚á‰³áˆ áˆ˜áŒ‹áˆªá‹«á£ á“á‹ˆáˆ­ á–á‹­áŠ•á‰µá£ á’á‹²áŠ¤á áŠ¥áŠ“ á‹“áˆˆáˆ áŠ á‰€á á‹¨áŠ­áá‹« áŠ áŒˆáˆáŒáˆá‰¶á‰½áŠ• á‹¨á‹«á‹˜ áˆ˜á‹µáˆ¨áŠ­ áŠá‹á¢</p>
        </div>
        <div style="background:#ffe0b2; padding:20px; margin-top:20px; border-left:5px solid #ff9800;">
            <h3 id="title-rules">âš ï¸ áŒ¥á‰¥á‰… áˆ˜áˆ˜áˆªá‹«</h3>
            <p id="txt-rules">á–áˆˆá‰²áŠ«á‹Š áŒáŒ­á‰µá£ á‹¨áˆƒá‹­áˆ›áŠ–á‰µ áŒ¥áˆ‹á‰» áŠ¥áŠ“ á‹˜áˆ¨áŠáŠá‰µ áˆ›áˆ«áˆ˜á‹µ á‰ áŒ¥á‰¥á‰… á‹¨á‰°áŠ¨áˆˆáŠ¨áˆˆ áŠá‹á¢</p>
        </div>
        <h2 id="prompt-agree">á‹­á‰€á‰ áˆ‹áˆ‰?</h2>
        <button class="success-btn" onclick="showView('home-view')" id="btn-agree">âœ… áŠ¥áˆµáˆ›áˆ›áˆˆáˆ</button>
        <button class="delete-btn" onclick="showAlert('áˆ˜áŒ á‰€áˆ áŠ á‹­á‰½áˆ‰áˆá¢', 'error')" id="btn-disagree">âŒ áŠ áˆáˆµáˆ›áˆ›áˆ</button>
        <button class="language-btn" onclick="toggleLanguage()">Language: Amharic/English</button>
    </div>

    <!-- 2. Home View -->
    <div class="section" id="home-view">
        <h1 id="title-home">á‹¨áˆ˜áŒá‰¢á‹« áˆáˆ­áŒ«</h1>
        <h2 id="prompt-use">áŠ¥áŠ•á‹´á‰µ áˆ˜áŒ á‰€áˆ á‹­áˆáˆáŒ‹áˆ‰?</h2>
        <button class="main-btn" onclick="showView('signup-form')" id="btn-signup-home">á‰ áŠáƒ áˆˆáˆ˜áˆ˜á‹áŒˆá‰¥ / áˆˆáˆ˜áŒá‰£á‰µ</button>
        <button class="premium-btn" onclick="checkFreeSignupForPremium()" id="btn-premium-home">á‰ áŠ­áá‹« áŠ áˆ›áˆ«áŒ­ áˆˆáˆ˜áˆ˜á‹áŒˆá‰¥</button>
        <button class="language-btn" onclick="toggleLanguage()">Language: Amharic/English</button>
        <button class="delete-btn" onclick="showView('agreement-view')" style="background:#6c757d; margin-top:30px;" id="btn-back-home">á‹ˆá‹° áˆ˜áˆ˜áˆªá‹« á‰°áˆ˜áˆˆáˆµ</button>
    </div>

    <!-- 3. Signup -->
    <div class="section" id="signup-form">
        <h2 id="title-signup">áŠ á‹²áˆµ áˆá‹áŒˆá‰£</h2>
        <input type="text" id="signup-name" placeholder="Name">
        <input type="text" id="signup-phone" placeholder="Phone">
        <input type="email" id="signup-email" placeholder="Email (@gmail.com only)">
        <input type="password" id="signup-password" placeholder="Password (6 digits)" maxlength="6">
        <p>**Profile Photo**</p>
        <input type="file" id="signup-profile-photo" accept="image/*">
        <button class="success-btn" onclick="handleSignUp()" id="btn-register">áˆ˜á‹áŒá‰¥</button>
        <p style="text-align:center; cursor:pointer; color:#007bff;" onclick="showView('login-form')" id="link-login">á‰°áˆ˜á‹áŒá‰ á‹‹áˆ? á‹­áŒá‰¡</p>
    </div>

    <!-- 4. Login -->
    <div class="section" id="login-form">
        <h2 id="title-login">áˆ˜áŒá‰¢á‹«</h2>
        <input type="text" id="login-phone" placeholder="Phone">
        <input type="password" id="login-password" placeholder="Password">
        <button class="main-btn" onclick="handleLogin()" id="btn-login">áŒá‰£</button>
        <p style="text-align:center; cursor:pointer; color:#007bff;" onclick="showView('signup-form')" id="link-signup">áŠ á‹²áˆµ á‰°áŒ á‰ƒáˆš? á‹­áˆ˜á‹áŒˆá‰¡</p>
    </div>

    <!-- 5. Main Dashboard -->
    <div class="section" id="dashboard-view">
        <h1 id="title-dash">á‹³áˆ½á‰¦áˆ­á‹µ</h1>
        
        <h2 id="sub-services">áŠ áŒˆáˆáŒáˆá‰¶á‰½:</h2>
        <button class="main-btn" onclick="showView('view-select')" id="btn-view">ğŸ“„ áˆ˜áˆ¨áŒƒ áˆ˜áˆ˜áˆáŠ¨á‰µ</button>
        <button class="main-btn" onclick="showView('post-select')" id="btn-post">âœï¸ áˆ˜áˆ¨áŒƒ áˆ˜áˆˆáŒ á</button>
        
        <!-- The restored User List Button -->
        <button class="feature-btn" onclick="showUserList(false)" id="btn-users">ğŸ‘¥ á‹¨á‹áˆ²áˆ á‹Œá‰¥ áŠ á• á‰°áŒ á‰ƒáˆšá‹á‰½</button>

        <button class="social-btn" onclick="handleGroupCreation()" id="btn-group">ğŸ‘¥ á‰¡á‹µáŠ• áˆˆáˆ˜ááŒ áˆ­</button>
        <button class="social-btn" style="background:#5e35b1;" onclick="showMyGroupsList()" id="btn-mygroups">ğŸ“‚ á‹¨áˆáŒ áˆ©á‰µáŠ• áŒáˆ©á• áˆˆáˆ˜áˆ˜áˆáŠ¨á‰µ</button>
        <button class="social-btn" onclick="handlePrivateChatStart()" id="btn-chat">ğŸ’¬ á‰ á‹áˆµáŒ¥ áˆ˜áˆµáˆ˜áˆ­ áˆ›á‹áˆ«á‰µ</button>
        
        <button class="success-btn" style="background-color: #00bcd4;" onclick="showView('feedback-center')" id="btn-feedback">ğŸ“ áŠ áˆµá‰°á‹«á‹¨á‰µ áˆˆáˆ˜áˆµáŒ á‰µ áŠ¥áŠ“ áˆˆáˆ˜áˆ˜áˆáŠ¨á‰µ</button>

        <button class="business-btn" onclick="checkAuthAndRedirect('business-dashboard')" id="btn-business">ğŸ’° á‰¢á‹áŠáˆµ áˆ›á‹•áŠ¨áˆ</button>
        
        <button class="feature-btn" style="background-color: #ffc107; color: black;" onclick="showView('premium-services-list')" id="btn-premium">â­ï¸ á‹¨áŠ­áá‹« áŠ áŒˆáˆáŒáˆá‰¶á‰½</button>

        <button class="delete-btn" onclick="showDeleteList()" id="btn-delete-posts">ğŸ—‘ï¸ á‹¨áˆˆáŒ á‰á‰µáŠ• áˆ˜áˆ¨áŒƒ áˆ˜á‹°áˆˆá‰µ</button>
        
        <button class="language-btn" onclick="toggleLanguage()">Language: Amharic/English</button>
        <button class="delete-btn" style="background-color: #6c757d; margin-top: 20px;" onclick="handleLogout()" id="btn-logout">á‹áŒ£</button>
    </div>

    <!-- 6. Post Selection (Specific Buttons) -->
    <div class="section" id="post-select">
        <h2 id="title-post-select">âœï¸ áˆáŠ• áˆ˜áˆˆáŒ á á‹­áˆáˆáŒ‹áˆ‰?</h2>
        <button class="main-btn" onclick="openPostForm('text')" id="btn-post-text">ğŸ“ á…áˆá (Text)</button>
        <button class="main-btn" onclick="openPostForm('image')" id="btn-post-image">ğŸ“· áˆáˆµáˆ (Image)</button>
        <button class="main-btn" onclick="openPostForm('video')" id="btn-post-video">ğŸ¥ á‰ªá‹²á‹® (Video)</button>
        <button class="main-btn" onclick="openPostForm('audio')" id="btn-post-audio">ğŸ™ï¸ á‹µáˆá… (Audio)</button>
        <button class="delete-btn" onclick="showView('dashboard-view')" id="btn-back-post">á‰°áˆ˜áˆˆáˆµ</button>
    </div>

    <!-- 7. Actual Post Form -->
    <div class="section" id="post-form-view">
        <h2 id="title-posting">áŠ¥á‹¨áˆˆáŒ á‰ áŠá‹...</h2>
        <input type="text" id="post-title" placeholder="Title">
        <textarea id="post-content" placeholder="Text content..." rows="5"></textarea>
        
        <div id="file-upload-area" style="display:none;">
            <p id="label-file">á‹á‹­áˆ á‹­áˆáˆ¨áŒ¡:</p>
            <input type="file" id="post-file">
        </div>

        <button class="success-btn" onclick="handlePostSubmit()" id="btn-submit-post">áˆˆáŒ¥á</button>
        <button class="delete-btn" onclick="showView('post-select')" id="btn-cancel-post">áˆ°áˆ­á‹</button>
    </div>

    <!-- 8. View Selection (Specific Buttons) -->
    <div class="section" id="view-select">
        <h2 id="title-view-select">ğŸ“„ áˆáŠ• áˆ˜áˆ˜áˆáŠ¨á‰µ á‹­áˆáˆáŒ‹áˆ‰?</h2>
        <button class="main-btn" onclick="displayPosts('text')" id="btn-view-text">ğŸ“ á…áˆá (Text)</button>
        <button class="main-btn" onclick="displayPosts('image')" id="btn-view-image">ğŸ“· áˆáˆµáˆ (Image)</button>
        <button class="main-btn" onclick="displayPosts('video')" id="btn-view-video">ğŸ¥ á‰ªá‹²á‹® (Video)</button>
        <button class="main-btn" onclick="displayPosts('audio')" id="btn-view-audio">ğŸ™ï¸ á‹µáˆá… (Audio)</button>
        <button class="delete-btn" onclick="showView('dashboard-view')" id="btn-back-view">á‰°áˆ˜áˆˆáˆµ</button>
    </div>

    <!-- 9. Posts Viewer -->
    <div class="section" id="posts-viewer">
        <h2 id="title-viewer">á‹¨á‰°áˆˆáŒ á‰ áˆ˜áˆ¨áŒƒá‹á‰½</h2>
        <div id="posts-container"></div>
        <button class="delete-btn" onclick="showView('view-select')" id="btn-back-viewer">á‰°áˆ˜áˆˆáˆµ</button>
    </div>

    <!-- 10. User List View (Used for List & Selection) -->
    <div class="section" id="user-list-view">
        <h2 id="title-users">ğŸ‘¥ á‹¨á‰°áŒ á‰ƒáˆšá‹á‰½ á‹áˆ­á‹áˆ­</h2>
        <div id="user-list-container"></div>
        <button id="user-list-done-btn" class="success-btn" style="display:none;">áŒ¨áˆ­áˆ»áˆˆáˆ (Done)</button>
        <button class="delete-btn" onclick="showView('dashboard-view')" id="btn-back-users">á‰°áˆ˜áˆˆáˆµ</button>
    </div>

    <!-- 11. Business Dashboard -->
    <div class="section" id="business-dashboard">
        <h2 id="title-business">ğŸ’° á‹¨á‰¢á‹áŠáˆµ áˆ›á‹•áŠ¨áˆ</h2>
        <div style="background:#f8f9fa; border:1px solid #ddd; padding:15px; border-radius:8px; margin-bottom:15px;">
            <h3 style="margin:0; color:#333;">USD Balance: <span id="main-usd" style="color:#007bff;">0.00</span></h3>
            <div style="margin-top:10px;">
                <span style="color:red; font-weight:bold; margin-right:10px;">GBP: <span id="bal-gbp">0.00</span></span>
                <span style="color:green; font-weight:bold;">EUR: <span id="bal-eur">0.00</span></span>
            </div>
            <hr>
            <p>Total Estimate (USD): <span id="total-est-usd">0.00</span> $</p>
        </div>

        <button class="success-btn" onclick="showView('deposit-view')" id="btn-deposit">ğŸ’µ áŒˆáŠ•á‹˜á‰¥ áˆˆáˆ›áˆµáŒˆá‰£á‰µ</button>
        <button class="main-btn" onclick="showView('withdraw-view')" id="btn-withdraw">ğŸ’¸ áŒˆáŠ•á‹˜á‰¥ áˆˆáˆ›á‹áŒ£á‰µ</button>
        <button class="premium-btn" onclick="showView('intl-purchase-view')" id="btn-intl">ğŸŒ á‹“áˆˆáˆ áŠ á‰€á áŒá‹¢</button>
        <button class="delete-btn" onclick="showView('dashboard-view')" id="btn-back-biz">á‰°áˆ˜áˆˆáˆµ</button>
    </div>

    <!-- 12. Deposit View -->
    <div class="section" id="deposit-view">
        <h2 id="title-deposit">ğŸ’µ áŒˆáŠ•á‹˜á‰¥ áˆ›áˆµáŒˆá‰£á‰µ</h2>
        <p>ETB Amount:</p>
        <input type="number" id="deposit-etb" placeholder="Amount">
        <p>Convert to:</p>
        <select id="deposit-target-currency">
            <option value="USD">USD ($)</option>
            <option value="GBP">GBP (Â£)</option>
            <option value="EUR">EUR (â‚¬)</option>
        </select>
        <p>Receipt:</p>
        <input type="file" id="deposit-receipt">
        <button class="success-btn" onclick="handleDeposit()" id="btn-confirm-deposit">áŠ áˆµáŒˆá‰£</button>
        <button class="delete-btn" onclick="showView('business-dashboard')">Cancel</button>
    </div>

    <!-- 13. Withdraw View -->
    <div class="section" id="withdraw-view">
        <h2 id="title-withdraw">ğŸ’¸ áŒˆáŠ•á‹˜á‰¥ áˆ›á‹áŒ£á‰µ</h2>
        <p>Withdraw From:</p>
        <select id="withdraw-source-currency">
            <option value="USD">USD ($)</option>
            <option value="GBP">GBP (Â£)</option>
            <option value="EUR">EUR (â‚¬)</option>
        </select>
        <input type="number" id="withdraw-amount" placeholder="Amount">
        <p>Method:</p>
        <select id="withdraw-method">
            <option value="Telebirr">Telebirr (09...)</option>
            <option value="CBE">CBE (13 digits)</option>
            <option value="PayPal">PayPal</option>
        </select>
        <input type="text" id="withdraw-receiver" placeholder="Account/Phone">
        <button class="main-btn" onclick="initiateWithdraw()" id="btn-confirm-withdraw">áŠ á‹áŒ£</button>
        <button class="delete-btn" onclick="showView('business-dashboard')">Cancel</button>
    </div>

    <!-- 14. International Purchase -->
    <div class="section" id="intl-purchase-view">
        <h2 id="title-intl">ğŸŒ á‹“áˆˆáˆ áŠ á‰€á áŒá‹¢</h2>
        <select id="intl-service">
            <option value="ChatGPT">ChatGPT</option>
            <option value="Gemini">Gemini Advanced</option>
            <option value="Amazon">Amazon</option>
            <option value="Hosting">Hosting</option>
            <option value="Domain">Domain</option>
        </select>
        <input type="number" id="intl-amount" placeholder="Amount ($)">
        <p>Receipt (Optional):</p>
        <input type="file" id="intl-receipt">
        <button class="success-btn" onclick="handleIntlPurchase()" id="btn-pay-intl">áŠ­áˆáˆˆá‹</button>
        <button class="delete-btn" onclick="showView('business-dashboard')">Cancel</button>
    </div>

    <!-- 15. Premium Services -->
    <div class="section" id="premium-services-list">
        <h2 id="title-prem-list">â­ï¸ á‹¨áŠ­áá‹« áŠ áŒˆáˆáŒáˆá‰¶á‰½</h2>
        <button class="main-btn" onclick="openPricingModal('Quality Video')" id="btn-p-video">ğŸ¥ áŒ¥áˆ«á‰± á‹¨áŒ á‰ á‰€ á‰ªá‹²á‹®</button>
        <button class="main-btn" onclick="openPricingModal('News Service')" id="btn-p-news">ğŸ“° á‹œáŠ“ áˆ˜áŠ¨á‰³á‰°áˆ</button>
        <button class="main-btn" onclick="openPricingModal('PPT Creation')" id="btn-p-ppt">ğŸ“Š á“á‹ˆáˆ­ á–á‹­áŠ•á‰µ</button>
        <button class="main-btn" onclick="openPricingModal('PDF Tools')" id="btn-p-pdf">ğŸ“„ á’á‹²áŠ¤á</button>
        <button class="delete-btn" onclick="showView('dashboard-view')">á‰°áˆ˜áˆˆáˆµ</button>
    </div>

    <!-- 16. Pricing View -->
    <div class="section" id="pricing-view">
        <h2 id="title-pricing">áŠ­áá‹«</h2>
        <h3 id="pricing-service-name">Service</h3>
        <button class="success-btn" onclick="processPayment(5)">Daily (5 ETB)</button>
        <button class="success-btn" onclick="processPayment(25)">Weekly (25 ETB)</button>
        <button class="success-btn" onclick="processPayment(30)">Monthly (30 ETB)</button>
        <button class="success-btn" onclick="processPayment(100)">Yearly (100 ETB)</button>
        <button class="delete-btn" onclick="showView('premium-services-list')">Cancel</button>
    </div>

    <!-- 17. Payment Confirm -->
    <div class="section" id="payment-confirm-view">
        <h2>Confirm Payment</h2>
        <p>Upload Receipt:</p>
        <input type="file" id="pay-receipt">
        <button class="success-btn" onclick="finalizePayment()">Confirm</button>
        <button class="delete-btn" onclick="showView('premium-services-list')">Cancel</button>
    </div>

    <!-- 18. Feedback Center -->
    <div class="section" id="feedback-center">
        <h2 id="title-feedback">ğŸ“ á‹¨áŠ áˆµá‰°á‹«á‹¨á‰µ áˆ›á‹•áŠ¨áˆ</h2>
        <button class="main-btn" onclick="handleFeedback('text')" id="btn-fb-text">á‰ á…áˆá</button>
        <button class="feature-btn" onclick="handleFeedback('voice')" id="btn-fb-voice">á‰ á‹µáˆá…</button>
        <button class="premium-btn" onclick="handleFeedback('video')" id="btn-fb-video">á‰ á‰ªá‹²á‹®</button>
        <input type="file" id="feedback-media-input" style="display:none;">
        <hr>
        <button class="social-btn" onclick="showAllFeedbacks()" id="btn-see-fb">ğŸ“‚ á‹¨á‰°áˆ°áŒ¡ áŠ áˆµá‰°á‹«á‹¨á‰¶á‰½áŠ• áˆˆáˆ˜áˆ˜áˆáŠ¨á‰µ</button>
        <div id="all-feedbacks-container" style="display:none; margin-top:10px;"></div>
        <button class="delete-btn" onclick="showView('dashboard-view')">á‰°áˆ˜áˆˆáˆµ</button>
    </div>

    <!-- 19. Delete List -->
    <div class="section" id="delete-files-view">
        <h2 id="title-delete">ğŸ—‘ï¸ á‹á‹­áˆ áˆ˜á‹°áˆˆá‰µ</h2>
        <div id="delete-list"></div>
        <button class="delete-btn" onclick="showView('dashboard-view')">á‰°áˆ˜áˆˆáˆµ</button>
    </div>

    <!-- 20. Chat & Group Views (Simplified but functional) -->
    <div class="section" id="private-chat-view">
        <h2>ğŸ’¬ á‹¨áŒáˆ á‹á‹­á‹­á‰µ</h2>
        <div id="chat-messages" style="height:200px; overflow-y:auto; border:1px solid #ddd; margin-bottom:10px;"></div>
        <input type="text" id="chat-input" placeholder="Message...">
        <button class="main-btn" onclick="sendChat()">Send</button>
        <button class="feature-btn" onclick="triggerChatMedia()">Media</button>
        <button class="delete-btn" onclick="showView('dashboard-view')">Back</button>
    </div>

    <div class="section" id="my-groups-view">
        <h2>ğŸ“‚ áŒáˆ©á–á‰½</h2>
        <div id="my-groups-list"></div>
        <button class="delete-btn" onclick="showView('dashboard-view')">Back</button>
    </div>

    <script>
        // --- Translations Dictionary (Full) ---
        const dictionary = {
            'am': {
                'title-agreement': 'áŠ¥áŠ•áŠ³áŠ• á‹ˆá‹° á‹áˆ²áˆ á‹Œá‰¥ á‰ á‹°áˆ…áŠ“ áˆ˜áŒ¡',
                'txt-intro': 'á‹áˆ²áˆ á‹Œá‰¥ áŠ á• á‹²áŒ‚á‰³áˆ áˆ˜áŒ‹áˆªá‹«á£ á“á‹ˆáˆ­ á–á‹­áŠ•á‰µá£ á’á‹²áŠ¤á áŠ¥áŠ“ á‹“áˆˆáˆ áŠ á‰€á á‹¨áŠ­áá‹« áŠ áŒˆáˆáŒáˆá‰¶á‰½áŠ• á‹¨á‹«á‹˜ áˆ˜á‹µáˆ¨áŠ­ áŠá‹á¢',
                'title-rules': 'âš ï¸ áŒ¥á‰¥á‰… áˆ˜áˆ˜áˆªá‹«',
                'txt-rules': 'á–áˆˆá‰²áŠ«á‹Š áŒáŒ­á‰µá£ á‹¨áˆƒá‹­áˆ›áŠ–á‰µ áŒ¥áˆ‹á‰» áŠ¥áŠ“ á‹˜áˆ¨áŠáŠá‰µ áˆ›áˆ«áˆ˜á‹µ á‰ áŒ¥á‰¥á‰… á‹¨á‰°áŠ¨áˆˆáŠ¨áˆˆ áŠá‹á¢',
                'prompt-agree': 'á‹­á‰€á‰ áˆ‹áˆ‰?',
                'btn-agree': 'âœ… áŠ¥áˆµáˆ›áˆ›áˆˆáˆ',
                'btn-disagree': 'âŒ áŠ áˆáˆµáˆ›áˆ›áˆ',
                'title-home': 'á‹¨áˆ˜áŒá‰¢á‹« áˆáˆ­áŒ«',
                'prompt-use': 'áŠ¥áŠ•á‹´á‰µ áˆ˜áŒ á‰€áˆ á‹­áˆáˆáŒ‹áˆ‰?',
                'btn-signup-home': 'á‰ áŠáƒ áˆˆáˆ˜áˆ˜á‹áŒˆá‰¥ / áˆˆáˆ˜áŒá‰£á‰µ',
                'btn-premium-home': 'á‰ áŠ­áá‹« áŠ áˆ›áˆ«áŒ­ áˆˆáˆ˜áˆ˜á‹áŒˆá‰¥',
                'btn-back-home': 'á‹ˆá‹° áˆ˜áˆ˜áˆªá‹« á‰°áˆ˜áˆˆáˆµ',
                'title-signup': 'áŠ á‹²áˆµ áˆá‹áŒˆá‰£',
                'btn-register': 'áˆ˜á‹áŒá‰¥',
                'link-login': 'á‰°áˆ˜á‹áŒá‰ á‹‹áˆ? á‹­áŒá‰¡',
                'title-login': 'áˆ˜áŒá‰¢á‹«',
                'btn-login': 'áŒá‰£',
                'link-signup': 'áŠ á‹²áˆµ á‰°áŒ á‰ƒáˆš? á‹­áˆ˜á‹áŒˆá‰¡',
                'title-dash': 'á‹³áˆ½á‰¦áˆ­á‹µ',
                'sub-services': 'áŠ áŒˆáˆáŒáˆá‰¶á‰½:',
                'btn-view': 'ğŸ“„ áˆ˜áˆ¨áŒƒ áˆ˜áˆ˜áˆáŠ¨á‰µ',
                'btn-post': 'âœï¸ áˆ˜áˆ¨áŒƒ áˆ˜áˆˆáŒ á',
                'btn-users': 'ğŸ‘¥ á‹¨á‹áˆ²áˆ á‹Œá‰¥ áŠ á• á‰°áŒ á‰ƒáˆšá‹á‰½',
                'btn-group': 'ğŸ‘¥ á‰¡á‹µáŠ• áˆˆáˆ˜ááŒ áˆ­',
                'btn-mygroups': 'ğŸ“‚ á‹¨áˆáŒ áˆ©á‰µáŠ• áŒáˆ©á• áˆˆáˆ˜áˆ˜áˆáŠ¨á‰µ',
                'btn-chat': 'ğŸ’¬ á‰ á‹áˆµáŒ¥ áˆ˜áˆµáˆ˜áˆ­ áˆ›á‹áˆ«á‰µ',
                'btn-feedback': 'ğŸ“ áŠ áˆµá‰°á‹«á‹¨á‰µ áˆˆáˆ˜áˆµáŒ á‰µ áŠ¥áŠ“ áˆˆáˆ˜áˆ˜áˆáŠ¨á‰µ',
                'btn-business': 'ğŸ’° á‰¢á‹áŠáˆµ áˆ›á‹•áŠ¨áˆ',
                'btn-premium': 'â­ï¸ á‹¨áŠ­áá‹« áŠ áŒˆáˆáŒáˆá‰¶á‰½',
                'btn-delete-posts': 'ğŸ—‘ï¸ á‹¨áˆˆáŒ á‰á‰µáŠ• áˆ˜áˆ¨áŒƒ áˆ˜á‹°áˆˆá‰µ',
                'btn-logout': 'á‹áŒ£',
                'title-post-select': 'âœï¸ áˆáŠ• áˆ˜áˆˆáŒ á á‹­áˆáˆáŒ‹áˆ‰?',
                'btn-post-text': 'ğŸ“ á…áˆá',
                'btn-post-image': 'ğŸ“· áˆáˆµáˆ',
                'btn-post-video': 'ğŸ¥ á‰ªá‹²á‹®',
                'btn-post-audio': 'ğŸ™ï¸ á‹µáˆá…',
                'title-view-select': 'ğŸ“„ áˆáŠ• áˆ˜áˆ˜áˆáŠ¨á‰µ á‹­áˆáˆáŒ‹áˆ‰?',
                'btn-view-text': 'ğŸ“ á…áˆá',
                'btn-view-image': 'ğŸ“· áˆáˆµáˆ',
                'btn-view-video': 'ğŸ¥ á‰ªá‹²á‹®',
                'btn-view-audio': 'ğŸ™ï¸ á‹µáˆá…'
            },
            'en': {
                'title-agreement': 'Welcome to Fasil Web App',
                'txt-intro': 'Fasil Web App is a digital sharing platform with PowerPoint, PDF, and International Payment services.',
                'title-rules': 'âš ï¸ Strict Policy',
                'txt-rules': 'Political conflict, religious hatred, and racism are strictly prohibited.',
                'prompt-agree': 'Do you accept?',
                'btn-agree': 'âœ… I Agree',
                'btn-disagree': 'âŒ I Disagree',
                'title-home': 'Login Selection',
                'prompt-use': 'How do you want to use it?',
                'btn-signup-home': 'Register / Login for Free',
                'btn-premium-home': 'Register for Premium',
                'btn-back-home': 'Back to Policy',
                'title-signup': 'New Registration',
                'btn-register': 'Register',
                'link-login': 'Already registered? Login',
                'title-login': 'Login',
                'btn-login': 'Login',
                'link-signup': 'New User? Register',
                'title-dash': 'Dashboard',
                'sub-services': 'Services:',
                'btn-view': 'ğŸ“„ View Info',
                'btn-post': 'âœï¸ Post Info',
                'btn-users': 'ğŸ‘¥ Fasil Web App Users',
                'btn-group': 'ğŸ‘¥ Create Group',
                'btn-mygroups': 'ğŸ“‚ View My Groups',
                'btn-chat': 'ğŸ’¬ Private Chat',
                'btn-feedback': 'ğŸ“ Give & View Feedback',
                'btn-business': 'ğŸ’° Business Center',
                'btn-premium': 'â­ï¸ Premium Services',
                'btn-delete-posts': 'ğŸ—‘ï¸ Delete My Posts',
                'btn-logout': 'Log Out',
                'title-post-select': 'âœï¸ What to Post?',
                'btn-post-text': 'ğŸ“ Text',
                'btn-post-image': 'ğŸ“· Image',
                'btn-post-video': 'ğŸ¥ Video',
                'btn-post-audio': 'ğŸ™ï¸ Audio',
                'title-view-select': 'ğŸ“„ What to View?',
                'btn-view-text': 'ğŸ“ Text',
                'btn-view-image': 'ğŸ“· Image',
                'btn-view-video': 'ğŸ¥ Video',
                'btn-view-audio': 'ğŸ™ï¸ Audio'
            }
        };

        // --- State ---
        let currentLang = 'am';
        let currentUser = JSON.parse(localStorage.getItem('fasil_user')) || null;
        let users = JSON.parse(localStorage.getItem('fasil_users')) || [];
        let posts = JSON.parse(localStorage.getItem('fasil_posts')) || [];
        let groups = JSON.parse(localStorage.getItem('fasil_groups')) || [];
        let feedbacks = JSON.parse(localStorage.getItem('fasil_admin_feedbacks')) || [];
        let activePostType = 'text'; 
        let pendingAction = null;
        const RATES = { USD: 120, GBP: 150, EUR: 130 };

        // --- Core Functions ---
        function toggleLanguage() {
            currentLang = currentLang === 'am' ? 'en' : 'am';
            const texts = dictionary[currentLang];
            for (const id in texts) {
                const el = document.getElementById(id);
                if (el) el.textContent = texts[id];
            }
        }

        function showView(id) {
            document.querySelectorAll('.section').forEach(el => el.style.display = 'none');
            document.getElementById(id).style.display = 'block';
            if (id === 'business-dashboard') updateBalanceDisplay();
        }

        function showAlert(msg, type) {
            const modal = document.getElementById('custom-modal');
            document.getElementById('modal-title').textContent = type === 'error' ? "âŒ" : "âœ…";
            document.getElementById('modal-text').textContent = msg;
            modal.style.display = 'flex';
        }
        function closeModal() { document.getElementById('custom-modal').style.display = 'none'; }

        function checkAuthAndRedirect(target) {
            if(!currentUser) showView('login-form');
            else showView(target);
        }
        function checkFreeSignupForPremium() {
            if(!currentUser) { showAlert("Sign up first.", "error"); showView('signup-form'); }
            else showView('premium-services-list');
        }

        // --- Auth ---
        function handleSignUp() {
            const name = document.getElementById('signup-name').value;
            const phone = document.getElementById('signup-phone').value;
            const email = document.getElementById('signup-email').value;
            const pass = document.getElementById('signup-password').value;
            
            if(!email.endsWith("@gmail.com")) { showAlert("Email must be @gmail.com", "error"); return; }
            if(users.some(u => u.phone === phone)) { showAlert("Phone taken", "error"); return; }
            
            users.push({ name, phone, email, password: pass, balanceUSD: 0, balanceGBP: 0, balanceEUR: 0, photo: '' });
            localStorage.setItem('fasil_users', JSON.stringify(users));
            showAlert("Registered!", "success");
            showView('login-form');
        }

        function handleLogin() {
            const p = document.getElementById('login-phone').value;
            const pass = document.getElementById('login-password').value;
            const u = users.find(user => user.phone === p && user.password === pass);
            if(u) {
                currentUser = u;
                if(currentUser.balanceUSD === undefined) { currentUser.balanceUSD=0; currentUser.balanceGBP=0; currentUser.balanceEUR=0; }
                localStorage.setItem('fasil_user', JSON.stringify(currentUser));
                showView('dashboard-view');
            } else showAlert("Invalid credentials", "error");
        }
        function handleLogout() { currentUser = null; localStorage.removeItem('fasil_user'); showView('home-view'); }

        // --- Posts ---
        function openPostForm(type) {
            activePostType = type;
            document.getElementById('file-upload-area').style.display = type === 'text' ? 'none' : 'block';
            showView('post-form-view');
        }

        function handlePostSubmit() {
            const title = document.getElementById('post-title').value;
            const content = document.getElementById('post-content').value;
            const file = document.getElementById('post-file').files[0];

            if(!title) { showAlert("Title needed", "error"); return; }

            const save = (data) => {
                posts.unshift({
                    id: Date.now(), title, content, fileData: data, type: activePostType,
                    uploaderPhone: currentUser.phone, uploaderName: currentUser.name, comments: []
                });
                localStorage.setItem('fasil_posts', JSON.stringify(posts));
                showAlert("Posted!", "success");
                showView('dashboard-view');
            };

            if(activePostType !== 'text' && file) {
                const r = new FileReader();
                r.onload = e => save(e.target.result);
                r.readAsDataURL(file);
            } else save(null);
        }

        function displayPosts(type) {
            const container = document.getElementById('posts-container');
            container.innerHTML = '';
            const filtered = posts.filter(p => p.type === type);
            
            if(filtered.length === 0) {
                container.innerHTML = "<p>á‹¨áˆˆáˆ (No posts found).</p>";
            } else {
                filtered.forEach(p => {
                    let media = '';
                    if(p.fileData) {
                        if(p.type === 'image') media = `<img src="${p.fileData}" style="width:100%">`;
                        else if(p.type === 'video') media = `<video src="${p.fileData}" controls style="width:100%"></video>`;
                        else if(p.type === 'audio') media = `<audio src="${p.fileData}" controls style="width:100%"></audio>`;
                    }
                    const div = document.createElement('div');
                    div.className = 'post-card';
                    div.style.display = 'block';
                    div.innerHTML = `<h3>${p.title}</h3><p>${p.content}</p>${media}
                    <button class="feature-btn" style="padding:5px;" onclick="alert('Comment (Demo)')">Comment</button>`;
                    container.appendChild(div);
                });
            }
            showView('posts-viewer');
        }

        // --- Delete Own Posts ---
        function showDeleteList() {
            const container = document.getElementById('delete-list');
            container.innerHTML = '';
            const myPosts = posts.filter(p => p.uploaderPhone === currentUser.phone);
            if(myPosts.length === 0) container.innerHTML = "<p>No posts.</p>";
            myPosts.forEach(p => {
                const d = document.createElement('div');
                d.className = 'post-card';
                d.innerHTML = `<b>${p.title}</b> <button class="delete-btn" onclick="deletePost(${p.id})">Delete</button>`;
                container.appendChild(d);
            });
            showView('delete-files-view');
        }
        function deletePost(id) {
            posts = posts.filter(p => p.id !== id);
            localStorage.setItem('fasil_posts', JSON.stringify(posts));
            showDeleteList();
        }

        // --- User List ---
        function showUserList(isSelection) {
            const container = document.getElementById('user-list-container');
            container.innerHTML = '';
            users.forEach(u => {
                if(u.phone === currentUser.phone) return;
                const d = document.createElement('div');
                d.className = 'user-card';
                d.innerHTML = `<b>${u.name}</b>`;
                if(isSelection) {
                    d.style.cursor = 'pointer';
                    d.onclick = () => d.classList.toggle('selected');
                }
                container.appendChild(d);
            });
            document.getElementById('user-list-done-btn').style.display = isSelection ? 'block' : 'none';
            showView('user-list-view');
        }

        // --- Groups ---
        function handleGroupCreation() {
            const name = prompt("Enter Group Name:");
            if(!name) return;
            showUserList(true);
            const btn = document.getElementById('user-list-done-btn');
            btn.onclick = () => {
                const selected = document.querySelectorAll('.user-card.selected');
                if(selected.length < 2) { showAlert("Select at least 2 users.", "error"); return; }
                groups.push({ id: Date.now(), name, creator: currentUser.phone });
                localStorage.setItem('fasil_groups', JSON.stringify(groups));
                showAlert("Group Created!", "success");
                showView('dashboard-view');
            };
        }
        function showMyGroupsList() {
            const c = document.getElementById('my-groups-list');
            c.innerHTML = groups.length ? '' : 'No groups';
            groups.forEach(g => {
                 c.innerHTML += `<div class="user-card"><b>${g.name}</b></div>`;
            });
            showView('my-groups-view');
        }

        // --- Business ---
        function updateBalanceDisplay() {
            document.getElementById('main-usd').textContent = currentUser.balanceUSD.toFixed(2);
            document.getElementById('bal-gbp').textContent = currentUser.balanceGBP.toFixed(2);
            document.getElementById('bal-eur').textContent = currentUser.balanceEUR.toFixed(2);
            const total = currentUser.balanceUSD + (currentUser.balanceGBP*1.25) + (currentUser.balanceEUR*1.1);
            document.getElementById('total-est-usd').textContent = total.toFixed(2);
        }
        function handleDeposit() {
            const etb = parseFloat(document.getElementById('deposit-etb').value);
            const curr = document.getElementById('deposit-target-currency').value;
            if(!etb || etb<100) return showAlert("Min 100 ETB", "error");
            const amt = etb / RATES[curr];
            if(curr==='USD') currentUser.balanceUSD+=amt;
            if(curr==='GBP') currentUser.balanceGBP+=amt;
            if(curr==='EUR') currentUser.balanceEUR+=amt;
            localStorage.setItem('fasil_user', JSON.stringify(currentUser));
            showAlert("Deposited!", "success");
            showView('business-dashboard');
        }
        function initiateWithdraw() {
            document.getElementById('password-modal').style.display = 'flex';
            pendingAction = () => {
                const amt = parseFloat(document.getElementById('withdraw-amount').value);
                currentUser.balanceUSD -= amt; // Simplified
                localStorage.setItem('fasil_user', JSON.stringify(currentUser));
                showAlert("Withdrawn!", "success");
                showView('business-dashboard');
            };
        }
        function confirmActionWithPassword() {
            const p = document.getElementById('modal-password-input').value;
            if(p === currentUser.password) {
                document.getElementById('password-modal').style.display='none';
                if(pendingAction) pendingAction();
            } else alert("Wrong password");
        }
        function handleIntlPurchase() {
            document.getElementById('password-modal').style.display = 'flex';
            pendingAction = () => {
                const amt = parseFloat(document.getElementById('intl-amount').value);
                currentUser.balanceUSD -= amt;
                localStorage.setItem('fasil_user', JSON.stringify(currentUser));
                showAlert("Purchased!", "success");
                showView('business-dashboard');
            };
        }

        // --- Feedback ---
        function handleFeedback(type) {
            const c = type==='text' ? prompt("Feedback:") : "Media Uploaded";
            if(c) {
                feedbacks.push({ type, content: c, user: currentUser.name });
                localStorage.setItem('fasil_admin_feedbacks', JSON.stringify(feedbacks));
                showAlert("Sent!", "success");
            }
        }
        function showAllFeedbacks() {
            const c = document.getElementById('all-feedbacks-container');
            c.style.display='block';
            c.innerHTML = feedbacks.map(f => `<div><b>${f.user}:</b> ${f.content} (${f.type})</div>`).join('');
        }

        // --- Other ---
        function openPricingModal(s) { document.getElementById('pricing-service-name').textContent=s; showView('pricing-view'); }
        function processPayment(amt) { showView('payment-confirm-view'); }
        function finalizePayment() { showAlert("Paid!", "success"); showView('main-dashboard'); }
        function handlePrivateChatStart() { showUserList(false); }
        function sendChat() { alert("Message Sent"); }
        function triggerChatMedia() { alert("Media Selected"); }

        // Init
        document.getElementById('loading-overlay').style.display = 'none';
        toggleLanguage(); // set initial text
    </script>
</body>
</html>
