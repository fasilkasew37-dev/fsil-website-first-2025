<!DOCTYPE html>
<html lang="am">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>рЇІрѕ▓рѕЇ рІїрЅЦ ріарЇЋ - Fasil Web App (V13.0)</title>
    <style>
        /* --- рѕўрІ░рЅаріЏ CSS --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            text-align: center;
            padding: 20px;
            background-color: #f0f4f8;
            color: #333;
        }
        .section {
            max-width: 700px;
            margin: 40px auto;
            padding: 30px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
            border-top: 6px solid #007bff;
            text-align: left;
            display: none;
        }
        h1 { color: #007bff; font-size: 32px; margin-bottom: 10px; text-align: center; }
        h2 { color: #555; font-size: 24px; margin-top: 25px; margin-bottom: 25px; text-align: center; }
        
        /* --- рІерїЇрЅЦрІЊрЅх рѕхрЅ│рІГрѕјрЅй --- */
        input[type="text"], input[type="email"], input[type="password"], select, textarea {
            width: 90%;
            padding: 15px;
            margin: 10px 0;
            border: 1px solid #ccc;
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 16px;
        }
        
        /* --- рІеріарІЮрѕФрѕГ рѕўрѕ░рѕерЅх (Stacked Layout) --- */
        .button-link, button {
            display: block;
            width: 90%;
            padding: 18px;
            margin: 15px auto;
            text-align: center;
            border-radius: 10px;
            text-decoration: none;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            font-size: 18px;
            border: none;
        }

        /* --- рІеріарІЮрѕФрѕГ рЅђрѕѕрѕърЅй --- */
        .main-btn { background-color: #007bff; color: white; }
        .success-btn { background-color: #28a745; color: white; }
        .delete-btn { background-color: #dc3545; color: white; }
        .premium-btn { background-color: #ffc107; color: #333; }

        /* --- ріФрѕГрІХрЅй ріЦріЊ рѕЇрІЕ рЅдрЅ│рІјрЅй --- */
        .intro-text-box {
            background-color: #e9ecef;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 25px;
            border-left: 5px solid #007bff;
        }
        .alert-box {
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
            text-align: center;
            font-weight: bold;
        }
        .error-alert { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }

        /* --- Loading Spinner --- */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            flex-direction: column;
        }
        .spinner {
            border: 8px solid #f3f3f3;
            border-top: 8px solid #007bff;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* --- рІерЇЋрѕІріЋ ріФрѕГрІх --- */
        .plan-card {
            padding: 20px;
            border: 2px solid #007bff;
            border-radius: 10px;
            margin-bottom: 15px;
            text-align: center;
            cursor: pointer;
            transition: background-color 0.3s;
        }
    </style>
</head>
<body>

    <div class="loading-overlay" id="loading-overlay">
        <div class="spinner"></div>
        <p id="loading-message">... ріЦрІерЅ░рїФріљ ріљрІЇ (Loading) ...</p>
    </div>

    <div class="section" id="home-view">
        <h1>рЇІрѕ▓рѕЇ рІїрЅЦ ріарЇЋ - Fasil Web App</h1>
        <div class="intro-text-box">
            <h3>­Ъїљ рѕхрѕѕ рЇІрѕ▓рѕЇ рІїрЅЦ ріарЇЋ</h3>
            <p><strong>рЇІрѕ▓рѕЇ рІїрЅЦ ріарЇЋ</strong> рЅарЅ░ріарѕЏріњріљрЅх ріЦріЋрІ▓рѕ░рѕФ рІерЅ░рЅђрІерѕ░ рІерІ▓рїѓрЅ│рѕЇ рѕўрїІрѕфрІФ рѕўрІхрѕеріГ ріљрІЇрЇб</p>
        </div>
        
        <h2 style="text-align: center;">ріЦріЋрІ┤рЅх рѕўрїарЅђрѕЮ рІГрЇѕрѕЇрїІрѕЅ?</h2>
        
        <a href="#signup-form" class="button-link main-btn" onclick="updateView()">рЅаріљрЇЃ рѕѕрѕўрѕўрІЮрїѕрЅЦ / рѕѕрѕўрїЇрЅБрЅх</a>
        <a href="#pricing" class="button-link premium-btn">рЅаріГрЇЇрІФ ріарѕЏрѕФрїГ рѕѕрѕўрѕўрІЮрїѕрЅЦ</a>
    </div>

    <div class="section" id="signup-form">
        <h2 id="signup-title">ріарІ▓рѕх рЅ░рїарЅЃрѕџ рІГрѕўрІЮрїѕрЅА (ріљрЇЃ)</h2>
        <div class="alert-box error-alert" id="signup-error" style="display: none;"></div>
        
        <input type="text" id="signup-name" placeholder="рѕЎрѕЅ рѕхрѕЮ" required>
        <input type="text" id="signup-phone" placeholder="рѕхрѕЇріГ рЅЂрїЦрѕГ (рѕѕрѕўрїЇрЅбрІФ/Login)" required>
        <input type="email" id="signup-email" placeholder="рібрѕюрѕЇ" required>
        <input type="password" id="signup-password" placeholder="рІерІГрѕѕрЇЇ рЅЃрѕЇ (рЅБрѕѕ 6 ріарѕђрІЮ)" required maxlength="6">
        
        <button class="main-btn" onclick="handleSignUp()">рѕўрІЮрїЇрЅЦ (Sign Up)</button>
        
        <p style="text-align: center; margin-top: 20px;"><a href="#login-form" onclick="updateView()">рІерЅ░рѕўрІўрїѕрЅА рЅ░рїарЅЃрѕџ ріерѕєріЉ рІГрїЇрЅА (Log In)</a></p>
    </div>

    <div class="section" id="login-form">
        <h2>рѕўрїЇрЅбрІФ (Log In)</h2>
        <div class="alert-box error-alert" id="login-error" style="display: none;"></div>
        <input type="text" id="login-phone" placeholder="рѕхрѕЇріГ рЅЂрїЦрѕГ" required>
        <input type="password" id="login-password" placeholder="рІерІГрѕѕрЇЇ рЅЃрѕЇ" required>
        
        <button class="success-btn" onclick="handleLogin()">рїЇрЅБ (Log In)</button>
        
        <p style="text-align: center; margin-top: 20px;"><a href="#signup-form" onclick="updateView()">ріарІ▓рѕх рЅ░рїарЅЃрѕџ? рІГрѕўрІЮрїѕрЅА (Sign Up)</a></p>
    </div>

    <div class="section" id="free-dashboard">
        <h1>ріљрЇЃ рІеріарїѕрѕЇрїЇрѕјрЅх рѕЏрІЋріерѕЇ (Dashboard)</h1>
        
        <h2 style="margin-top: 30px;">рІІріЊ рЅ░рїЇрЅБрѕФрЅх:</h2>
        
        <a href="#view-select" class="button-link main-btn" onclick="updateView()">
            ­ЪЊё рѕўрѕерїЃ рѕўрѕўрѕЇріерЅх (View)
        </a>
        <a href="#post-select" class="button-link main-btn" onclick="updateView()">
            РюЇ№ИЈ рѕўрѕерїЃ рѕўрѕѕрїарЇЇ / рѕЏрїІрѕФрЅх (Post/Share)
        </a>
        <a href="#delete-select" class="button-link delete-btn" onclick="updateView()">
            ­ЪЌЉ№ИЈ рІерѕѕрїарЇЅрЅхріЋ рѕўрѕерїЃ рѕўрІ░рѕѕрЅх (Delete)
        </a>

        <a href="#home-view" class="button-link delete-btn" style="background-color: #6c757d; margin-top: 40px;">рІѕрІ░ рѕўріљрѕ╗ рЅ░рѕўрѕѕрѕх</a>
    </div>

    <div class="section" id="premium-dashboard">
        <h1>РГљ№ИЈ рІеріГрЇЇрІФ рІеріарїѕрѕЇрїЇрѕјрЅх рѕЏрІЋріерѕЇ (Premium Dashboard)</h1>
        
        <h2 style="margin-top: 30px;">рЇЋрѕфрѕџрІерѕЮ рЅ░рїЇрЅБрѕФрЅх:</h2>
        
        <button class="main-btn">
            ­ЪЊі рЇЊрІѕрѕГ рЇќрІГріЋрЅх рѕЏрІўрїІрїђрЅх
        </button>
        <button class="main-btn">
            ­ЪЊё рЇњрІ▓ріцрЇЇ рѕўрѕѕрїарЇЇ / рѕЏрІўрїІрїђрЅх
        </button>
        
        <h2 style="margin-top: 30px;">рѕўрѕ░рѕерЅ│рІі рЅ░рїЇрЅБрѕФрЅх:</h2>

        <a href="#view-select" class="button-link success-btn" onclick="updateView()">
            ­ЪЊё рѕўрѕерїЃ рѕўрѕўрѕЇріерЅх (View)
        </a>
        <a href="#post-select" class="button-link success-btn" onclick="updateView()">
            РюЇ№ИЈ рѕўрѕерїЃ рѕўрѕѕрїарЇЇ / рѕЏрїІрѕФрЅх (Post/Share)
        </a>
        <a href="#delete-select" class="button-link delete-btn" onclick="updateView()">
            ­ЪЌЉ№ИЈ рІерѕѕрїарЇЅрЅхріЋ рѕўрѕерїЃ рѕўрІ░рѕѕрЅх (Delete)
        </a>

        <a href="#home-view" class="button-link delete-btn" style="background-color: #6c757d; margin-top: 40px;">рІѕрІ░ рѕўріљрѕ╗ рЅ░рѕўрѕѕрѕх</a>
    </div>

    <div class="section" id="pricing">
        <h2>рІеріГрЇЇрІФ ріарѕЏрѕФрї«рЅй (Premium Plans)</h2>
        <p style="text-align: center;">рІГрѕЁріЋ рІеріГрЇЇрІФ ріарѕЏрѕФрїГ ріерѕўрѕерїА рІѕрІ░ рѕўріГрЇѕрІФ рІЮрѕГрІЮрѕГ рІГрІѕрѕхрІхрІјрЅ│рѕЇрЇб</p>
        
        <div class="plan-card" onclick="selectPlan('daily')"><h3>рІЋрѕѕрЅ│рІі (Daily)</h3><p>5 рЅЦрѕГ (ETB)</p><button class="success-btn" style="width: 80%; padding: 10px;">рІГрѕЁріЋ рѕЮрѕерїЦ</button></div>
        <div class="plan-card" onclick="selectPlan('monthly')"><h3>рІѕрѕГрѕЃрІі (Monthly)</h3><p>30 рЅЦрѕГ (ETB)</p><button class="success-btn" style="width: 80%; padding: 10px;">рІГрѕЁріЋ рѕЮрѕерїЦ</button></div>
        <div class="plan-card" onclick="selectPlan('yearly')"><h3>рІЊрѕўрЅ│рІі (Yearly)</h3><p>100 рЅЦрѕГ (ETB)</p><button class="success-btn" style="width: 80%; padding: 10px;">рІГрѕЁріЋ рѕЮрѕерїЦ</button></div>
        
        <a href="#home-view" class="button-link delete-btn">рІѕрІ░ рѕўріљрѕ╗ рЅ░рѕўрѕѕрѕх</a>
    </div>
    
    <div class="section" id="payment-methods">
        <h2>ріГрЇЇрІФ рІГрЇѕрЇЁрѕЎ (Payment)</h2>
        <p id="selected-plan-info" style="font-weight: bold; color: #007bff; text-align: center;"></p>
        
        <p style="text-align: center; margin-top: 20px;">рЅарІерЅхріЏрІЇ рІерѕўріГрЇѕрІФ рІўрІ┤ рѕўріГрЇѕрѕЇ рІГрЇѕрѕЇрїІрѕЅ?</p>

        <button class="main-btn" onclick="processPayment('Telebirr')">рЅарЅ┤рѕїрЅЦрѕГ (Telebirr) рІГріГрЇѕрѕЅ</button>
        <button class="main-btn" onclick="processPayment('CBE')">рЅаCBE рІерЅБріЋріГ рІЮрІЇрІЇрѕГ рІГріГрЇѕрѕЅ</button>
        <button class="main-btn" onclick="processPayment('PayPal')">рЅарЇћрІГрЇЊрѕЇ (PayPal) рІГріГрЇѕрѕЅ</button>

        <a href="#pricing" class="button-link delete-btn">рІѕрІ░ рЇЋрѕІріќрЅй рЅ░рѕўрѕѕрѕх</a>
    </div>

    <div class="section" id="view-select">
        <h2>­ЪЊё рѕўрѕерїЃ рѕўрѕўрѕЇріерЅх</h2>
        <p>рІерЅхріЏрІЇріЋ ріарІГріљрЅх рѕўрѕерїЃ рѕўрѕўрѕЇріерЅх рІГрЇѕрѕЇрїІрѕЅ?</p>
        
        <a href="#view-text" class="button-link main-btn" onclick="updateView()">рЇЁрѕЂрЇЇ / рЅ┤ріГрѕхрЅх</a>
        <a href="#view-image" class="button-link main-btn" onclick="updateView()">рѕЮрѕхрѕЇ / рЇјрЅХ</a>
        <a href="#view-audio" class="button-link main-btn" onclick="updateView()">рЅфрІ▓рІ« / рідрІ▓рІ«</a>
        
        <button class="delete-btn" onclick="goBackToDashboard()">рІѕрІ░ ріІрѕІ рЅ░рѕўрѕѕрѕх</button>
    </div>
    
    <div class="section" id="post-select">
        <h2>РюЇ№ИЈ рѕўрѕерїЃ рѕўрѕѕрїарЇЇ / рѕЏрїІрѕФрЅх</h2>
        <p>рІерЅхріЏрІЇріЋ ріарІГріљрЅх рІГрІўрЅх рѕўрѕѕрїарЇЇ рІГрЇѕрѕЇрїІрѕЅ?</p>
        
        <a href="#post-text" class="button-link main-btn" onclick="updateView()">рЇЁрѕЂрЇЇ / рЅ┤ріГрѕхрЅх рѕѕрѕўрѕѕрїарЇЇ</a>
        <a href="#post-image" class="button-link main-btn" onclick="updateView()">рѕЮрѕхрѕЇ / рЇјрЅХ рѕѕрѕўрѕѕрїарЇЇ</a>
        <a href="#post-audio" class="button-link main-btn" onclick="updateView()">рЅфрІ▓рІ« / рідрІ▓рІ« рѕѕрѕўрѕѕрїарЇЇ</a>
        
        <button class="delete-btn" onclick="goBackToDashboard()">рІѕрІ░ ріІрѕІ рЅ░рѕўрѕѕрѕх</button>
    </div>

    <div class="section" id="delete-select">
        <h2>­ЪЌЉ№ИЈ рІерѕѕрїарЇЅрЅхріЋ рѕўрѕерїЃ рѕўрІ░рѕѕрЅх</h2>
        <p>рІерЅхріЏрІЇріЋ ріарІГріљрЅх рѕўрѕерїЃ рѕўрІ░рѕѕрЅх рІГрЇѕрѕЇрїІрѕЅ?</p>
        
        <select id="delete-file-type" style="width: 90%; margin-bottom: 20px;">
            <option value="text">рЇЁрѕЂрЇЇ / рЅ┤ріГрѕхрЅх</option>
            <option value="image">рѕЮрѕхрѕЇ / рЇјрЅХ</option>
            <option value="audio">рЅфрІ▓рІ« / рідрІ▓рІ«</option>
        </select>
        
        <button class="delete-btn" onclick="showDeleteList()">рЇІрІГрѕјрЅй рІЮрѕГрІЮрѕГ ріарѕ│рІГ (рѕѕрѕўрІ░рѕѕрЅх)</button>
        <button class="main-btn" style="background-color: #6c757d;" onclick="goBackToDashboard()">рІѕрІ░ ріІрѕІ рЅ░рѕўрѕѕрѕх</button>
    </div>
    
    <div class="section" id="post-text">
        <h2>РюЇ№ИЈ ріарІ▓рѕх рїйрѕЉрЇЇ рѕѕрѕўрѕѕрїарЇЇ</h2>
        <input type="text" id="post-text-title" placeholder="рѕГрІЋрѕх (Title)" required>
        <textarea id="post-text-content" rows="10" placeholder="рЇЁрѕЉрЇЅріЋ ріЦрІџрѕЁ рІФрѕхрїѕрЅА..." required></textarea>
        <button class="main-btn" onclick="handlePost('text')">рІГрѕѕрїЦрЇЅ (Post Text)</button>
        <a href="#post-select" class="button-link delete-btn">рІѕрІ░ рѕўрѕѕрїарЇірІФ рѕЮрІхрЅЦ рЅ░рѕўрѕѕрѕх</a>
    </div>
    
    <div class="section" id="post-image">
        <h2>­Ъќ╝№ИЈ ріарІ▓рѕх рѕЮрѕхрѕЇ рѕѕрѕўрѕѕрїарЇЇ</h2>
        <input type="text" id="post-image-title" placeholder="рѕГрІЋрѕх (Title)" required>
        <label for="post-image-file" style="display: block; margin: 15px 0 5px; font-weight: bold; width: 90%; margin-left: 5%;">рІерѕџрѕѕрїЦрЇЅрЅхріЋ рѕЮрѕхрѕЇ рІГрѕЮрѕерїА</label>
        <input type="file" id="post-image-file" accept="image/*" style="width: 90%; margin-bottom: 20px;">
        <button class="main-btn" onclick="handlePost('image')">рІГрѕѕрїЦрЇЅ (Post Image)</button>
        <a href="#post-select" class="button-link delete-btn">рІѕрІ░ рѕўрѕѕрїарЇірІФ рѕЮрІхрЅЦ рЅ░рѕўрѕѕрѕх</a>
    </div>

    <div class="section" id="post-audio">
        <h2>­ЪјД ріарІ▓рѕх рЅфрІ▓рІ« / рідрІ▓рІ« рѕѕрѕўрѕѕрїарЇЇ</h2>
        <input type="text" id="post-audio-title" placeholder="рѕГрІЋрѕх (Title)" required>
        <label for="post-audio-file" style="display: block; margin: 15px 0 5px; font-weight: bold; width: 90%; margin-left: 5%;">рІерѕџрѕѕрїЦрЇЅрЅхріЋ рідрІ▓рІ«/рЅфрІ▓рІ« рІГрѕЮрѕерїА</label>
        <input type="file" id="post-audio-file" accept="audio/*,video/*" style="width: 90%; margin-bottom: 20px;">
        <button class="main-btn" onclick="handlePost('audio')">рІГрѕѕрїЦрЇЅ (Post Audio/Video)</button>
        <a href="#post-select" class="button-link delete-btn">рІѕрІ░ рѕўрѕѕрїарЇірІФ рѕЮрІхрЅЦ рЅ░рѕўрѕѕрѕх</a>
    </div>

    <div class="section" id="view-text">
        <h2>­ЪЊё рІерЅ░рѕѕрїарЇѕ рїйрѕЉрЇЇ/рѕўрѕерїЃ рѕўрѕўрѕЇріерЅх</h2>
        <div id="text-posts-container">
            <p style="text-align: center; color: #777;">рѕЮріЋрѕЮ рЇЁрѕЂрЇјрЅй рІерѕЅрѕЮрЇб</p>
        </div>
        <a href="#view-select" class="button-link delete-btn">рІѕрІ░ рѕўрѕўрѕЇріерЅ╗ рѕЮрІхрЅЦ рЅ░рѕўрѕѕрѕх</a>
    </div>
    
    <div class="section" id="view-image">
        <h2>­Ъќ╝№ИЈ рІерЅ░рѕѕрїарЇѕ рѕЮрѕхрѕЇ/рЇјрЅХ рѕўрѕўрѕЇріерЅх</h2>
        <div id="image-posts-container">
            <p style="text-align: center; color: #777;">рѕЮріЋрѕЮ рѕЮрѕхрѕјрЅй рІерѕЅрѕЮрЇб</p>
        </div>
        <a href="#view-select" class="button-link delete-btn">рІѕрІ░ рѕўрѕўрѕЇріерЅ╗ рѕЮрІхрЅЦ рЅ░рѕўрѕѕрѕх</a>
    </div>

    <div class="section" id="view-audio">
        <h2>­ЪјД рІерЅ░рѕѕрїарЇѕ рЅфрІ▓рІ«/рідрІ▓рІ« рѕўрѕўрѕЇріерЅх</h2>
        <div id="audio-posts-container">
            <p style="text-align: center; color: #777;">рѕЮріЋрѕЮ рЅфрІ▓рІ«/рідрІ▓рІ« рЇІрІГрѕјрЅй рІерѕЅрѕЮрЇб</p>
        </div>
        <a href="#view-select" class="button-link delete-btn">рІѕрІ░ рѕўрѕўрѕЇріерЅ╗ рѕЮрІхрЅЦ рЅ░рѕўрѕѕрѕх</a>
    </div>

    <div class="section" id="delete-file-view">
        <h2>­ЪЌЉ№ИЈ рІерЇІрІГрѕјрЅй рІЮрѕГрІЮрѕГ (рѕѕрѕўрІ░рѕѕрїЦ)</h2>
        <div id="deletable-posts-container">
            <p style="text-align: center; color: #777;">ріЦрѕГрѕхрІј рІерѕѕрїарЇЅрЅх рЇІрІГрѕЇ рІерѕѕрѕЮрЇб</p>
        </div>
        <a href="#delete-select" class="button-link delete-btn">рІѕрІ░ рѕўрІ░рѕѕрЅ╗ рѕЮрІхрЅЦ рЅ░рѕўрѕѕрѕх</a>
    </div>


    <script>
        let currentSubscription = 'free'; // 'free' or 'premium'
        let selectedPlan = null;
        let posts = JSON.parse(localStorage.getItem('fasil_app_posts') || '[]');

        // ==================================================
        // --- Utility Functions ---
        // ==================================================

        function showLoading(message) {
            document.getElementById('loading-message').textContent = message;
            document.getElementById('loading-overlay').style.display = 'flex';
        }

        function hideLoading() {
            document.getElementById('loading-overlay').style.display = 'none';
        }
        
        function goBackToDashboard() {
            if (currentSubscription === 'premium') {
                window.location.hash = '#premium-dashboard';
            } else {
                window.location.hash = '#free-dashboard';
            }
            updateView();
        }

        // ==================================================
        // --- User Management / Auth ---
        // ==================================================

        function setRegisteredUser(phone, password, tier, name) {
            let users = JSON.parse(localStorage.getItem('fasil_app_users') || '[]');
            
            const existingIndex = users.findIndex(u => u.phone === phone);

            if (existingIndex > -1) {
                const existingUser = users[existingIndex];
                const updatedUser = {
                    phone,
                    password: password !== null ? password : existingUser.password,
                    tier: tier || existingUser.tier,
                    name: name || existingUser.name || 'Guest User',
                };
                users[existingIndex] = updatedUser;
            } else {
                users.push({ phone, password, tier: tier || 'free', name: name || 'Guest User' });
            }
            
            localStorage.setItem('fasil_app_users', JSON.stringify(users));
            localStorage.setItem('fasil_current_user_phone', phone);
            currentSubscription = tier;
        }
        
        function checkExistingUser(phone) {
            const users = JSON.parse(localStorage.getItem('fasil_app_users') || '[]');
            return users.some(u => u.phone === phone);
        }
        
        function handleSignUp() {
            showLoading('рѕўрѕўрІЮрїѕрЅЦ...');
            
            const name = document.getElementById('signup-name').value.trim();
            const phone = document.getElementById('signup-phone').value.trim();
            const email = document.getElementById('signup-email').value.trim();
            const password = document.getElementById('signup-password').value.trim();

            const errorBox = document.getElementById('signup-error');
            errorBox.style.display = 'none';

            if (!phone || !email || !password || !name || password.length !== 6) {
                hideLoading();
                errorBox.textContent = 'рѕЂрѕЅріЋрѕЮ рѕўрѕхрі«рЅй рЅарЅхріГріГрѕЇ рІГрѕЎрѕЅ (рЇЊрѕхрІѕрѕГрІх 6 ріарѕђрІЮ рѕўрѕєріЋ ріарѕѕрЅарЅх)рЇб';
                errorBox.style.display = 'block';
                return;
            }
            
            if (checkExistingUser(phone)) {
                hideLoading();
                errorBox.textContent = 'Рџа№ИЈ рЅарІџрѕЁ рѕхрѕЇріГ рЅЂрїЦрѕГ рЅ░рѕўрІЮрїЇрЅарІІрѕЇрЇб рІхрїІрѕю рѕўрѕўрІЮрїѕрЅЦ ріарІГрЅ╗рѕЇрѕЮ! ріЦрЅБріГрІј рІГрїЇрЅАрЇб';
                errorBox.style.display = 'block';
                return;
            }

            setTimeout(() => {
                setRegisteredUser(phone, password, 'free', name);
                hideLoading();
                alert(`ріЦріЋрі│ріЋ рІ░рѕх ріарѕЇрІј! ${name} рЅ░рѕўрІЮрїЇрЅарІІрѕЇ! ріарѕЂріЋ рІѕрІ░ ріљрЇЃ рІ│рѕйрЅдрѕГрІх рІГрІѕрѕхрІ░рІјрЅ│рѕЇрЇб`);
                window.location.hash = '#free-dashboard';
                updateView();
            }, 1500);
        }

        function handleLogin() {
            showLoading('рѕўрїЇрЅБрЅх...');
            const phone = document.getElementById('login-phone').value.trim();
            const password = document.getElementById('login-password').value.trim();
            const errorBox = document.getElementById('login-error');
            errorBox.style.display = 'none';

            if (!phone || !password) {
                hideLoading();
                errorBox.textContent = 'рІерѕхрѕЇріГ рЅЂрїЦрѕГ ріЦріЊ рІерІГрѕѕрЇЇ рЅЃрѕЇ рІФрѕхрїѕрЅАрЇб';
                errorBox.style.display = 'block';
                return;
            }

            const users = JSON.parse(localStorage.getItem('fasil_app_users') || '[]');
            const user = users.find(u => u.phone === phone && u.password === password);

            setTimeout(() => {
                hideLoading();
                if (user) {
                    setRegisteredUser(phone, password, user.tier, user.name);
                    
                    if (user.tier === 'premium') {
                        window.location.hash = '#premium-dashboard';
                    } else {
                        window.location.hash = '#free-dashboard';
                    }
                    updateView();
                } else {
                    errorBox.textContent = 'рЅхріГріГрѕѕріЏ рІФрѕЇрѕєріљ рѕхрѕЇріГ рЅЂрїЦрѕГ рІѕрІГрѕЮ рІерІГрѕѕрЇЇ рЅЃрѕЇрЇб';
                    errorBox.style.display = 'block';
                }
            }, 1500);
        }

        function getCurrentUserPhone() {
            return localStorage.getItem('fasil_current_user_phone');
        }

        function getCurrentUserTier() {
            const phone = getCurrentUserPhone();
            if (!phone) return 'free';

            const users = JSON.parse(localStorage.getItem('fasil_app_users') || '[]');
            const user = users.find(u => u.phone === phone);
            return user ? user.tier : 'free';
        }

        // ==================================================
        // --- Premium / Payment ---
        // ==================================================

        function selectPlan(plan) {
            selectedPlan = plan;
            let price = '';
            if (plan === 'daily') price = '5 ETB (рІЋрѕѕрЅ│рІі)';
            if (plan === 'monthly') price = '30 ETB (рІѕрѕГрѕЃрІі)';
            if (plan === 'yearly') price = '100 ETB (рІЊрѕўрЅ│рІі)';

            document.getElementById('selected-plan-info').textContent = `рІерѕўрѕерїАрЅх рЇЋрѕІріЋ: ${price} (рѕѕрѕўріГрЇѕрѕЇ рІГрїФріЉ)`;
            window.location.hash = '#payment-methods';
            updateView();
        }
        
        function processPayment(method) {
            if (!getCurrentUserPhone()) {
                alert('ріЦрЅБріГрІј рЇЋрѕфрѕџрІерѕЮ ріерѕўрїЇрІЏрЅхрІј рЅарЇірЅх рІГрїЇрЅА/рІГрѕўрІЮрїѕрЅАрЇб');
                window.location.hash = '#login-form';
                updateView();
                return;
            }
            
            showLoading(`рЅа ${method} ріГрЇЇрІФ рЅарѕўрЇѕрЇђрѕЮ...`);

            setTimeout(() => {
                hideLoading();
                const phone = getCurrentUserPhone();
                if (phone) {
                    setRegisteredUser(phone, null, 'premium', null);
                    alert(`ріГрЇЇрІФ рЅ░рѕ│ріГрЅирѕЇ! рЅа ${method} рЅаріЕрѕЇ рЇЋрѕфрѕџрІерѕЮ рЅ░рїарЅЃрѕџ рѕєріљрІІрѕЇ!`);
                    window.location.hash = '#premium-dashboard';
                    updateView();
                } 
            }, 2500);
        }


        // ==================================================
        // --- Content Posting (рѕўрѕѕрїарЇЇ) ---
        // ==================================================

        function handlePost(type) {
            const userPhone = getCurrentUserPhone();
            let title = '';
            let content = '';
            let file = null;
            let postId = Date.now();

            if (type === 'text') {
                title = document.getElementById('post-text-title').value.trim();
                content = document.getElementById('post-text-content').value.trim();
                if (!title || !content) {
                    alert('рѕГрІЋрѕх ріЦріЊ рЇЁрѕЂрЇЇ рІФрѕхрїѕрЅАрЇб');
                    return;
                }
            } else if (type === 'image') {
                title = document.getElementById('post-image-title').value.trim();
                file = document.getElementById('post-image-file').files[0];
                if (!title || !file) {
                    alert('рѕГрІЋрѕх ріЦріЊ рѕЮрѕхрѕЇ рІФрѕхрїѕрЅАрЇб');
                    return;
                }
                content = URL.createObjectURL(file); 
            } else if (type === 'audio') {
                title = document.getElementById('post-audio-title').value.trim();
                file = document.getElementById('post-audio-file').files[0];
                if (!title || !file) {
                    alert('рѕГрІЋрѕх ріЦріЊ рЅфрІ▓рІ«/рідрІ▓рІ« рЇІрІГрѕЇ рІФрѕхрїѕрЅАрЇб');
                    return;
                }
                content = URL.createObjectURL(file); 
            }

            showLoading('рѕўрѕерїЃ рЅарѕўрѕѕрїарЇЇ рѕІрІГ...');

            const newPost = {
                id: postId,
                user: userPhone,
                type: type,
                title: title,
                content: content,
                date: new Date().toLocaleDateString('am-ET')
            };

            posts.push(newPost);
            localStorage.setItem('fasil_app_posts', JSON.stringify(posts));

            setTimeout(() => {
                hideLoading();
                alert('рѕўрѕерїЃрІЇ рЅарЅ░рѕ│ріФ рѕЂріћрЅ│ рЅ░рѕѕрїЦрЇЈрѕЇ!');
                goBackToDashboard();
            }, 1500);
        }

        // ==================================================
        // --- Content Viewing (рѕўрѕўрѕЇріерЅх) ---
        // ==================================================
        
        function renderPosts(type, containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            const filteredPosts = posts.filter(p => p.type === type).reverse();

            if (filteredPosts.length === 0) {
                container.innerHTML = `<p style="text-align: center; color: #777;">рѕЮріЋрѕЮ ${type === 'text' ? 'рЇЁрѕЂрЇјрЅй' : type === 'image' ? 'рѕЮрѕхрѕјрЅй' : 'рЅфрІ▓рІ«/рідрІ▓рІ« рЇІрІГрѕјрЅй'} рІерѕЅрѕЮрЇб</p>`;
                return;
            }

            filteredPosts.forEach(post => {
                const postElement = document.createElement('div');
                postElement.style.border = '1px solid #ccc';
                postElement.style.padding = '15px';
                postElement.style.marginBottom = '15px';
                postElement.style.borderRadius = '8px';
                postElement.style.backgroundColor = '#fff';

                let contentHtml = '';
                if (post.type === 'text') {
                    contentHtml = `<p>${post.content.substring(0, 150)}...</p>`;
                } else if (post.type === 'image') {
                    contentHtml = `<img src="${post.content}" alt="${post.title}" style="max-width: 100%; height: auto; border-radius: 5px;">`;
                } else if (post.type === 'audio') {
                    // Audio/Video
                    const mediaTag = post.content.includes('video') ? `<video controls style="width: 100%; margin: 10px 0;"></video>` : `<audio controls style="width: 100%; margin: 10px 0;"></audio>`;
                    contentHtml = mediaTag;
                }


                postElement.innerHTML = `
                    <h4 style="color: #007bff; margin-top: 0;">${post.title}</h4>
                    <p style="font-size: 14px; color: #555;"><strong>Posted by:</strong> ${post.user} on ${post.date}</p>
                    ${contentHtml}
                `;
                container.appendChild(postElement);
            });
        }
        
        // ==================================================
        // --- Content Deleting (рѕўрІ░рѕѕрЅх) ---
        // ==================================================
        
        function showDeleteList() {
            const type = document.getElementById('delete-file-type').value;
            const container = document.getElementById('deletable-posts-container');
            const currentUser = getCurrentUserPhone();

            if (!currentUser) {
                alert('ріЦрЅБріГрІј рѕўрїђрѕўрѕфрІФ рІГрїЇрЅАрЇб');
                window.location.hash = '#login-form';
                updateView();
                return;
            }
            
            window.location.hash = '#delete-file-view';
            updateView();
            
            container.innerHTML = '';
            const userPosts = posts.filter(p => p.type === type && p.user === currentUser).reverse();

            if (userPosts.length === 0) {
                container.innerHTML = `<p style="text-align: center; color: #721c24;">ріЦрѕГрѕхрІј рІерѕѕрїарЇЅрЅх ${type} рІерѕѕрѕЮрЇб</p>`;
                return;
            }

            userPosts.forEach(post => {
                const postElement = document.createElement('div');
                postElement.style.border = '1px solid #dc3545';
                postElement.style.padding = '15px';
                postElement.style.marginBottom = '15px';
                postElement.style.borderRadius = '8px';
                postElement.style.backgroundColor = '#f8d7da';

                postElement.innerHTML = `
                    <h4 style="color: #721c24; margin-top: 0;">${post.title} (${post.date})</h4>
                    <button class="delete-btn" style="width: 120px; padding: 8px 10px; font-size: 14px; margin: 10px 0;" onclick="deletePost(${post.id})">рѕўрІ░рѕѕрЅх</button>
                `;
                container.appendChild(postElement);
            });
        }

        function deletePost(id) {
            if (confirm('рІГрѕЁріЋ рЇІрІГрѕЇ рЅаріЦрѕГрїЇрїаріЮріљрЅх рѕўрІ░рѕѕрЅх рІГрЇѕрѕЇрїІрѕЅ?')) {
                posts = posts.filter(p => p.id !== id);
                localStorage.setItem('fasil_app_posts', JSON.stringify(posts));
                alert('рЇІрІГрѕЅ рЅ░рІ░рѕЇрЅирѕЇрЇб');
                showDeleteList(); // рІЮрѕГрІЮрѕЕріЋ ріарІхрѕх
            }
        }

        // ==================================================
        // --- View Controller (рІІріЊ рѕўрЅєрїБрїарѕфрІФ) ---
        // ==================================================

        function updateView() {
            const allSections = document.querySelectorAll('.section');
            let hash = window.location.hash || '#home-view';
            let targetId = hash.substring(1);
            
            // Check if user is logged in
            currentSubscription = getCurrentUserTier();

            // Default to Home if not logged in and trying to access a restricted page
            if (targetId !== 'home-view' && targetId !== 'signup-form' && targetId !== 'login-form' && targetId !== 'pricing' && targetId !== 'payment-methods' && !getCurrentUserPhone()) {
                 hash = '#home-view';
                 targetId = 'home-view';
            }
            
            // Redirect to appropriate dashboard after successful login
            if (targetId === 'dashboard') {
                if (currentSubscription === 'premium') {
                    targetId = 'premium-dashboard';
                } else {
                    targetId = 'free-dashboard';
                }
            }


            allSections.forEach(section => {
                section.style.display = 'none';
            });

            const targetSection = document.getElementById(targetId);
            if (targetSection) {
                targetSection.style.display = 'block';
            } else {
                document.getElementById('home-view').style.display = 'block';
            }
            
            // Specific view updates
            if (targetId === 'view-text') renderPosts('text', 'text-posts-container');
            if (targetId === 'view-image') renderPosts('image', 'image-posts-container');
            if (targetId === 'view-audio') renderPosts('audio', 'audio-posts-container');
        }

        window.addEventListener('hashchange', updateView);
        window.addEventListener('load', updateView);
        
        updateView();
    </script>
</body>
</html>
