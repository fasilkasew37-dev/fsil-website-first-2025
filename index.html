<!DOCTYPE html>
<html lang="am">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>á‹áˆ²áˆ á‹Œá‰¥ áŠ á• - Fasil Web App (Final V16.0)</title>
    <style>
        /* --- áˆ˜á‹°á‰ áŠ› CSS --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            text-align: center;
            padding: 20px;
            background-color: #f0f4f8;
            color: #333;
            margin: 0;
        }
        .section {
            max-width: 700px;
            margin: 20px auto;
            padding: 25px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
            border-top: 6px solid #007bff;
            text-align: left;
            display: none; 
            padding-bottom: 50px;
        }
        #agreement-view { display: block; }
        
        h1, h2, h3 { text-align: center; }
        h1 { color: #007bff; font-size: 26px; }
        h2 { color: #555; font-size: 20px; margin: 15px 0; }

        input, select, textarea {
            width: 100%; padding: 12px; margin: 10px 0;
            border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; font-size: 16px;
        }
        
        /* Buttons */
        button, .button-link {
            display: block; width: 100%; padding: 15px; margin: 10px 0;
            text-align: center; border-radius: 8px; font-weight: bold;
            cursor: pointer; border: none; font-size: 16px; color: white; transition: 0.3s;
        }
        .main-btn { background-color: #007bff; }
        .success-btn { background-color: #28a745; }
        .delete-btn { background-color: #dc3545; }
        .premium-btn { background-color: #ffc107; color: #333; }
        .feature-btn { background-color: #8c5aee; }
        .business-btn { background-color: #00a08e; }
        .social-btn { background-color: #ff7043; }
        .language-btn { background-color: #343a40; border: 1px solid #ddd; }

        /* Custom Modal (Alerts) */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.6); display: none;
            justify-content: center; align-items: center; z-index: 2000;
        }
        .modal-box {
            background: white; padding: 25px; border-radius: 12px;
            width: 85%; max-width: 400px; text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3); animation: popIn 0.3s ease;
        }
        @keyframes popIn { 0% { transform: scale(0.8); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
        
        /* Cards */
        .user-card, .post-card, .feedback-card {
            border: 1px solid #eee; padding: 10px; border-radius: 8px;
            margin-bottom: 10px; background-color: #f9f9f9;
        }
        .user-card img { width: 50px; height: 50px; border-radius: 50%; margin-right: 15px; object-fit: cover; }
        
        /* Balance Tags */
        .balance-tag { display: inline-block; margin: 0 5px; font-weight: bold; font-size: 14px; }
        
        /* Loading */
        .loading-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.9); display: none;
            justify-content: center; align-items: center; z-index: 1000; flex-direction: column;
        }
        .spinner {
            border: 6px solid #f3f3f3; border-top: 6px solid #007bff;
            border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <!-- Loading -->
    <div class="loading-overlay" id="loading-overlay">
        <div class="spinner"></div>
        <p>... á‰ áˆ˜áŒ«áŠ• áˆ‹á‹­ ...</p>
    </div>

    <!-- Alert Modal -->
    <div class="modal-overlay" id="custom-modal">
        <div class="modal-box">
            <div id="modal-title" style="font-size: 20px; font-weight: bold; margin-bottom: 10px;"></div>
            <div id="modal-text" style="margin-bottom:20px;"></div>
            <button class="main-btn" onclick="closeModal()">áŠ¥áˆº (OK)</button>
        </div>
    </div>
    
    <!-- Password Prompt Modal -->
    <div class="modal-overlay" id="password-modal">
        <div class="modal-box">
            <h3>á‹¨á‹­áˆˆá á‰ƒáˆ áˆ›áˆ¨áŒ‹áŒˆáŒ«</h3>
            <p id="password-modal-msg">áŠ¥á‰£áŠ­á‹ á‹¨á‹­áˆˆá á‰ƒáˆ á‹«áˆµáŒˆá‰¡á¡</p>
            <input type="password" id="modal-password-input" placeholder="á‹¨á‹­áˆˆá á‰ƒáˆ" style="text-align: center;">
            <button class="success-btn" onclick="confirmActionWithPassword()">áŠ áˆ¨áŒ‹áŒáŒ¥</button>
            <button class="delete-btn" onclick="document.getElementById('password-modal').style.display='none'">áˆ°áˆ­á‹</button>
        </div>
    </div>

    <!-- 1. Agreement View -->
    <div class="section" id="agreement-view">
        <h1>áŠ¥áŠ•áŠ³áŠ• á‹ˆá‹° á‹áˆ²áˆ á‹Œá‰¥ á‰ á‹°áˆ…áŠ“ áˆ˜áŒ¡</h1>
        <div style="background:#e9ecef; padding:20px; border-radius:8px; border-left:5px solid #007bff;">
            <h3>ğŸŒ áˆµáˆˆ á‹áˆ²áˆ á‹Œá‰¥ áŠ á•</h3>
            <p>á‹áˆ²áˆ á‹Œá‰¥ áŠ á• á‹²áŒ‚á‰³áˆ áˆ˜áŒ‹áˆªá‹«á£ á“á‹ˆáˆ­ á–á‹­áŠ•á‰µá£ á’á‹²áŠ¤á áŠ¥áŠ“ á‹“áˆˆáˆ áŠ á‰€á á‹¨áŠ­áá‹« áŠ áŒˆáˆáŒáˆá‰¶á‰½áŠ• á‹¨á‹«á‹˜ áˆ˜á‹µáˆ¨áŠ­ áŠá‹á¢</p>
        </div>
        <div style="background:#ffe0b2; padding:20px; margin-top:20px; border-left:5px solid #ff9800;">
            <h3>âš ï¸ áŒ¥á‰¥á‰… áˆ˜áˆ˜áˆªá‹«</h3>
            <p>á–áˆˆá‰²áŠ«á‹Š áŒáŒ­á‰µá£ á‹¨áˆƒá‹­áˆ›áŠ–á‰µ áŒ¥áˆ‹á‰» áŠ¥áŠ“ á‹˜áˆ¨áŠáŠá‰µ áˆ›áˆ«áˆ˜á‹µ á‰ áŒ¥á‰¥á‰… á‹¨á‰°áŠ¨áˆˆáŠ¨áˆˆ áŠá‹á¢</p>
        </div>
        <h2 style="margin-top:30px;">á‹­á‰€á‰ áˆ‹áˆ‰?</h2>
        <button class="success-btn" onclick="showView('home-view')">âœ… áŠ¥áˆµáˆ›áˆ›áˆˆáˆ</button>
        <button class="delete-btn" onclick="showAlert('áˆ˜áŒ á‰€áˆ áŠ á‹­á‰½áˆ‰áˆá¢', 'error')">âŒ áŠ áˆáˆµáˆ›áˆ›áˆ</button>
    </div>

    <!-- 2. Home View -->
    <div class="section" id="home-view">
        <h1>á‹¨áˆ˜áŒá‰¢á‹« áˆáˆ­áŒ«</h1>
        <button class="language-btn" onclick="toggleLanguage()">ğŸŒ á‰‹áŠ•á‰‹ á‰€á‹­áˆ­ (Language)</button>
        <h2>áŠ¥áŠ•á‹´á‰µ áˆ˜áŒ á‰€áˆ á‹­áˆáˆáŒ‹áˆ‰?</h2>
        <button class="main-btn" onclick="showView('signup-form')">á‰ áŠáƒ áˆˆáˆ˜áˆ˜á‹áŒˆá‰¥ / áˆˆáˆ˜áŒá‰£á‰µ</button>
        <button class="premium-btn" onclick="checkFreeSignupForPremium()">á‰ áŠ­áá‹« áŠ áˆ›áˆ«áŒ­ áˆˆáˆ˜áˆ˜á‹áŒˆá‰¥</button>
        <button class="delete-btn" onclick="showView('agreement-view')" style="background:#6c757d; margin-top:30px;">á‰°áˆ˜áˆˆáˆµ</button>
    </div>

    <!-- 3. Signup -->
    <div class="section" id="signup-form">
        <h2>áŠ á‹²áˆµ áˆá‹áŒˆá‰£</h2>
        <input type="text" id="signup-name" placeholder="áˆ™áˆ‰ áˆµáˆ" required>
        <input type="text" id="signup-phone" placeholder="áˆµáˆáŠ­ á‰áŒ¥áˆ­" required>
        <input type="email" id="signup-email" placeholder="áŠ¢áˆœáˆ (@gmail.com á‰¥á‰»)" required>
        <input type="password" id="signup-password" placeholder="á‹¨á‹­áˆˆá á‰ƒáˆ (6 áŠ áˆ€á‹)" maxlength="6" required>
        <p>**á•áˆ®á‹á‹­áˆ áá‰¶**</p>
        <input type="file" id="signup-profile-photo" accept="image/*">
        <button class="success-btn" onclick="handleSignUp()">áˆ˜á‹áŒá‰¥</button>
        <p style="text-align:center; cursor:pointer; color:#007bff;" onclick="showView('login-form')">á‰°áˆ˜á‹áŒá‰ á‹‹áˆ? á‹­áŒá‰¡</p>
    </div>

    <!-- 4. Login -->
    <div class="section" id="login-form">
        <h2>áˆ˜áŒá‰¢á‹«</h2>
        <input type="text" id="login-phone" placeholder="áˆµáˆáŠ­ á‰áŒ¥áˆ­">
        <input type="password" id="login-password" placeholder="á‹¨á‹­áˆˆá á‰ƒáˆ">
        <button class="main-btn" onclick="handleLogin()">áŒá‰£</button>
        <p style="text-align:center; cursor:pointer; color:#007bff;" onclick="showView('signup-form')">áŠ á‹²áˆµ á‰°áŒ á‰ƒáˆš? á‹­áˆ˜á‹áŒˆá‰¡</p>
    </div>

    <!-- 5. Main Dashboard (Unified) -->
    <div class="section" id="main-dashboard">
        <h1>á‹³áˆ½á‰¦áˆ­á‹µ</h1>
        <button class="language-btn" onclick="toggleLanguage()">ğŸŒ á‰‹áŠ•á‰‹ á‰€á‹­áˆ­ (Language)</button>

        <h2>áŠ áŒˆáˆáŒáˆá‰¶á‰½:</h2>
        <button class="main-btn" onclick="showView('view-select')">ğŸ“„ áˆ˜áˆ¨áŒƒ áˆ˜áˆ˜áˆáŠ¨á‰µ</button>
        <button class="main-btn" onclick="showView('post-select')">âœï¸ áˆ˜áˆ¨áŒƒ áˆ˜áˆˆáŒ á</button>
        
        <button class="social-btn" onclick="handleGroupCreation()">ğŸ‘¥ á‰¡á‹µáŠ• áˆ˜ááŒ áˆ­ / áˆ›á‹¨á‰µ</button>
        <button class="social-btn" onclick="handlePrivateChatStart()">ğŸ’¬ á‰ á‹áˆµáŒ¥ áˆ˜áˆµáˆ˜áˆ­ áˆ›á‹áˆ«á‰µ</button>
        
        <button class="success-btn" style="background-color: #00bcd4;" onclick="showView('feedback-center')">ğŸ“ áˆˆáŠ á• áˆáŒ£áˆª áŠ áˆµá‰°á‹«á‹¨á‰µ áˆˆáˆ˜áˆµáŒ á‰µ áŠ¥áŠ“ áˆˆáˆ˜áˆ˜áˆáŠ¨á‰µ</button>

        <button class="business-btn" onclick="checkAuthAndRedirect('business-dashboard')">ğŸ’° á‰¢á‹áŠáˆµ áˆ›á‹•áŠ¨áˆ</button>
        
        <button class="feature-btn" style="background-color: #ffc107; color: black;" onclick="showView('premium-services-list')">â­ï¸ á‹¨áŠ­áá‹« áŠ áŒˆáˆáŒáˆá‰¶á‰½ (News, Video...)</button>

        <button class="delete-btn" onclick="showDeleteList()">ğŸ—‘ï¸ á‹¨áˆˆáŒ á‰á‰µáŠ• áˆ˜áˆ¨áŒƒ áˆ˜á‹°áˆˆá‰µ</button>
        <button class="delete-btn" style="background-color: #6c757d; margin-top: 20px;" onclick="handleLogout()">á‹áŒ£</button>
    </div>

    <!-- 6. Premium Services Selection -->
    <div class="section" id="premium-services-list">
        <h2>â­ï¸ á‹¨áŠ­áá‹« áŠ áŒˆáˆáŒáˆá‰¶á‰½</h2>
        <p>áˆˆáˆ˜áŒ á‰€áˆ á‹¨áˆšáˆáˆáŒ‰á‰µáŠ• á‹­áˆáˆ¨áŒ¡ (áŠ­áá‹« á‹­áŒ á‹­á‰ƒáˆ)</p>
        
        <button class="main-btn" onclick="openPricingModal('Quality Video')">ğŸ¥ áŒ¥áˆ«á‰± á‹¨áŒ á‰ á‰€ á‰ªá‹²á‹®</button>
        <button class="main-btn" onclick="openPricingModal('News Service')">ğŸ“° á‹œáŠ“ áˆ˜áŠ¨á‰³á‰°áˆ</button>
        <button class="main-btn" onclick="openPricingModal('PPT Creation')">ğŸ“Š á“á‹ˆáˆ­ á–á‹­áŠ•á‰µ áˆ›á‹˜áŒ‹áŒ€á‰µ</button>
        <button class="main-btn" onclick="openPricingModal('PDF Tools')">ğŸ“„ á’á‹²áŠ¤á áˆ›á‹˜áŒ‹áŒ€á‰µ</button>
        
        <button class="delete-btn" onclick="showView('main-dashboard')">á‰°áˆ˜áˆˆáˆµ</button>
    </div>

    <!-- 7. Pricing View (Triggered by Premium Buttons) -->
    <div class="section" id="pricing-view">
        <h2 id="pricing-service-name">áŠ­áá‹«</h2>
        <p>áˆˆá‹šáˆ… áŠ áŒˆáˆáŒáˆá‰µ á‹¨áˆšáˆµáˆ›áˆ›á‹á‰µáŠ• áŒ¥á‰…áˆ á‹­áˆáˆ¨áŒ¡á¡</p>
        
        <div style="border:1px solid #ddd; padding:10px; margin:5px;">
            <h3>á‹•áˆˆá‰³á‹Š</h3><p>5 ETB</p>
            <button class="success-btn" onclick="processLocalPayment(5)">áˆáˆ¨áŒ¥</button>
        </div>
        <div style="border:1px solid #ddd; padding:10px; margin:5px;">
            <h3>áˆ³áˆáŠ•á‰³á‹Š</h3><p>25 ETB</p>
            <button class="success-btn" onclick="processLocalPayment(25)">áˆáˆ¨áŒ¥</button>
        </div>
        <div style="border:1px solid #ddd; padding:10px; margin:5px;">
            <h3>á‹ˆáˆ­áˆƒá‹Š</h3><p>30 ETB</p>
            <button class="success-btn" onclick="processLocalPayment(30)">áˆáˆ¨áŒ¥</button>
        </div>
        <div style="border:1px solid #ddd; padding:10px; margin:5px;">
            <h3>á‹“áˆ˜á‰³á‹Š</h3><p>100 ETB</p>
            <button class="success-btn" onclick="processLocalPayment(100)">áˆáˆ¨áŒ¥</button>
        </div>
        
        <button class="delete-btn" onclick="showView('premium-services-list')">á‰°áˆ˜áˆˆáˆµ</button>
    </div>

    <!-- 8. Payment Confirmation (Receipt Upload) -->
    <div class="section" id="payment-confirm-view">
        <h2>áŠ­áá‹« áˆ›áˆ¨áŒ‹áŒˆáŒ«</h2>
        <p>áŠ¥á‰£áŠ­á‹ á‹¨áŠ¨áˆáˆ‰á‰ á‰µáŠ• á‹°áˆ¨áˆ°áŠ á‹«áˆµáŒˆá‰¡á¢</p>
        <input type="file" id="payment-receipt-file">
        <button class="success-btn" onclick="finalizePayment()">áŠ áˆ¨áŒ‹áŒáŒ¥</button>
        <button class="delete-btn" onclick="showView('main-dashboard')">áˆ°áˆ­á‹</button>
    </div>

    <!-- 9. Business Dashboard (Updated Balance UI) -->
    <div class="section" id="business-dashboard">
        <h2>ğŸ’° á‹¨á‰¢á‹áŠáˆµ áˆ›á‹•áŠ¨áˆ</h2>
        
        <div style="background:#f8f9fa; border:1px solid #ddd; padding:15px; border-radius:8px; margin-bottom:15px;">
            <h3 style="margin:0; color:#333;">á‹‹áŠ“ áˆšá‹›áŠ• (USD): <span id="main-usd" style="color:#007bff;">0.00</span></h3>
            <div style="margin-top:10px;">
                <span class="balance-tag" style="color:red;">GBP: <span id="bal-gbp">0.00</span></span>
                <span class="balance-tag" style="color:green;">EUR: <span id="bal-eur">0.00</span></span>
            </div>
            <hr>
            <p style="margin:5px 0; font-weight:bold;">áŒ á‰…áˆ‹áˆ‹ áŒáˆá‰µ (á‰ USD): <span id="total-est-usd">0.00</span> $</p>
        </div>

        <button class="success-btn" onclick="showView('deposit-view')">ğŸ’µ áŒˆáŠ•á‹˜á‰¥ áˆˆáˆ›áˆµáŒˆá‰£á‰µ (Deposit)</button>
        <button class="main-btn" onclick="showView('withdraw-view')">ğŸ’¸ áŒˆáŠ•á‹˜á‰¥ áˆˆáˆ›á‹áŒ£á‰µ (Withdraw)</button>
        <button class="premium-btn" onclick="showView('intl-purchase-view')">ğŸŒ á‹“áˆˆáˆ áŠ á‰€á áŒá‹¢ (International)</button>

        <button class="delete-btn" onclick="showView('main-dashboard')">á‰°áˆ˜áˆˆáˆµ</button>
    </div>

    <!-- 10. Deposit View (Choose Currency) -->
    <div class="section" id="deposit-view">
        <h2>ğŸ’µ áŒˆáŠ•á‹˜á‰¥ áˆ›áˆµáŒˆá‰£á‰µ</h2>
        <p>1. á‹¨áˆšá‹«áˆµáŒˆá‰¡á‰µáŠ• á‹¨ETB áˆ˜áŒ áŠ• á‹­áƒá‰á¢</p>
        <input type="number" id="deposit-etb" placeholder="áˆ˜áŒ áŠ• (ETB)">
        
        <p>2. á‹ˆá‹° áˆáŠ• á‰°áˆ˜áŠ•á‹áˆ® á‹­á‰€áˆ˜áŒ¥?</p>
        <select id="deposit-target-currency">
            <option value="USD">á‹¶áˆ‹áˆ­ (USD)</option>
            <option value="GBP">á‹¨áŠ¥áŠ•áŒáˆŠá‹ á“á‹áŠ•á‹µ (GBP)</option>
            <option value="EUR">á‹©áˆ® (EUR)</option>
        </select>

        <p>3. á‹¨á‰£áŠ•áŠ­ á‹°áˆ¨áˆ°áŠ á‹«áˆµáŒˆá‰¡</p>
        <input type="file" id="deposit-receipt">
        
        <button class="success-btn" onclick="handleDeposit()">áŠ áˆµáŒˆá‰£</button>
        <button class="delete-btn" onclick="showView('business-dashboard')">á‰°áˆ˜áˆˆáˆµ</button>
    </div>

    <!-- 11. Withdraw View (Source -> Target) -->
    <div class="section" id="withdraw-view">
        <h2>ğŸ’¸ áŒˆáŠ•á‹˜á‰¥ áˆ›á‹áŒ£á‰µ</h2>
        <p>áŠ¨á‹¨á‰µáŠ›á‹ á‹¨áŒˆáŠ•á‹˜á‰¥ áŠ á‹­áŠá‰µ áˆ›á‹áŒ£á‰µ á‹­áˆáˆáŒ‹áˆ‰?</p>
        <select id="withdraw-source-currency">
            <option value="USD">á‹¶áˆ‹áˆ­ (USD)</option>
            <option value="GBP">á“á‹áŠ•á‹µ (GBP)</option>
            <option value="EUR">á‹©áˆ® (EUR)</option>
        </select>
        
        <input type="number" id="withdraw-amount" placeholder="áˆ˜áŒ áŠ• (áˆáŠ•á‹›áˆ¬á‹ áŠ¥áŠ•á‹°áˆ˜áˆ¨áŒ¡á‰µ)">
        
        <p>á‹¨áˆ˜á‰€á‰ á‹« á‹˜á‹´:</p>
        <select id="withdraw-method">
            <option value="Telebirr">á‰´áˆŒá‰¥áˆ­ (á‹ˆá‹° ETB á‹­á‰€á‹¨áˆ«áˆ)</option>
            <option value="CBE">CBE (á‹ˆá‹° ETB á‹­á‰€á‹¨áˆ«áˆ)</option>
            <option value="PayPal">PayPal (USD)</option>
        </select>
        <input type="text" id="withdraw-receiver" placeholder="á‰áŒ¥áˆ­ / áŠ áŠ«á‹áŠ•á‰µ">

        <button class="main-btn" onclick="initiateWithdraw()">áŠ á‹áŒ£</button>
        <button class="delete-btn" onclick="showView('business-dashboard')">á‰°áˆ˜áˆˆáˆµ</button>
    </div>

    <!-- 12. International Purchase View (New) -->
    <div class="section" id="intl-purchase-view">
        <h2>ğŸŒ á‹“áˆˆáˆ áŠ á‰€á áŒá‹¢</h2>
        <p>á‹µáˆ­áŒ…á‰µ á‹­áˆáˆ¨áŒ¡á¡</p>
        <select id="intl-service">
            <option value="ChatGPT">ChatGPT (Plus/API)</option>
            <option value="Gemini">Gemini Advanced</option>
            <option value="Amazon">Amazon Shopping</option>
            <option value="Hosting">Hosting Service</option>
            <option value="Domain">Domain Name</option>
            <option value="Netflix">Netflix</option>
            <option value="Spotify">Spotify</option>
            <option value="Alibaba">Alibaba</option>
        </select>

        <input type="number" id="intl-amount" placeholder="áˆ˜áŒ áŠ• á‰ á‹¶áˆ‹áˆ­ ($)">
        <p>á‹°áˆ¨áˆ°áŠ á‹ˆá‹­áˆ áˆ›áˆµáˆ¨áŒƒ (áŠ¨á‰°áˆáˆˆáŒˆ):</p>
        <input type="file" id="intl-receipt">

        <button class="success-btn" onclick="handleIntlPurchase()">áŠ­áˆáˆˆá‹</button>
        <button class="delete-btn" onclick="showView('business-dashboard')">á‰°áˆ˜áˆˆáˆµ</button>
    </div>

    <!-- 13. Feedback Center (Give & View) -->
    <div class="section" id="feedback-center">
        <h2>ğŸ“ á‹¨áŠ áˆµá‰°á‹«á‹¨á‰µ áˆ›á‹•áŠ¨áˆ</h2>
        <p>áˆˆá‹áˆ²áˆ á‹Œá‰¥ áŠ á• áˆáŒ£áˆª áŠ áˆµá‰°á‹«á‹¨á‰µ áˆˆáˆ˜áˆµáŒ á‰µá¡</p>
        <div class="media-btn-group" style="display:flex; gap:5px;">
            <button class="main-btn" onclick="handleFeedback('text')">á‰ á…áˆá</button>
            <button class="feature-btn" onclick="handleFeedback('voice')">á‰ á‹µáˆá…</button>
            <button class="premium-btn" onclick="handleFeedback('video')">á‰ á‰ªá‹²á‹® (Live)</button>
        </div>
        <input type="file" id="feedback-media-input" style="display:none;">

        <hr>
        <button class="social-btn" onclick="showAllFeedbacks()">ğŸ“‚ á‹¨á‰°áˆ°áŒ¡ áŠ áˆµá‰°á‹«á‹¨á‰¶á‰½áŠ• áˆˆáˆ˜áˆ˜áˆáŠ¨á‰µ</button>
        <div id="all-feedbacks-container" style="display:none; margin-top:10px;"></div>

        <button class="delete-btn" onclick="showView('main-dashboard')">á‰°áˆ˜áˆˆáˆµ</button>
    </div>

    <!-- Other Standard Views (Post, View, Chat, etc.) - Simplified for length but functional -->
    <div class="section" id="post-select">
        <h2>âœï¸ áˆ˜áˆ¨áŒƒ áˆ˜áˆˆáŒ á</h2>
        <input type="text" id="post-title" placeholder="áˆ­á‹•áˆµ">
        <textarea id="post-content" placeholder="áŒ½áˆá..."></textarea>
        <input type="file" id="post-file">
        <button class="success-btn" onclick="handlePost()">áˆˆáŒ¥á</button>
        <button class="delete-btn" onclick="showView('main-dashboard')">á‰°áˆ˜áˆˆáˆµ</button>
    </div>
    
    <div class="section" id="view-select">
        <h2>ğŸ“„ áˆ˜áˆ¨áŒƒ áˆ˜áˆ˜áˆáŠ¨á‰µ</h2>
        <button class="main-btn" onclick="displayPosts('text')">áŒ½áˆáá‰½</button>
        <button class="main-btn" onclick="displayPosts('image')">áˆáˆµáˆá‰½</button>
        <button class="main-btn" onclick="displayPosts('audio')">á‰ªá‹²á‹®/áŠ¦á‹²á‹®</button>
        <div id="posts-container"></div>
        <button class="delete-btn" onclick="showView('main-dashboard')">á‰°áˆ˜áˆˆáˆµ</button>
    </div>

    <div class="section" id="private-chat-view">
        <h2>ğŸ’¬ á‹¨áŒáˆ á‹á‹­á‹­á‰µ</h2>
        <div id="chat-user-list"></div>
        <div id="chat-box" style="display:none;">
            <h3 id="chat-with-name"></h3>
            <div id="chat-messages" style="height:200px; overflow-y:auto; border:1px solid #ddd;"></div>
            <input type="text" id="chat-input" placeholder="áˆ˜áˆáŠ¥áŠ­á‰µ...">
            <button class="main-btn" onclick="sendChat()">áˆ‹áŠ­</button>
            <button class="feature-btn" onclick="triggerChatMedia()">áˆšá‹²á‹«</button>
            <input type="file" id="chat-file-hidden" style="display:none;">
        </div>
        <button class="delete-btn" onclick="showView('main-dashboard')">á‰°áˆ˜áˆˆáˆµ</button>
    </div>
    
    <div class="section" id="delete-files-view">
        <h2>ğŸ—‘ï¸ á‹á‹­áˆ áˆ˜á‹°áˆˆá‰µ</h2>
        <div id="delete-list"></div>
        <button class="delete-btn" onclick="showView('main-dashboard')">á‰°áˆ˜áˆˆáˆµ</button>
    </div>

    <div class="section" id="group-view">
        <h2>ğŸ‘¥ á‰¡á‹µáŠ•</h2>
        <button class="main-btn" onclick="createGroup()">áŠ á‹²áˆµ á‰¡á‹µáŠ• ááŒ áˆ­</button>
        <div id="my-groups-list"></div>
        <button class="delete-btn" onclick="showView('main-dashboard')">á‰°áˆ˜áˆˆáˆµ</button>
    </div>

    <script>
        // --- State ---
        let currentUser = JSON.parse(localStorage.getItem('fasil_user')) || null;
        let users = JSON.parse(localStorage.getItem('fasil_users')) || [];
        let posts = JSON.parse(localStorage.getItem('fasil_posts')) || [];
        let feedbacks = JSON.parse(localStorage.getItem('fasil_admin_feedbacks')) || [];
        let pendingAction = null; // For password confirmation context

        // Mock Conversion Rates (Base ETB)
        const RATES = { USD: 120, GBP: 150, EUR: 130 }; 

        // --- Utils ---
        function showView(id) {
            document.querySelectorAll('.section').forEach(el => el.style.display = 'none');
            document.getElementById(id).style.display = 'block';
            if(id === 'business-dashboard') updateBalanceDisplay();
        }

        function showAlert(msg, type) {
            const modal = document.getElementById('custom-modal');
            document.getElementById('modal-title').textContent = type === 'error' ? "âŒ áˆµáˆ…á‰°á‰µ" : "âœ… áˆµáŠ¬á‰µ";
            document.getElementById('modal-title').style.color = type === 'error' ? "red" : "green";
            document.getElementById('modal-text').textContent = msg;
            modal.style.display = 'flex';
        }
        function closeModal() { document.getElementById('custom-modal').style.display = 'none'; }
        function toggleLanguage() { alert("á‰‹áŠ•á‰‹ á‹ˆá‹° áŠ¥áŠ•áŒáˆŠá‹áŠ›/áŠ áˆ›áˆ­áŠ› á‰°á‰€á‹¨áˆ¨ (Simulation)"); }

        function checkAuthAndRedirect(target) {
            if(!currentUser) showView('login-form');
            else showView(target);
        }
        function checkFreeSignupForPremium() {
            if(!currentUser) { showAlert("á‰ á‰…á‹µáˆšá‹« á‹­áˆ˜á‹áŒˆá‰¡á¢", "error"); showView('signup-form'); }
            else showView('premium-services-list');
        }

        // --- Auth ---
        function handleSignUp() {
            const name = document.getElementById('signup-name').value;
            const phone = document.getElementById('signup-phone').value;
            const email = document.getElementById('signup-email').value;
            const pass = document.getElementById('signup-password').value;
            
            if(!email.endsWith("@gmail.com")) { showAlert("áŠ¢áˆœáˆ @gmail.com á‰¥á‰»á¢", "error"); return; }
            if(users.some(u => u.phone === phone || u.email === email)) { showAlert("á‰°áˆ˜á‹áŒá‰§áˆá¢", "error"); return; }
            
            const newUser = { 
                name, phone, email, password: pass, 
                photo: '', // Simplified for length
                balanceUSD: 0, balanceGBP: 0, balanceEUR: 0 
            };
            users.push(newUser);
            localStorage.setItem('fasil_users', JSON.stringify(users));
            showAlert("á‰°áˆ˜á‹áŒá‰ á‹‹áˆ!", "success");
            showView('login-form');
        }

        function handleLogin() {
            const ph = document.getElementById('login-phone').value;
            const pa = document.getElementById('login-password').value;
            const u = users.find(user => user.phone === ph && user.password === pa);
            if(u) {
                currentUser = u;
                // Ensure legacy users have currency fields
                if(currentUser.balanceUSD === undefined) { 
                    currentUser.balanceUSD = currentUser.balance || 0; 
                    currentUser.balanceGBP = 0; currentUser.balanceEUR = 0; 
                }
                localStorage.setItem('fasil_user', JSON.stringify(currentUser));
                showView('main-dashboard');
            } else showAlert("áˆ˜áˆ¨áŒƒá‹ áˆµáˆ…á‰°á‰µ áŠá‹á¢", "error");
        }
        
        function handleLogout() { currentUser = null; localStorage.removeItem('fasil_user'); showView('home-view'); }

        // --- Business Logic ---
        function updateBalanceDisplay() {
            document.getElementById('main-usd').textContent = currentUser.balanceUSD.toFixed(2);
            document.getElementById('bal-gbp').textContent = currentUser.balanceGBP.toFixed(2);
            document.getElementById('bal-eur').textContent = currentUser.balanceEUR.toFixed(2);
            
            // Total Estimate in USD
            const total = currentUser.balanceUSD + 
                          (currentUser.balanceGBP * (RATES.GBP/RATES.USD)) + 
                          (currentUser.balanceEUR * (RATES.EUR/RATES.USD));
            document.getElementById('total-est-usd').textContent = total.toFixed(2);
        }

        function handleDeposit() {
            const etb = parseFloat(document.getElementById('deposit-etb').value);
            const currency = document.getElementById('deposit-target-currency').value;
            const receipt = document.getElementById('deposit-receipt').files[0];

            if(!etb || etb < 100) { showAlert("á‰¢á‹«áŠ•áˆµ 100 ETBá¢", "error"); return; }
            if(!receipt) { showAlert("á‹°áˆ¨áˆ°áŠ á‹«áˆµáˆáˆáŒ‹áˆá¢", "error"); return; }

            // Convert and Store
            const amountForeign = etb / RATES[currency]; // Simple mock conversion
            
            if(currency === 'USD') currentUser.balanceUSD += amountForeign;
            else if(currency === 'GBP') currentUser.balanceGBP += amountForeign;
            else if(currency === 'EUR') currentUser.balanceEUR += amountForeign;
            
            saveUser();
            showAlert(`${amountForeign.toFixed(2)} ${currency} áŒˆá‰¢ á‰°á‹°áˆ­áŒ“áˆ!`, "success");
            showView('business-dashboard');
        }

        function initiateWithdraw() {
            const sourceCurr = document.getElementById('withdraw-source-currency').value;
            const amt = parseFloat(document.getElementById('withdraw-amount').value);
            const method = document.getElementById('withdraw-method').value;
            const rec = document.getElementById('withdraw-receiver').value;

            if(!amt || amt <= 0) { showAlert("áˆ˜áŒ áŠ• á‹«áˆµáŒˆá‰¡á¢", "error"); return; }
            
            // Check Balance
            let balance = 0;
            if(sourceCurr === 'USD') balance = currentUser.balanceUSD;
            else if(sourceCurr === 'GBP') balance = currentUser.balanceGBP;
            else if(sourceCurr === 'EUR') balance = currentUser.balanceEUR;

            if(amt > balance) { showAlert("á‰ á‰‚ áˆ‚áˆ³á‰¥ á‹¨áˆˆá‹á‰µáˆá¢", "error"); return; }

            // Validate CBE
            if(method === 'CBE') {
                 if(!rec.match(/^(1000|10000)\d{9}$/) || rec.length !== 13) {
                     showAlert("CBE á‰áŒ¥áˆ­ á‰µáŠ­áŠ­áˆ áŠ á‹­á‹°áˆˆáˆ (13 áŠ áˆƒá‹á£ á‰ 1000/10000 áŒ…áˆáˆ­)á¢", "error"); return;
                 }
            }

            // Set pending action for password modal
            pendingAction = () => {
                if(sourceCurr === 'USD') currentUser.balanceUSD -= amt;
                else if(sourceCurr === 'GBP') currentUser.balanceGBP -= amt;
                else if(sourceCurr === 'EUR') currentUser.balanceEUR -= amt;
                saveUser();
                showAlert("áŒˆáŠ•á‹˜á‰¥ áˆ›á‹áŒ£á‰µ á‰°áˆ³áŠ­á‰·áˆ!", "success");
                showView('business-dashboard');
            };
            
            document.getElementById('password-modal').style.display = 'flex';
        }

        // --- International Purchase ---
        function handleIntlPurchase() {
            const service = document.getElementById('intl-service').value;
            const amt = parseFloat(document.getElementById('intl-amount').value);
            const receipt = document.getElementById('intl-receipt').files[0];

            if(!amt || amt <= 0) { showAlert("áˆ˜áŒ áŠ• á‹«áˆµáŒˆá‰¡á¢", "error"); return; }
            if(amt > currentUser.balanceUSD) { showAlert("á‰ á‰‚ á‹¨á‹¶áˆ‹áˆ­ áˆ‚áˆ³á‰¥ á‹¨áˆˆá‹á‰µáˆá¢", "error"); return; }

            pendingAction = () => {
                currentUser.balanceUSD -= amt;
                saveUser();
                showAlert(`${service} áŒá‹¢ ($${amt}) á‰°áˆá…áˆŸáˆ!`, "success");
                showView('business-dashboard');
            };
            document.getElementById('password-modal').style.display = 'flex';
        }

        // --- Premium Services Payment ---
        function openPricingModal(serviceName) {
            document.getElementById('pricing-service-name').textContent = "áŠ­áá‹« áˆˆ: " + serviceName;
            showView('pricing-view');
        }

        function processLocalPayment(amount) {
            // Simply simulating receipt upload next
            showView('payment-confirm-view');
        }

        function finalizePayment() {
            const receipt = document.getElementById('payment-receipt-file').files[0];
            if(receipt) {
                showAlert("áŠ­áá‹«á‹ á‰°áˆ³áŠ­á‰·áˆ! áŠ áŒˆáˆáŒáˆá‰± áŠ­áá‰µ áŠá‹á¢", "success");
                showView('main-dashboard');
            } else {
                showAlert("áŠ¢áˆ¨áˆ­! á‹°áˆ¨áˆ°áŠ áŠ áˆ‹áˆµáŒˆá‰¡áˆá¢", "error");
            }
        }

        // --- Feedback ---
        function handleFeedback(type) {
            if(type === 'text') {
                const t = prompt("áŠ áˆµá‰°á‹«á‹¨á‰µá‹áŠ• á‹­áŒ»á‰:");
                if(t) saveFeedback(t, 'text');
            } else {
                const inp = document.getElementById('feedback-media-input');
                if(type === 'video') inp.setAttribute('capture', 'camcorder');
                else inp.removeAttribute('capture');
                
                inp.onchange = (e) => {
                    const r = new FileReader();
                    r.onload = evt => saveFeedback(evt.target.result, type);
                    r.readAsDataURL(e.target.files[0]);
                };
                inp.click();
            }
        }

        function saveFeedback(data, type) {
            feedbacks.unshift({ 
                user: currentUser.name, type, content: data, time: new Date().toLocaleTimeString() 
            });
            localStorage.setItem('fasil_admin_feedbacks', JSON.stringify(feedbacks));
            showAlert("áŠ áˆµá‰°á‹«á‹¨á‰µá‹ á‰°áˆáŠ³áˆ!", "success");
        }

        function showAllFeedbacks() {
            const container = document.getElementById('all-feedbacks-container');
            container.style.display = 'block';
            container.innerHTML = feedbacks.map(f => {
                let media = '';
                if(f.type === 'image') media = `<img src="${f.content}" width="100">`;
                else if(f.type === 'video') media = `<video src="${f.content}" controls width="150"></video>`;
                else if(f.type === 'voice') media = `<audio src="${f.content}" controls></audio>`;
                else media = `<p>${f.content}</p>`;
                
                return `<div class="feedback-card"><b>${f.user} (${f.type}):</b> ${media} <small>${f.time}</small></div>`;
            }).join('');
        }

        // --- Password Confirmation ---
        function confirmActionWithPassword() {
            const pass = document.getElementById('modal-password-input').value;
            if(pass === currentUser.password) {
                document.getElementById('password-modal').style.display = 'none';
                if(pendingAction) pendingAction();
                pendingAction = null;
            } else {
                alert("á‹¨á‹­áˆˆá á‰ƒáˆ áˆµáˆ…á‰°á‰µ áŠá‹á¢");
            }
        }

        function saveUser() {
            const idx = users.findIndex(u => u.phone === currentUser.phone);
            if(idx > -1) users[idx] = currentUser;
            localStorage.setItem('fasil_users', JSON.stringify(users));
            localStorage.setItem('fasil_user', JSON.stringify(currentUser));
        }

        // --- Shortcuts for other features (Simplified) ---
        function handlePost() { showAlert("áˆˆáŒ¥á (Demo)", "success"); }
        function displayPosts(t) { document.getElementById('posts-container').innerHTML = "<p>á–áˆµá‰¶á‰½ áŠ¥á‹šáˆ… á‹­á‰³á‹«áˆ‰á¢</p>"; }
        function showDeleteList() { document.getElementById('delete-list').innerHTML = "<p>á‹¨áˆšá‹°áˆˆá‰± á‹á‹­áˆá‰½á¢</p>"; showView('delete-files-view'); }
        function handleGroupCreation() { showView('group-view'); }
        function handlePrivateChatStart() { showView('private-chat-view'); }
        function sendChat() { alert("á‰°áˆáŠ³áˆ"); }
        function triggerChatMedia() { alert("áˆšá‹²á‹« áˆáˆ¨áŒ¥"); }
        function createGroup() { alert("áŒáˆ©á• á‰°áˆáŒ áˆ¨"); }

    </script>
</body>
</html>
